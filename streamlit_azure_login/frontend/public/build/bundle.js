var app=function(){"use strict";function e(){}function t(e,t){for(const r in t)e[r]=t[r];return e}function r(e){return e()}function n(){return Object.create(null)}function i(e){e.forEach(r)}function o(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(e,t){e.appendChild(t)}function c(e,t,r){e.insertBefore(t,r||null)}function u(e){e.parentNode&&e.parentNode.removeChild(e)}function l(e){return document.createElement(e)}function h(e){return document.createTextNode(e)}function d(){return h(" ")}function p(){return h("")}function f(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function g(e,t,r){null==r?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}let y,m;function v(){if(void 0===y){y=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(e){y=!0}}return y}function b(e,t){return new e(t)}function _(e){m=e}function w(){if(!m)throw new Error("Function called outside component initialization");return m}function T(e){w().$$.on_mount.push(e)}const I=[],C=[];let E=[];const S=[],A=Promise.resolve();let k=!1;function R(e){E.push(e)}const N=new Set;let O=0;function M(){if(0!==O)return;const e=m;do{try{for(;O<I.length;){const e=I[O];O++,_(e),P(e.$$)}}catch(e){throw I.length=0,O=0,e}for(_(null),I.length=0,O=0;C.length;)C.pop()();for(let e=0;e<E.length;e+=1){const t=E[e];N.has(t)||(N.add(t),t())}E.length=0}while(I.length);for(;S.length;)S.pop()();k=!1,N.clear(),_(e)}function P(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(R)}}const B=new Set;let D;function U(){D={r:0,c:[],p:D}}function L(){D.r||i(D.c),D=D.p}function x(e,t){e&&e.i&&(B.delete(e),e.i(t))}function F(e,t,r,n){if(e&&e.o){if(B.has(e))return;B.add(e),D.c.push(()=>{B.delete(e),n&&(r&&e.d(1),n())}),e.o(t)}else n&&n()}function q(e){e&&e.c()}function H(e,t,n,s){const{fragment:a,after_update:c}=e.$$;a&&a.m(t,n),s||R(()=>{const t=e.$$.on_mount.map(r).filter(o);e.$$.on_destroy?e.$$.on_destroy.push(...t):i(t),e.$$.on_mount=[]}),c.forEach(R)}function K(e,t){const r=e.$$;null!==r.fragment&&(!function(e){const t=[],r=[];E.forEach(n=>-1===e.indexOf(n)?t.push(n):r.push(n)),r.forEach(e=>e()),E=t}(r.after_update),i(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function z(e,t){-1===e.$$.dirty[0]&&(I.push(e),k||(k=!0,A.then(M)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function V(t,r,o,s,a,c,l,h=[-1]){const d=m;_(t);const p=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(d?d.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:r.target||d.$$.root};l&&l(p.root);let f=!1;if(p.ctx=o?o(t,r.props||{},(e,r,...n)=>{const i=n.length?n[0]:r;return p.ctx&&a(p.ctx[e],p.ctx[e]=i)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](i),f&&z(t,e)),r}):[],p.update(),f=!0,i(p.before_update),p.fragment=!!s&&s(p.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);p.fragment&&p.fragment.l(e),e.forEach(u)}else p.fragment&&p.fragment.c();r.intro&&x(t.$$.fragment),H(t,r.target,r.anchor,r.customElement),M()}_(d)}class G{$destroy(){K(this,1),this.$destroy=e}$on(t,r){if(!o(r))return e;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(r),()=>{const e=n.indexOf(r);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const j=new WeakMap,Y=new WeakMap;function Q(e){const t=j.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function W(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function $(e,t){j.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const r=Object.keys(t);for(let e=0;e<r.length;++e){const t=r[e];t in this||Object.defineProperty(this,t,J(t))}}function J(e){return{get(){return Q(this).event[e]},set(t){Q(this).event[e]=t},configurable:!0,enumerable:!0}}function X(e){return{value(){const t=Q(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function Z(e){if(null==e||e===Object.prototype)return $;let t=Y.get(e);return null==t&&(t=function(e,t){const r=Object.keys(t);if(0===r.length)return e;function n(t,r){e.call(this,t,r)}n.prototype=Object.create(e.prototype,{constructor:{value:n,configurable:!0,writable:!0}});for(let i=0;i<r.length;++i){const o=r[i];if(!(o in e.prototype)){const e="function"==typeof Object.getOwnPropertyDescriptor(t,o).value;Object.defineProperty(n.prototype,o,e?X(o):J(o))}}return n}(Z(Object.getPrototypeOf(e)),e),Y.set(e,t)),t}function ee(e){return Q(e).immediateStopped}function te(e,t){Q(e).passiveListener=t}$.prototype={get type(){return Q(this).event.type},get target(){return Q(this).eventTarget},get currentTarget(){return Q(this).currentTarget},composedPath(){const e=Q(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return Q(this).eventPhase},stopPropagation(){const e=Q(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation(){const e=Q(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(Q(this).event.bubbles)},get cancelable(){return Boolean(Q(this).event.cancelable)},preventDefault(){W(Q(this))},get defaultPrevented(){return Q(this).canceled},get composed(){return Boolean(Q(this).event.composed)},get timeStamp(){return Q(this).timeStamp},get srcElement(){return Q(this).eventTarget},get cancelBubble(){return Q(this).stopped},set cancelBubble(e){if(!e)return;const t=Q(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)},get returnValue(){return!Q(this).canceled},set returnValue(e){e||W(Q(this))},initEvent(){}},Object.defineProperty($.prototype,"constructor",{value:$,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf($.prototype,window.Event.prototype),Y.set(window.Event.prototype,$));const re=new WeakMap;function ne(e){return null!==e&&"object"==typeof e}function ie(e){const t=re.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function oe(e,t){Object.defineProperty(e,"on"+t,function(e){return{get(){let t=ie(this).get(e);for(;null!=t;){if(3===t.listenerType)return t.listener;t=t.next}return null},set(t){"function"==typeof t||ne(t)||(t=null);const r=ie(this);let n=null,i=r.get(e);for(;null!=i;)3===i.listenerType?null!==n?n.next=i.next:null!==i.next?r.set(e,i.next):r.delete(e):n=i,i=i.next;if(null!==t){const i={listener:t,listenerType:3,passive:!1,once:!1,next:null};null===n?r.set(e,i):n.next=i}},configurable:!0,enumerable:!0}}(t))}function se(e){function t(){ae.call(this)}t.prototype=Object.create(ae.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let r=0;r<e.length;++r)oe(t.prototype,e[r]);return t}function ae(){if(!(this instanceof ae)){if(1===arguments.length&&Array.isArray(arguments[0]))return se(arguments[0]);if(arguments.length>0){const e=new Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return se(e)}throw new TypeError("Cannot call a class as a function")}re.set(this,new Map)}ae.prototype={addEventListener(e,t,r){if(null==t)return;if("function"!=typeof t&&!ne(t))throw new TypeError("'listener' should be a function or an object.");const n=ie(this),i=ne(r),o=(i?Boolean(r.capture):Boolean(r))?1:2,s={listener:t,listenerType:o,passive:i&&Boolean(r.passive),once:i&&Boolean(r.once),next:null};let a=n.get(e);if(void 0===a)return void n.set(e,s);let c=null;for(;null!=a;){if(a.listener===t&&a.listenerType===o)return;c=a,a=a.next}c.next=s},removeEventListener(e,t,r){if(null==t)return;const n=ie(this),i=(ne(r)?Boolean(r.capture):Boolean(r))?1:2;let o=null,s=n.get(e);for(;null!=s;){if(s.listener===t&&s.listenerType===i)return void(null!==o?o.next=s.next:null!==s.next?n.set(e,s.next):n.delete(e));o=s,s=s.next}},dispatchEvent(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');const t=ie(this),r=e.type;let n=t.get(r);if(null==n)return!0;const i=function(e,t){return new(Z(Object.getPrototypeOf(t)))(e,t)}(this,e);let o=null;for(;null!=n;){if(n.once?null!==o?o.next=n.next:null!==n.next?t.set(r,n.next):t.delete(r):o=n,te(i,n.passive?n.listener:null),"function"==typeof n.listener)try{n.listener.call(this,i)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==n.listenerType&&"function"==typeof n.listener.handleEvent&&n.listener.handleEvent(i);if(ee(i))break;n=n.next}return te(i,null),function(e,t){Q(e).eventPhase=t}(i,0),function(e,t){Q(e).currentTarget=t}(i,null),!i.defaultPrevented}},Object.defineProperty(ae.prototype,"constructor",{value:ae,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(ae.prototype,window.EventTarget.prototype);var ce={};function ue(e,t,r){return t<=e&&e<=r}function le(e){if(void 0===e)return{};if(e===Object(e))return e;throw TypeError("Could not convert argument to dictionary")}ce.SIZEOF_SHORT=2,ce.SIZEOF_INT=4,ce.FILE_IDENTIFIER_LENGTH=4,ce.Encoding={UTF8_BYTES:1,UTF16_STRING:2},ce.int32=new Int32Array(2),ce.float32=new Float32Array(ce.int32.buffer),ce.float64=new Float64Array(ce.int32.buffer),ce.isLittleEndian=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0],ce.Long=function(e,t){this.low=0|e,this.high=0|t},ce.Long.create=function(e,t){return 0==e&&0==t?ce.Long.ZERO:new ce.Long(e,t)},ce.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},ce.Long.prototype.equals=function(e){return this.low==e.low&&this.high==e.high},ce.Long.ZERO=new ce.Long(0,0),ce.Builder=function(e){if(e)t=e;else var t=1024;this.bb=ce.ByteBuffer.allocate(t),this.space=t,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},ce.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},ce.Builder.prototype.forceDefaults=function(e){this.force_defaults=e},ce.Builder.prototype.dataBuffer=function(){return this.bb},ce.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},ce.Builder.prototype.prep=function(e,t){e>this.minalign&&(this.minalign=e);for(var r=1+~(this.bb.capacity()-this.space+t)&e-1;this.space<r+e+t;){var n=this.bb.capacity();this.bb=ce.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n}this.pad(r)},ce.Builder.prototype.pad=function(e){for(var t=0;t<e;t++)this.bb.writeInt8(--this.space,0)},ce.Builder.prototype.writeInt8=function(e){this.bb.writeInt8(this.space-=1,e)},ce.Builder.prototype.writeInt16=function(e){this.bb.writeInt16(this.space-=2,e)},ce.Builder.prototype.writeInt32=function(e){this.bb.writeInt32(this.space-=4,e)},ce.Builder.prototype.writeInt64=function(e){this.bb.writeInt64(this.space-=8,e)},ce.Builder.prototype.writeFloat32=function(e){this.bb.writeFloat32(this.space-=4,e)},ce.Builder.prototype.writeFloat64=function(e){this.bb.writeFloat64(this.space-=8,e)},ce.Builder.prototype.addInt8=function(e){this.prep(1,0),this.writeInt8(e)},ce.Builder.prototype.addInt16=function(e){this.prep(2,0),this.writeInt16(e)},ce.Builder.prototype.addInt32=function(e){this.prep(4,0),this.writeInt32(e)},ce.Builder.prototype.addInt64=function(e){this.prep(8,0),this.writeInt64(e)},ce.Builder.prototype.addFloat32=function(e){this.prep(4,0),this.writeFloat32(e)},ce.Builder.prototype.addFloat64=function(e){this.prep(8,0),this.writeFloat64(e)},ce.Builder.prototype.addFieldInt8=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt8(t),this.slot(e))},ce.Builder.prototype.addFieldInt16=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt16(t),this.slot(e))},ce.Builder.prototype.addFieldInt32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addInt32(t),this.slot(e))},ce.Builder.prototype.addFieldInt64=function(e,t,r){!this.force_defaults&&t.equals(r)||(this.addInt64(t),this.slot(e))},ce.Builder.prototype.addFieldFloat32=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat32(t),this.slot(e))},ce.Builder.prototype.addFieldFloat64=function(e,t,r){(this.force_defaults||t!=r)&&(this.addFloat64(t),this.slot(e))},ce.Builder.prototype.addFieldOffset=function(e,t,r){(this.force_defaults||t!=r)&&(this.addOffset(t),this.slot(e))},ce.Builder.prototype.addFieldStruct=function(e,t,r){t!=r&&(this.nested(t),this.slot(e))},ce.Builder.prototype.nested=function(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},ce.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},ce.Builder.prototype.slot=function(e){this.vtable[e]=this.offset()},ce.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},ce.Builder.growByteBuffer=function(e){var t=e.capacity();if(3221225472&t)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var r=t<<1,n=ce.ByteBuffer.allocate(r);return n.setPosition(r-t),n.bytes().set(e.bytes(),r-t),n},ce.Builder.prototype.addOffset=function(e){this.prep(ce.SIZEOF_INT,0),this.writeInt32(this.offset()-e+ce.SIZEOF_INT)},ce.Builder.prototype.startObject=function(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(var t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()},ce.Builder.prototype.endObject=function(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var e=this.offset(),t=this.vtable_in_use-1;t>=0&&0==this.vtable[t];t--);for(var r=t+1;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);this.addInt16(e-this.object_start);var n=(r+2)*ce.SIZEOF_SHORT;this.addInt16(n);var i=0,o=this.space;e:for(t=0;t<this.vtables.length;t++){var s=this.bb.capacity()-this.vtables[t];if(n==this.bb.readInt16(s)){for(var a=ce.SIZEOF_SHORT;a<n;a+=ce.SIZEOF_SHORT)if(this.bb.readInt16(o+a)!=this.bb.readInt16(s+a))continue e;i=this.vtables[t];break}}return i?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,i-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e},ce.Builder.prototype.finish=function(e,t){if(t){var r=t;if(this.prep(this.minalign,ce.SIZEOF_INT+ce.FILE_IDENTIFIER_LENGTH),r.length!=ce.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+ce.FILE_IDENTIFIER_LENGTH);for(var n=ce.FILE_IDENTIFIER_LENGTH-1;n>=0;n--)this.writeInt8(r.charCodeAt(n))}this.prep(this.minalign,ce.SIZEOF_INT),this.addOffset(e),this.bb.setPosition(this.space)},ce.Builder.prototype.requiredField=function(e,t){var r=this.bb.capacity()-e,n=r-this.bb.readInt32(r);if(!(0!=this.bb.readInt16(n+t)))throw new Error("FlatBuffers: field "+t+" must be set")},ce.Builder.prototype.startVector=function(e,t,r){this.notNested(),this.vector_num_elems=t,this.prep(ce.SIZEOF_INT,e*t),this.prep(r,e*t)},ce.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},ce.Builder.prototype.createString=function(e){if(e instanceof Uint8Array)var t=e;else{t=[];for(var r=0;r<e.length;){var n,i=e.charCodeAt(r++);if(i<55296||i>=56320)n=i;else n=(i<<10)+e.charCodeAt(r++)+-56613888;n<128?t.push(n):(n<2048?t.push(n>>6&31|192):(n<65536?t.push(n>>12&15|224):t.push(n>>18&7|240,n>>12&63|128),t.push(n>>6&63|128)),t.push(63&n|128))}}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length);r=0;for(var o=this.space,s=this.bb.bytes();r<t.length;r++)s[o++]=t[r];return this.endVector()},ce.Builder.prototype.createLong=function(e,t){return ce.Long.create(e,t)},ce.ByteBuffer=function(e){this.bytes_=e,this.position_=0},ce.ByteBuffer.allocate=function(e){return new ce.ByteBuffer(new Uint8Array(e))},ce.ByteBuffer.prototype.clear=function(){this.position_=0},ce.ByteBuffer.prototype.bytes=function(){return this.bytes_},ce.ByteBuffer.prototype.position=function(){return this.position_},ce.ByteBuffer.prototype.setPosition=function(e){this.position_=e},ce.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},ce.ByteBuffer.prototype.readInt8=function(e){return this.readUint8(e)<<24>>24},ce.ByteBuffer.prototype.readUint8=function(e){return this.bytes_[e]},ce.ByteBuffer.prototype.readInt16=function(e){return this.readUint16(e)<<16>>16},ce.ByteBuffer.prototype.readUint16=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8},ce.ByteBuffer.prototype.readInt32=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24},ce.ByteBuffer.prototype.readUint32=function(e){return this.readInt32(e)>>>0},ce.ByteBuffer.prototype.readInt64=function(e){return new ce.Long(this.readInt32(e),this.readInt32(e+4))},ce.ByteBuffer.prototype.readUint64=function(e){return new ce.Long(this.readUint32(e),this.readUint32(e+4))},ce.ByteBuffer.prototype.readFloat32=function(e){return ce.int32[0]=this.readInt32(e),ce.float32[0]},ce.ByteBuffer.prototype.readFloat64=function(e){return ce.int32[ce.isLittleEndian?0:1]=this.readInt32(e),ce.int32[ce.isLittleEndian?1:0]=this.readInt32(e+4),ce.float64[0]},ce.ByteBuffer.prototype.writeInt8=function(e,t){this.bytes_[e]=t},ce.ByteBuffer.prototype.writeUint8=function(e,t){this.bytes_[e]=t},ce.ByteBuffer.prototype.writeInt16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},ce.ByteBuffer.prototype.writeUint16=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8},ce.ByteBuffer.prototype.writeInt32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},ce.ByteBuffer.prototype.writeUint32=function(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24},ce.ByteBuffer.prototype.writeInt64=function(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high)},ce.ByteBuffer.prototype.writeUint64=function(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high)},ce.ByteBuffer.prototype.writeFloat32=function(e,t){ce.float32[0]=t,this.writeInt32(e,ce.int32[0])},ce.ByteBuffer.prototype.writeFloat64=function(e,t){ce.float64[0]=t,this.writeInt32(e,ce.int32[ce.isLittleEndian?0:1]),this.writeInt32(e+4,ce.int32[ce.isLittleEndian?1:0])},ce.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+ce.SIZEOF_INT+ce.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var e="",t=0;t<ce.FILE_IDENTIFIER_LENGTH;t++)e+=String.fromCharCode(this.readInt8(this.position_+ce.SIZEOF_INT+t));return e},ce.ByteBuffer.prototype.__offset=function(e,t){var r=e-this.readInt32(e);return t<this.readInt16(r)?this.readInt16(r+t):0},ce.ByteBuffer.prototype.__union=function(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e},ce.ByteBuffer.prototype.__string=function(e,t){e+=this.readInt32(e);var r=this.readInt32(e),n="",i=0;if(e+=ce.SIZEOF_INT,t===ce.Encoding.UTF8_BYTES)return this.bytes_.subarray(e,e+r);for(;i<r;){var o,s=this.readUint8(e+i++);if(s<192)o=s;else{var a=this.readUint8(e+i++);if(s<224)o=(31&s)<<6|63&a;else{var c=this.readUint8(e+i++);if(s<240)o=(15&s)<<12|(63&a)<<6|63&c;else o=(7&s)<<18|(63&a)<<12|(63&c)<<6|63&this.readUint8(e+i++)}}o<65536?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode(55296+(o>>10),56320+(1023&o)))}return n},ce.ByteBuffer.prototype.__indirect=function(e){return e+this.readInt32(e)},ce.ByteBuffer.prototype.__vector=function(e){return e+this.readInt32(e)+ce.SIZEOF_INT},ce.ByteBuffer.prototype.__vector_len=function(e){return this.readInt32(e+this.readInt32(e))},ce.ByteBuffer.prototype.__has_identifier=function(e){if(e.length!=ce.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+ce.FILE_IDENTIFIER_LENGTH);for(var t=0;t<ce.FILE_IDENTIFIER_LENGTH;t++)if(e.charCodeAt(t)!=this.readInt8(this.position_+ce.SIZEOF_INT+t))return!1;return!0},ce.ByteBuffer.prototype.createLong=function(e,t){return ce.Long.create(e,t)};function he(e){this.tokens=[].slice.call(e)}he.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():-1},prepend:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(e)},push:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.push(t.shift());else this.tokens.push(e)}};function de(e,t){if(e)throw TypeError("Decoder error");return t||65533}function pe(e,t){if(!(this instanceof pe))return new pe(e,t);if("utf-8"!==(e=void 0!==e?String(e).toLowerCase():"utf-8"))throw new Error("Encoding not supported. Only utf-8 is supported");t=le(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(t.fatal),this._ignoreBOM=Boolean(t.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}function fe(e,t){if(!(this instanceof fe))return new fe(e,t);if("utf-8"!==(e=void 0!==e?String(e).toLowerCase():"utf-8"))throw new Error("Encoding not supported. Only utf-8 is supported");t=le(t),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(t.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}function ge(e){var t=e.fatal,r=0,n=0,i=0,o=128,s=191;this.handler=function(e,a){if(-1===a&&0!==i)return i=0,de(t);if(-1===a)return-1;if(0===i){if(ue(a,0,127))return a;if(ue(a,194,223))i=1,r=a-192;else if(ue(a,224,239))224===a&&(o=160),237===a&&(s=159),i=2,r=a-224;else{if(!ue(a,240,244))return de(t);240===a&&(o=144),244===a&&(s=143),i=3,r=a-240}return r<<=6*i,null}if(!ue(a,o,s))return r=i=n=0,o=128,s=191,e.prepend(a),de(t);if(o=128,s=191,r+=a-128<<6*(i-(n+=1)),n!==i)return null;var c=r;return r=i=n=0,c}}function ye(e){e.fatal,this.handler=function(e,t){if(-1===t)return-1;if(ue(t,0,127))return t;var r,n;ue(t,128,2047)?(r=1,n=192):ue(t,2048,65535)?(r=2,n=224):ue(t,65536,1114111)&&(r=3,n=240);for(var i=[(t>>6*r)+n];r>0;){var o=t>>6*(r-1);i.push(128|63&o),r-=1}return i}}pe.prototype={decode:function(e,t){var r;r="object"==typeof e&&e instanceof ArrayBuffer?new Uint8Array(e):"object"==typeof e&&"buffer"in e&&e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(0),t=le(t),this._streaming||(this._decoder=new ge({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(t.stream);for(var n,i=new he(r),o=[];!i.endOfStream()&&-1!==(n=this._decoder.handler(i,i.read()));)null!==n&&(Array.isArray(n)?o.push.apply(o,n):o.push(n));if(!this._streaming){do{if(-1===(n=this._decoder.handler(i,i.read())))break;null!==n&&(Array.isArray(n)?o.push.apply(o,n):o.push(n))}while(!i.endOfStream());this._decoder=null}return o.length&&(-1===["utf-8"].indexOf(this.encoding)||this._ignoreBOM||this._BOMseen||(65279===o[0]?(this._BOMseen=!0,o.shift()):this._BOMseen=!0)),function(e){for(var t="",r=0;r<e.length;++r){var n=e[r];n<=65535?t+=String.fromCharCode(n):(n-=65536,t+=String.fromCharCode(55296+(n>>10),56320+(1023&n)))}return t}(o)}},fe.prototype={encode:function(e,t){e=e?String(e):"",t=le(t),this._streaming||(this._encoder=new ye(this._options)),this._streaming=Boolean(t.stream);for(var r,n=[],i=new he(function(e){for(var t=String(e),r=t.length,n=0,i=[];n<r;){var o=t.charCodeAt(n);if(o<55296||o>57343)i.push(o);else if(56320<=o&&o<=57343)i.push(65533);else if(55296<=o&&o<=56319)if(n===r-1)i.push(65533);else{var s=e.charCodeAt(n+1);if(56320<=s&&s<=57343){var a=1023&o,c=1023&s;i.push(65536+(a<<10)+c),n+=1}else i.push(65533)}n+=1}return i}(e));!i.endOfStream()&&-1!==(r=this._encoder.handler(i,i.read()));)Array.isArray(r)?n.push.apply(n,r):n.push(r);if(!this._streaming){for(;-1!==(r=this._encoder.handler(i,i.read()));)Array.isArray(r)?n.push.apply(n,r):n.push(r);this._encoder=null}return new Uint8Array(n)}};const me="function"==typeof Buffer?Buffer:null,ve="function"==typeof TextDecoder&&"function"==typeof TextEncoder,be=(e=>{if(ve||!me){const t=new e("utf-8");return e=>t.decode(e)}return e=>{const{buffer:t,byteOffset:r,length:n}=$e(e);return me.from(t,r,n).toString()}})("undefined"!=typeof TextDecoder?TextDecoder:pe),_e=(e=>{if(ve||!me){const t=new e;return e=>t.encode(e)}return(e="")=>$e(me.from(e,"utf8"))})("undefined"!=typeof TextEncoder?TextEncoder:fe),we=Object.freeze({done:!0,value:void 0});class Te{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class Ie{tee(){return this._getDOMStream().tee()}pipe(e,t){return this._getNodeStream().pipe(e,t)}pipeTo(e,t){return this._getDOMStream().pipeTo(e,t)}pipeThrough(e,t){return this._getDOMStream().pipeThrough(e,t)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class Ce extends Ie{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}async cancel(e){await this.return(e)}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){const{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(we);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return ot.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return ot.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}async throw(e){return await this.abort(e),we}async return(e){return await this.close(),we}async read(e){return(await this.next(e,"read")).value}async peek(e){return(await this.next(e,"peek")).value}next(...e){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((e,t)=>{this.resolvers.push({resolve:e,reject:t})}):Promise.resolve(we)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error(this+" is closed")}}const[Ee,Se]=(()=>{const e=()=>{throw new Error("BigInt is not available in this environment")};function t(){throw e()}return t.asIntN=()=>{throw e()},t.asUintN=()=>{throw e()},"undefined"!=typeof BigInt?[BigInt,!0]:[t,!1]})(),[Ae,ke]=(()=>{const e=()=>{throw new Error("BigInt64Array is not available in this environment")};return"undefined"!=typeof BigInt64Array?[BigInt64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}},!1]})(),[Re,Ne]=(()=>{const e=()=>{throw new Error("BigUint64Array is not available in this environment")};return"undefined"!=typeof BigUint64Array?[BigUint64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw e()}static from(){throw e()}constructor(){throw e()}},!1]})(),Oe=e=>"boolean"==typeof e,Me=e=>"function"==typeof e,Pe=e=>null!=e&&Object(e)===e,Be=e=>Pe(e)&&Me(e.then),De=e=>Pe(e)&&Me(e[Symbol.iterator]),Ue=e=>Pe(e)&&Me(e[Symbol.asyncIterator]),Le=e=>Pe(e)&&Pe(e.schema),xe=e=>Pe(e)&&"done"in e&&"value"in e,Fe=e=>Pe(e)&&Me(e.stat)&&(e=>"number"==typeof e)(e.fd),qe=e=>Pe(e)&&He(e.body),He=e=>Pe(e)&&Me(e.cancel)&&Me(e.getReader)&&!(e instanceof Ie),Ke=e=>Pe(e)&&Me(e.read)&&Me(e.pipe)&&Oe(e.readable)&&!(e instanceof Ie);var ze=ce.ByteBuffer;const Ve="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function Ge(e,t,r=0,n=t.byteLength){const i=e.byteLength,o=new Uint8Array(e.buffer,e.byteOffset,i),s=new Uint8Array(t.buffer,t.byteOffset,Math.min(n,i));return o.set(s,r),e}function je(e,t){let r,n,i,o=function(e){let t,r,n,i,o=e[0]?[e[0]]:[];for(let s,a,c=0,u=0,l=e.length;++c<l;)s=o[u],a=e[c],!s||!a||s.buffer!==a.buffer||a.byteOffset<s.byteOffset?a&&(o[++u]=a):(({byteOffset:t,byteLength:n}=s),({byteOffset:r,byteLength:i}=a),t+n<r||r+i<t?a&&(o[++u]=a):o[u]=new Uint8Array(s.buffer,t,r-t+i));return o}(e),s=o.reduce((e,t)=>e+t.byteLength,0),a=0,c=-1,u=Math.min(t||1/0,s);for(let e=o.length;++c<e;){if(r=o[c],n=r.subarray(0,Math.min(r.length,u-a)),u<=a+n.length){n.length<r.length?o[c]=r.subarray(n.length):n.length===r.length&&c++,i?Ge(i,n,a):i=n;break}Ge(i||(i=new Uint8Array(u)),n,a),a+=n.length}return[i||new Uint8Array(0),o.slice(c),s-(i?i.byteLength:0)]}function Ye(e,t){let r=xe(t)?t.value:t;return r instanceof e?e===Uint8Array?new e(r.buffer,r.byteOffset,r.byteLength):r:r?("string"==typeof r&&(r=_e(r)),r instanceof ArrayBuffer||r instanceof Ve?new e(r):r instanceof ze?Ye(e,r.bytes()):ArrayBuffer.isView(r)?r.byteLength<=0?new e(0):new e(r.buffer,r.byteOffset,r.byteLength/e.BYTES_PER_ELEMENT):e.from(r)):new e(0)}const Qe=e=>Ye(Int32Array,e),We=e=>Ye(Ae,e),$e=e=>Ye(Uint8Array,e),Je=e=>Ye(Re,e),Xe=e=>(e.next(),e);function*Ze(e,t){const r=function*(e){yield e},n="string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof Ve?r(t):De(t)?t:r(t);yield*Xe(function*(t){let r=null;do{r=t.next(yield Ye(e,r))}while(!r.done)}(n[Symbol.iterator]()))}const et=e=>Ze(Uint8Array,e);async function*tt(e,t){if(Be(t))return yield*tt(e,await t);const r=async function*(e){yield await e},n="string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof Ve?r(t):De(t)?async function*(e){yield*Xe(function*(e){let t=null;do{t=e.next(yield t&&t.value)}while(!t.done)}(e[Symbol.iterator]()))}(t):Ue(t)?t:r(t);yield*Xe(async function*(t){let r=null;do{r=await t.next(yield Ye(e,r))}while(!r.done)}(n[Symbol.asyncIterator]()))}const rt=e=>tt(Uint8Array,e);function nt(e,t,r){if(0!==e){r=r.slice(0,t+1);for(let n=-1;++n<=t;)r[n]+=e}return r}function it(e,t){let r=0,n=e.length;if(n!==t.length)return!1;if(n>0)do{if(e[r]!==t[r])return!1}while(++r<n);return!0}var ot={fromIterable:e=>st(function*(e){let t,r,n,i,o=!1,s=[],a=0;({cmd:n,size:i}=yield null);let c=et(e)[Symbol.iterator]();try{do{if(({done:t,value:r}=isNaN(i-a)?c.next(void 0):c.next(i-a)),!t&&r.byteLength>0&&(s.push(r),a+=r.byteLength),t||i<=a)do{({cmd:n,size:i}=yield"peek"===n?je(s,i)[0]:([r,s,a]=je(s,i),r))}while(i<a)}while(!t)}catch(e){(o=!0)&&"function"==typeof c.throw&&c.throw(e)}finally{!1===o&&"function"==typeof c.return&&c.return()}}(e)),fromAsyncIterable:e=>st(async function*(e){let t,r,n,i,o=!1,s=[],a=0;({cmd:n,size:i}=yield null);let c=rt(e)[Symbol.asyncIterator]();try{do{if(({done:t,value:r}=isNaN(i-a)?await c.next(void 0):await c.next(i-a)),!t&&r.byteLength>0&&(s.push(r),a+=r.byteLength),t||i<=a)do{({cmd:n,size:i}=yield"peek"===n?je(s,i)[0]:([r,s,a]=je(s,i),r))}while(i<a)}while(!t)}catch(e){(o=!0)&&"function"==typeof c.throw&&await c.throw(e)}finally{!1===o&&"function"==typeof c.return&&await c.return()}}(e)),fromDOMStream:e=>st(async function*(e){let t,r,n,i=!1,o=!1,s=[],a=0;({cmd:r,size:n}=yield null);let c=new at(e);try{do{if(({done:i,value:t}=isNaN(n-a)?await c.read(void 0):await c.read(n-a)),!i&&t.byteLength>0&&(s.push($e(t)),a+=t.byteLength),i||n<=a)do{({cmd:r,size:n}=yield"peek"===r?je(s,n)[0]:([t,s,a]=je(s,n),t))}while(n<a)}while(!i)}catch(e){(o=!0)&&await c.cancel(e)}finally{!1===o?await c.cancel():e.locked&&c.releaseLock()}}(e)),fromNodeStream:e=>st(async function*(e){let t,r,n,i=[],o="error",s=!1,a=null,c=0,u=[];if(({cmd:t,size:r}=yield null),e.isTTY)return yield new Uint8Array(0);try{i[0]=ct(e,"end"),i[1]=ct(e,"error");do{if(i[2]=ct(e,"readable"),[o,a]=await Promise.race(i.map(e=>e[2])),"error"===o)break;if((s="end"===o)||(isFinite(r-c)?(n=$e(e.read(r-c)),n.byteLength<r-c&&(n=$e(e.read(void 0)))):n=$e(e.read(void 0)),n.byteLength>0&&(u.push(n),c+=n.byteLength)),s||r<=c)do{({cmd:t,size:r}=yield"peek"===t?je(u,r)[0]:([n,u,c]=je(u,r),n))}while(r<c)}while(!s)}finally{await function(t,r){return n=u=null,new Promise(async(n,i)=>{for(const[r,n]of t)e.off(r,n);try{const t=e.destroy;t&&t.call(e,r),r=void 0}catch(e){r=e||r}finally{null!=r?i(r):n()}})}(i,"error"===o?a:null)}}(e)),toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}};const st=e=>(e.next(),e);class at{constructor(e){this.source=e,this.byobReader=null,this.defaultReader=null;try{this.supportsBYOB=!!(this.reader=this.getBYOBReader())}catch(e){this.supportsBYOB=!(this.reader=this.getDefaultReader())}}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=this.byobReader=this.defaultReader=null}async cancel(e){const{reader:t,source:r}=this;t&&await t.cancel(e).catch(()=>{}),r&&r.locked&&this.releaseLock()}async read(e){if(0===e)return{done:null==this.reader,value:new Uint8Array(0)};const t=this.supportsBYOB&&"number"==typeof e?await this.readFromBYOBReader(e):await this.getDefaultReader().read();return!t.done&&(t.value=$e(t)),t}getDefaultReader(){return this.byobReader&&this.releaseLock(),this.defaultReader||(this.defaultReader=this.source.getReader(),this.defaultReader.closed.catch(()=>{})),this.reader=this.defaultReader}getBYOBReader(){return this.defaultReader&&this.releaseLock(),this.byobReader||(this.byobReader=this.source.getReader({mode:"byob"}),this.byobReader.closed.catch(()=>{})),this.reader=this.byobReader}async readFromBYOBReader(e){return await async function e(t,r,n,i){if(n>=i)return{done:!1,value:new Uint8Array(r,0,i)};const{done:o,value:s}=await t.read(new Uint8Array(r,n,i-n));if((n+=s.byteLength)<i&&!o)return await e(t,s.buffer,n,i);return{done:o,value:new Uint8Array(s.buffer,0,n)}}(this.getBYOBReader(),new ArrayBuffer(e),0,e)}}const ct=(e,t)=>{let r,n=e=>r([t,e]);return[t,n,new Promise(i=>(r=i)&&e.once(t,n))]};class ut{}var lt,ht;!function(e){var t,r,n;t=e.apache||(e.apache={}),r=t.arrow||(t.arrow={}),function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4"}((n=r.flatbuf||(r.flatbuf={})).MetadataVersion||(n.MetadataVersion={}))}(lt||(lt={})),function(e){var t,r,n;t=e.apache||(e.apache={}),r=t.arrow||(t.arrow={}),function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"}((n=r.flatbuf||(r.flatbuf={})).UnionMode||(n.UnionMode={}))}(lt||(lt={})),function(e){var t,r,n;t=e.apache||(e.apache={}),r=t.arrow||(t.arrow={}),function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"}((n=r.flatbuf||(r.flatbuf={})).Precision||(n.Precision={}))}(lt||(lt={})),function(e){var t,r,n;t=e.apache||(e.apache={}),r=t.arrow||(t.arrow={}),function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"}((n=r.flatbuf||(r.flatbuf={})).DateUnit||(n.DateUnit={}))}(lt||(lt={})),function(e){var t,r,n;t=e.apache||(e.apache={}),r=t.arrow||(t.arrow={}),function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"}((n=r.flatbuf||(r.flatbuf={})).TimeUnit||(n.TimeUnit={}))}(lt||(lt={})),function(e){var t,r,n;t=e.apache||(e.apache={}),r=t.arrow||(t.arrow={}),function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME"}((n=r.flatbuf||(r.flatbuf={})).IntervalUnit||(n.IntervalUnit={}))}(lt||(lt={})),function(e){var t,r,n;t=e.apache||(e.apache={}),r=t.arrow||(t.arrow={}),function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList"}((n=r.flatbuf||(r.flatbuf={})).Type||(n.Type={}))}(lt||(lt={})),function(e){var t,r,n,i;t=e.apache||(e.apache={}),r=t.arrow||(t.arrow={}),n=r.flatbuf||(r.flatbuf={}),(i=n.Endianness||(n.Endianness={}))[i.Little=0]="Little",i[i.Big=1]="Big"}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNull(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startNull(e){e.startObject(0)}static endNull(e){return e.endObject()}static createNull(e){return t.startNull(e),t.endNull(e)}}e.Null=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsStruct_(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startStruct_(e){e.startObject(0)}static endStruct_(e){return e.endObject()}static createStruct_(e){return t.startStruct_(e),t.endStruct_(e)}}e.Struct_=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsList(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startList(e){e.startObject(0)}static endList(e){return e.endObject()}static createList(e){return t.startList(e),t.endList(e)}}e.List=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsLargeList(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startLargeList(e){e.startObject(0)}static endLargeList(e){return e.endObject()}static createLargeList(e){return t.startLargeList(e),t.endLargeList(e)}}e.LargeList=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeList(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}listSize(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeList(e){e.startObject(1)}static addListSize(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeList(e){return e.endObject()}static createFixedSizeList(e,r){return t.startFixedSizeList(e),t.addListSize(e,r),t.endFixedSizeList(e)}}e.FixedSizeList=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMap(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}keysSorted(){let e=this.bb.__offset(this.bb_pos,4);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startMap(e){e.startObject(1)}static addKeysSorted(e,t){e.addFieldInt8(0,+t,0)}static endMap(e){return e.endObject()}static createMap(e,r){return t.startMap(e),t.addKeysSorted(e,r),t.endMap(e)}}e.Map=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUnion(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}mode(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):e.apache.arrow.flatbuf.UnionMode.Sparse}typeIds(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0}typeIdsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}typeIdsArray(){let e=this.bb.__offset(this.bb_pos,6);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}static startUnion(e){e.startObject(2)}static addMode(t,r){t.addFieldInt16(0,r,e.apache.arrow.flatbuf.UnionMode.Sparse)}static addTypeIds(e,t){e.addFieldOffset(1,t,0)}static createTypeIdsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addInt32(t[r]);return e.endVector()}static startTypeIdsVector(e,t){e.startVector(4,t,4)}static endUnion(e){return e.endObject()}static createUnion(e,t,n){return r.startUnion(e),r.addMode(e,t),r.addTypeIds(e,n),r.endUnion(e)}}t.Union=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInt(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}bitWidth(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}isSigned(){let e=this.bb.__offset(this.bb_pos,6);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startInt(e){e.startObject(2)}static addBitWidth(e,t){e.addFieldInt32(0,t,0)}static addIsSigned(e,t){e.addFieldInt8(1,+t,0)}static endInt(e){return e.endObject()}static createInt(e,r,n){return t.startInt(e),t.addBitWidth(e,r),t.addIsSigned(e,n),t.endInt(e)}}e.Int=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFloatingPoint(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):e.apache.arrow.flatbuf.Precision.HALF}static startFloatingPoint(e){e.startObject(1)}static addPrecision(t,r){t.addFieldInt16(0,r,e.apache.arrow.flatbuf.Precision.HALF)}static endFloatingPoint(e){return e.endObject()}static createFloatingPoint(e,t){return r.startFloatingPoint(e),r.addPrecision(e,t),r.endFloatingPoint(e)}}t.FloatingPoint=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUtf8(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startUtf8(e){e.startObject(0)}static endUtf8(e){return e.endObject()}static createUtf8(e){return t.startUtf8(e),t.endUtf8(e)}}e.Utf8=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBinary(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startBinary(e){e.startObject(0)}static endBinary(e){return e.endObject()}static createBinary(e){return t.startBinary(e),t.endBinary(e)}}e.Binary=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsLargeUtf8(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startLargeUtf8(e){e.startObject(0)}static endLargeUtf8(e){return e.endObject()}static createLargeUtf8(e){return t.startLargeUtf8(e),t.endLargeUtf8(e)}}e.LargeUtf8=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsLargeBinary(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startLargeBinary(e){e.startObject(0)}static endLargeBinary(e){return e.endObject()}static createLargeBinary(e){return t.startLargeBinary(e),t.endLargeBinary(e)}}e.LargeBinary=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeBinary(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}byteWidth(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeBinary(e){e.startObject(1)}static addByteWidth(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeBinary(e){return e.endObject()}static createFixedSizeBinary(e,r){return t.startFixedSizeBinary(e),t.addByteWidth(e,r),t.endFixedSizeBinary(e)}}e.FixedSizeBinary=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBool(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}static startBool(e){e.startObject(0)}static endBool(e){return e.endObject()}static createBool(e){return t.startBool(e),t.endBool(e)}}e.Bool=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDecimal(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}precision(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}scale(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0}static startDecimal(e){e.startObject(2)}static addPrecision(e,t){e.addFieldInt32(0,t,0)}static addScale(e,t){e.addFieldInt32(1,t,0)}static endDecimal(e){return e.endObject()}static createDecimal(e,r,n){return t.startDecimal(e),t.addPrecision(e,r),t.addScale(e,n),t.endDecimal(e)}}e.Decimal=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDate(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):e.apache.arrow.flatbuf.DateUnit.MILLISECOND}static startDate(e){e.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,e.apache.arrow.flatbuf.DateUnit.MILLISECOND)}static endDate(e){return e.endObject()}static createDate(e,t){return r.startDate(e),r.addUnit(e,t),r.endDate(e)}}t.Date=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTime(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):e.apache.arrow.flatbuf.TimeUnit.MILLISECOND}bitWidth(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):32}static startTime(e){e.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,e.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static addBitWidth(e,t){e.addFieldInt32(1,t,32)}static endTime(e){return e.endObject()}static createTime(e,t,n){return r.startTime(e),r.addUnit(e,t),r.addBitWidth(e,n),r.endTime(e)}}t.Time=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTimestamp(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):e.apache.arrow.flatbuf.TimeUnit.SECOND}timezone(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startTimestamp(e){e.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,e.apache.arrow.flatbuf.TimeUnit.SECOND)}static addTimezone(e,t){e.addFieldOffset(1,t,0)}static endTimestamp(e){return e.endObject()}static createTimestamp(e,t,n){return r.startTimestamp(e),r.addUnit(e,t),r.addTimezone(e,n),r.endTimestamp(e)}}t.Timestamp=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInterval(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):e.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH}static startInterval(e){e.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,e.apache.arrow.flatbuf.IntervalUnit.YEAR_MONTH)}static endInterval(e){return e.endObject()}static createInterval(e,t){return r.startInterval(e),r.addUnit(e,t),r.endInterval(e)}}t.Interval=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDuration(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):e.apache.arrow.flatbuf.TimeUnit.MILLISECOND}static startDuration(e){e.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,e.apache.arrow.flatbuf.TimeUnit.MILLISECOND)}static endDuration(e){return e.endObject()}static createDuration(e,t){return r.startDuration(e),r.addUnit(e,t),r.endDuration(e)}}t.Duration=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(e){class t{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKeyValue(e,r){return(r||new t).__init(e.readInt32(e.position())+e.position(),e)}key(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}value(e){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startKeyValue(e){e.startObject(2)}static addKey(e,t){e.addFieldOffset(0,t,0)}static addValue(e,t){e.addFieldOffset(1,t,0)}static endKeyValue(e){return e.endObject()}static createKeyValue(e,r,n){return t.startKeyValue(e),t.addKey(e,r),t.addValue(e,n),t.endKeyValue(e)}}e.KeyValue=t}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryEncoding(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}id(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}indexType(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.apache.arrow.flatbuf.Int).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isOrdered(){let e=this.bb.__offset(this.bb_pos,8);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startDictionaryEncoding(e){e.startObject(3)}static addId(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addIndexType(e,t){e.addFieldOffset(1,t,0)}static addIsOrdered(e,t){e.addFieldInt8(2,+t,0)}static endDictionaryEncoding(e){return e.endObject()}static createDictionaryEncoding(e,t,n,i){return r.startDictionaryEncoding(e),r.addId(e,t),r.addIndexType(e,n),r.addIsOrdered(e,i),r.endDictionaryEncoding(e)}}t.DictionaryEncoding=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsField(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}name(e){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}nullable(){let e=this.bb.__offset(this.bb_pos,6);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}typeType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):e.apache.arrow.flatbuf.Type.NONE}type(e){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__union(e,this.bb_pos+t):null}dictionary(t){let r=this.bb.__offset(this.bb_pos,12);return r?(t||new e.apache.arrow.flatbuf.DictionaryEncoding).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}children(t,r){let n=this.bb.__offset(this.bb_pos,14);return n?(r||new e.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}childrenLength(){let e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,16);return n?(r||new e.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){let e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}static startField(e){e.startObject(7)}static addName(e,t){e.addFieldOffset(0,t,0)}static addNullable(e,t){e.addFieldInt8(1,+t,0)}static addTypeType(t,r){t.addFieldInt8(2,r,e.apache.arrow.flatbuf.Type.NONE)}static addType(e,t){e.addFieldOffset(3,t,0)}static addDictionary(e,t){e.addFieldOffset(4,t,0)}static addChildren(e,t){e.addFieldOffset(5,t,0)}static createChildrenVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startChildrenVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(6,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endField(e){return e.endObject()}static createField(e,t,n,i,o,s,a,c){return r.startField(e),r.addName(e,t),r.addNullable(e,n),r.addTypeType(e,i),r.addType(e,o),r.addDictionary(e,s),r.addChildren(e,a),r.addCustomMetadata(e,c),r.endField(e)}}t.Field=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={})).Buffer=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static createBuffer(e,t,r){return e.prep(8,16),e.writeInt64(r),e.writeInt64(t),e.offset()}}}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSchema(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}endianness(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):e.apache.arrow.flatbuf.Endianness.Little}fields(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.apache.arrow.flatbuf.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}fieldsLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new e.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSchema(e){e.startObject(3)}static addEndianness(t,r){t.addFieldInt16(0,r,e.apache.arrow.flatbuf.Endianness.Little)}static addFields(e,t){e.addFieldOffset(1,t,0)}static createFieldsVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startFieldsVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(2,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endSchema(e){return e.endObject()}static finishSchemaBuffer(e,t){e.finish(t)}static createSchema(e,t,n,i){return r.startSchema(e),r.addEndianness(e,t),r.addFields(e,n),r.addCustomMetadata(e,i),r.endSchema(e)}}t.Schema=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(lt||(lt={})),function(e){var t,r;t=e.apache||(e.apache={}),((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={})).Schema=lt.apache.arrow.flatbuf.Schema}(ht||(ht={})),function(e){var t,r,n;t=e.apache||(e.apache={}),r=t.arrow||(t.arrow={}),function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"}((n=r.flatbuf||(r.flatbuf={})).MessageHeader||(n.MessageHeader={}))}(ht||(ht={})),function(e){var t,r;t=e.apache||(e.apache={}),((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={})).FieldNode=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static createFieldNode(e,t,r){return e.prep(8,16),e.writeInt64(r),e.writeInt64(t),e.offset()}}}(ht||(ht={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsRecordBatch(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}length(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}nodes(t,r){let n=this.bb.__offset(this.bb_pos,6);return n?(r||new e.apache.arrow.flatbuf.FieldNode).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}nodesLength(){let e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}buffers(e,t){let r=this.bb.__offset(this.bb_pos,8);return r?(t||new lt.apache.arrow.flatbuf.Buffer).__init(this.bb.__vector(this.bb_pos+r)+16*e,this.bb):null}buffersLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}static startRecordBatch(e){e.startObject(3)}static addLength(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addNodes(e,t){e.addFieldOffset(1,t,0)}static startNodesVector(e,t){e.startVector(16,t,8)}static addBuffers(e,t){e.addFieldOffset(2,t,0)}static startBuffersVector(e,t){e.startVector(16,t,8)}static endRecordBatch(e){return e.endObject()}static createRecordBatch(e,t,n,i){return r.startRecordBatch(e),r.addLength(e,t),r.addNodes(e,n),r.addBuffers(e,i),r.endRecordBatch(e)}}t.RecordBatch=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(ht||(ht={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryBatch(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}id(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}data(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new e.apache.arrow.flatbuf.RecordBatch).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isDelta(){let e=this.bb.__offset(this.bb_pos,8);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startDictionaryBatch(e){e.startObject(3)}static addId(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addData(e,t){e.addFieldOffset(1,t,0)}static addIsDelta(e,t){e.addFieldInt8(2,+t,0)}static endDictionaryBatch(e){return e.endObject()}static createDictionaryBatch(e,t,n,i){return r.startDictionaryBatch(e),r.addId(e,t),r.addData(e,n),r.addIsDelta(e,i),r.endDictionaryBatch(e)}}t.DictionaryBatch=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(ht||(ht={})),function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMessage(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}version(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):lt.apache.arrow.flatbuf.MetadataVersion.V1}headerType(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):e.apache.arrow.flatbuf.MessageHeader.NONE}header(e){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}bodyLength(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}customMetadata(e,t){let r=this.bb.__offset(this.bb_pos,12);return r?(t||new lt.apache.arrow.flatbuf.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+4*e),this.bb):null}customMetadataLength(){let e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startMessage(e){e.startObject(5)}static addVersion(e,t){e.addFieldInt16(0,t,lt.apache.arrow.flatbuf.MetadataVersion.V1)}static addHeaderType(t,r){t.addFieldInt8(1,r,e.apache.arrow.flatbuf.MessageHeader.NONE)}static addHeader(e,t){e.addFieldOffset(2,t,0)}static addBodyLength(e,t){e.addFieldInt64(3,t,e.createLong(0,0))}static addCustomMetadata(e,t){e.addFieldOffset(4,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let r=t.length-1;r>=0;r--)e.addOffset(t[r]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endMessage(e){return e.endObject()}static finishMessageBuffer(e,t){e.finish(t)}static createMessage(e,t,n,i,o,s){return r.startMessage(e),r.addVersion(e,t),r.addHeaderType(e,n),r.addHeader(e,i),r.addBodyLength(e,o),r.addCustomMetadata(e,s),r.endMessage(e)}}t.Message=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(ht||(ht={})),lt.apache.arrow.flatbuf.Type;var dt,pt,ft=lt.apache.arrow.flatbuf.DateUnit,gt=lt.apache.arrow.flatbuf.TimeUnit,yt=lt.apache.arrow.flatbuf.Precision,mt=lt.apache.arrow.flatbuf.UnionMode,vt=lt.apache.arrow.flatbuf.IntervalUnit,bt=ht.apache.arrow.flatbuf.MessageHeader,_t=lt.apache.arrow.flatbuf.MetadataVersion;function wt(e,t,r,n){return 0!=(r&1<<n)}function Tt(e,t,r,n){return(r&1<<n)>>n}function It(e,t,r){return r?!!(e[t>>3]|=1<<t%8)||!0:!(e[t>>3]&=~(1<<t%8))&&!1}function Ct(e,t,r){const n=r.byteLength+7&-8;if(e>0||r.byteLength<n){const i=new Uint8Array(n);return i.set(e%8==0?r.subarray(e>>3):Et(St(r,e,t,null,wt)).subarray(0,n)),i}return r}function Et(e){let t=[],r=0,n=0,i=0;for(const o of e)o&&(i|=1<<n),8==++n&&(t[r++]=i,i=n=0);(0===r||n>0)&&(t[r++]=i);let o=new Uint8Array(t.length+7&-8);return o.set(t),o}function*St(e,t,r,n,i){let o=t%8,s=t>>3,a=0,c=r;for(;c>0;o=0){let t=e[s++];do{yield i(n,a++,t,o)}while(--c>0&&++o<8)}}function At(e,t,r){if(r-t<=0)return 0;if(r-t<8){let n=0;for(const i of St(e,t,r-t,e,Tt))n+=i;return n}const n=r>>3<<3,i=t+(t%8==0?0:8-t%8);return At(e,t,i)+At(e,n,r)+kt(e,i>>3,n-i>>3)}function kt(e,t,r){let n=0,i=0|t;const o=new DataView(e.buffer,e.byteOffset,e.byteLength),s=void 0===r?e.byteLength:i+r;for(;s-i>=4;)n+=Rt(o.getUint32(i)),i+=4;for(;s-i>=2;)n+=Rt(o.getUint16(i)),i+=2;for(;s-i>=1;)n+=Rt(o.getUint8(i)),i+=1;return n}function Rt(e){let t=0|e;return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24}!function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth"}(dt||(dt={})),function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"}(pt||(pt={}));class Nt{visitMany(e,...t){return e.map((e,r)=>this.visit(e,...t.map(e=>e[r])))}visit(...e){return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(e,t=!0){return function(e,t,r=!0){let n=null,i=dt.NONE;t instanceof Er||t instanceof ut?i=Ot(t.type):t instanceof zt?i=Ot(t):"number"!=typeof(i=t)&&(i=dt[t]);switch(i){case dt.Null:n=e.visitNull;break;case dt.Bool:n=e.visitBool;break;case dt.Int:n=e.visitInt;break;case dt.Int8:n=e.visitInt8||e.visitInt;break;case dt.Int16:n=e.visitInt16||e.visitInt;break;case dt.Int32:n=e.visitInt32||e.visitInt;break;case dt.Int64:n=e.visitInt64||e.visitInt;break;case dt.Uint8:n=e.visitUint8||e.visitInt;break;case dt.Uint16:n=e.visitUint16||e.visitInt;break;case dt.Uint32:n=e.visitUint32||e.visitInt;break;case dt.Uint64:n=e.visitUint64||e.visitInt;break;case dt.Float:n=e.visitFloat;break;case dt.Float16:n=e.visitFloat16||e.visitFloat;break;case dt.Float32:n=e.visitFloat32||e.visitFloat;break;case dt.Float64:n=e.visitFloat64||e.visitFloat;break;case dt.Utf8:n=e.visitUtf8;break;case dt.Binary:n=e.visitBinary;break;case dt.FixedSizeBinary:n=e.visitFixedSizeBinary;break;case dt.Date:n=e.visitDate;break;case dt.DateDay:n=e.visitDateDay||e.visitDate;break;case dt.DateMillisecond:n=e.visitDateMillisecond||e.visitDate;break;case dt.Timestamp:n=e.visitTimestamp;break;case dt.TimestampSecond:n=e.visitTimestampSecond||e.visitTimestamp;break;case dt.TimestampMillisecond:n=e.visitTimestampMillisecond||e.visitTimestamp;break;case dt.TimestampMicrosecond:n=e.visitTimestampMicrosecond||e.visitTimestamp;break;case dt.TimestampNanosecond:n=e.visitTimestampNanosecond||e.visitTimestamp;break;case dt.Time:n=e.visitTime;break;case dt.TimeSecond:n=e.visitTimeSecond||e.visitTime;break;case dt.TimeMillisecond:n=e.visitTimeMillisecond||e.visitTime;break;case dt.TimeMicrosecond:n=e.visitTimeMicrosecond||e.visitTime;break;case dt.TimeNanosecond:n=e.visitTimeNanosecond||e.visitTime;break;case dt.Decimal:n=e.visitDecimal;break;case dt.List:n=e.visitList;break;case dt.Struct:n=e.visitStruct;break;case dt.Union:n=e.visitUnion;break;case dt.DenseUnion:n=e.visitDenseUnion||e.visitUnion;break;case dt.SparseUnion:n=e.visitSparseUnion||e.visitUnion;break;case dt.Dictionary:n=e.visitDictionary;break;case dt.Interval:n=e.visitInterval;break;case dt.IntervalDayTime:n=e.visitIntervalDayTime||e.visitInterval;break;case dt.IntervalYearMonth:n=e.visitIntervalYearMonth||e.visitInterval;break;case dt.FixedSizeList:n=e.visitFixedSizeList;break;case dt.Map:n=e.visitMap}if("function"==typeof n)return n;if(!r)return()=>null;throw new Error(`Unrecognized type '${dt[i]}'`)}(this,e,t)}visitNull(e,...t){return null}visitBool(e,...t){return null}visitInt(e,...t){return null}visitFloat(e,...t){return null}visitUtf8(e,...t){return null}visitBinary(e,...t){return null}visitFixedSizeBinary(e,...t){return null}visitDate(e,...t){return null}visitTimestamp(e,...t){return null}visitTime(e,...t){return null}visitDecimal(e,...t){return null}visitList(e,...t){return null}visitStruct(e,...t){return null}visitUnion(e,...t){return null}visitDictionary(e,...t){return null}visitInterval(e,...t){return null}visitFixedSizeList(e,...t){return null}visitMap(e,...t){return null}}function Ot(e){switch(e.typeId){case dt.Null:return dt.Null;case dt.Int:const{bitWidth:t,isSigned:r}=e;switch(t){case 8:return r?dt.Int8:dt.Uint8;case 16:return r?dt.Int16:dt.Uint16;case 32:return r?dt.Int32:dt.Uint32;case 64:return r?dt.Int64:dt.Uint64}return dt.Int;case dt.Float:switch(e.precision){case yt.HALF:return dt.Float16;case yt.SINGLE:return dt.Float32;case yt.DOUBLE:return dt.Float64}return dt.Float;case dt.Binary:return dt.Binary;case dt.Utf8:return dt.Utf8;case dt.Bool:return dt.Bool;case dt.Decimal:return dt.Decimal;case dt.Time:switch(e.unit){case gt.SECOND:return dt.TimeSecond;case gt.MILLISECOND:return dt.TimeMillisecond;case gt.MICROSECOND:return dt.TimeMicrosecond;case gt.NANOSECOND:return dt.TimeNanosecond}return dt.Time;case dt.Timestamp:switch(e.unit){case gt.SECOND:return dt.TimestampSecond;case gt.MILLISECOND:return dt.TimestampMillisecond;case gt.MICROSECOND:return dt.TimestampMicrosecond;case gt.NANOSECOND:return dt.TimestampNanosecond}return dt.Timestamp;case dt.Date:switch(e.unit){case ft.DAY:return dt.DateDay;case ft.MILLISECOND:return dt.DateMillisecond}return dt.Date;case dt.Interval:switch(e.unit){case vt.DAY_TIME:return dt.IntervalDayTime;case vt.YEAR_MONTH:return dt.IntervalYearMonth}return dt.Interval;case dt.Map:return dt.Map;case dt.List:return dt.List;case dt.Struct:return dt.Struct;case dt.Union:switch(e.mode){case mt.Dense:return dt.DenseUnion;case mt.Sparse:return dt.SparseUnion}return dt.Union;case dt.FixedSizeBinary:return dt.FixedSizeBinary;case dt.FixedSizeList:return dt.FixedSizeList;case dt.Dictionary:return dt.Dictionary}throw new Error(`Unrecognized type '${dt[e.typeId]}'`)}Nt.prototype.visitInt8=null,Nt.prototype.visitInt16=null,Nt.prototype.visitInt32=null,Nt.prototype.visitInt64=null,Nt.prototype.visitUint8=null,Nt.prototype.visitUint16=null,Nt.prototype.visitUint32=null,Nt.prototype.visitUint64=null,Nt.prototype.visitFloat16=null,Nt.prototype.visitFloat32=null,Nt.prototype.visitFloat64=null,Nt.prototype.visitDateDay=null,Nt.prototype.visitDateMillisecond=null,Nt.prototype.visitTimestampSecond=null,Nt.prototype.visitTimestampMillisecond=null,Nt.prototype.visitTimestampMicrosecond=null,Nt.prototype.visitTimestampNanosecond=null,Nt.prototype.visitTimeSecond=null,Nt.prototype.visitTimeMillisecond=null,Nt.prototype.visitTimeMicrosecond=null,Nt.prototype.visitTimeNanosecond=null,Nt.prototype.visitDenseUnion=null,Nt.prototype.visitSparseUnion=null,Nt.prototype.visitIntervalDayTime=null,Nt.prototype.visitIntervalYearMonth=null;class Mt extends Nt{compareSchemas(e,t){return e===t||t instanceof e.constructor&&Kt.compareFields(e.fields,t.fields)}compareFields(e,t){return e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e,r)=>Kt.compareField(e,t[r]))}compareField(e,t){return e===t||t instanceof e.constructor&&e.name===t.name&&e.nullable===t.nullable&&Kt.visit(e.type,t.type)}}function Pt(e,t){return t instanceof e.constructor}function Bt(e,t){return e===t||Pt(e,t)}function Dt(e,t){return e===t||Pt(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function Ut(e,t){return e===t||Pt(e,t)&&e.precision===t.precision}function Lt(e,t){return e===t||Pt(e,t)&&e.unit===t.unit}function xt(e,t){return e===t||Pt(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function Ft(e,t){return e===t||Pt(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function qt(e,t){return e===t||Pt(e,t)&&e.mode===t.mode&&e.typeIds.every((e,r)=>e===t.typeIds[r])&&Kt.compareFields(e.children,t.children)}function Ht(e,t){return e===t||Pt(e,t)&&e.unit===t.unit}Mt.prototype.visitNull=Bt,Mt.prototype.visitBool=Bt,Mt.prototype.visitInt=Dt,Mt.prototype.visitInt8=Dt,Mt.prototype.visitInt16=Dt,Mt.prototype.visitInt32=Dt,Mt.prototype.visitInt64=Dt,Mt.prototype.visitUint8=Dt,Mt.prototype.visitUint16=Dt,Mt.prototype.visitUint32=Dt,Mt.prototype.visitUint64=Dt,Mt.prototype.visitFloat=Ut,Mt.prototype.visitFloat16=Ut,Mt.prototype.visitFloat32=Ut,Mt.prototype.visitFloat64=Ut,Mt.prototype.visitUtf8=Bt,Mt.prototype.visitBinary=Bt,Mt.prototype.visitFixedSizeBinary=function(e,t){return e===t||Pt(e,t)&&e.byteWidth===t.byteWidth},Mt.prototype.visitDate=Lt,Mt.prototype.visitDateDay=Lt,Mt.prototype.visitDateMillisecond=Lt,Mt.prototype.visitTimestamp=xt,Mt.prototype.visitTimestampSecond=xt,Mt.prototype.visitTimestampMillisecond=xt,Mt.prototype.visitTimestampMicrosecond=xt,Mt.prototype.visitTimestampNanosecond=xt,Mt.prototype.visitTime=Ft,Mt.prototype.visitTimeSecond=Ft,Mt.prototype.visitTimeMillisecond=Ft,Mt.prototype.visitTimeMicrosecond=Ft,Mt.prototype.visitTimeNanosecond=Ft,Mt.prototype.visitDecimal=Bt,Mt.prototype.visitList=function(e,t){return e===t||Pt(e,t)&&e.children.length===t.children.length&&Kt.compareFields(e.children,t.children)},Mt.prototype.visitStruct=function(e,t){return e===t||Pt(e,t)&&e.children.length===t.children.length&&Kt.compareFields(e.children,t.children)},Mt.prototype.visitUnion=qt,Mt.prototype.visitDenseUnion=qt,Mt.prototype.visitSparseUnion=qt,Mt.prototype.visitDictionary=function(e,t){return e===t||Pt(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&Kt.visit(e.indices,t.indices)&&Kt.visit(e.dictionary,t.dictionary)},Mt.prototype.visitInterval=Ht,Mt.prototype.visitIntervalDayTime=Ht,Mt.prototype.visitIntervalYearMonth=Ht,Mt.prototype.visitFixedSizeList=function(e,t){return e===t||Pt(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&Kt.compareFields(e.children,t.children)},Mt.prototype.visitMap=function(e,t){return e===t||Pt(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&Kt.compareFields(e.children,t.children)};const Kt=new Mt;class zt{static isNull(e){return e&&e.typeId===dt.Null}static isInt(e){return e&&e.typeId===dt.Int}static isFloat(e){return e&&e.typeId===dt.Float}static isBinary(e){return e&&e.typeId===dt.Binary}static isUtf8(e){return e&&e.typeId===dt.Utf8}static isBool(e){return e&&e.typeId===dt.Bool}static isDecimal(e){return e&&e.typeId===dt.Decimal}static isDate(e){return e&&e.typeId===dt.Date}static isTime(e){return e&&e.typeId===dt.Time}static isTimestamp(e){return e&&e.typeId===dt.Timestamp}static isInterval(e){return e&&e.typeId===dt.Interval}static isList(e){return e&&e.typeId===dt.List}static isStruct(e){return e&&e.typeId===dt.Struct}static isUnion(e){return e&&e.typeId===dt.Union}static isFixedSizeBinary(e){return e&&e.typeId===dt.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===dt.FixedSizeList}static isMap(e){return e&&e.typeId===dt.Map}static isDictionary(e){return e&&e.typeId===dt.Dictionary}get typeId(){return dt.NONE}compareTo(e){return Kt.visit(this,e)}}var Vt;zt[Symbol.toStringTag]=((Vt=zt.prototype).children=null,Vt.ArrayType=Array,Vt[Symbol.toStringTag]="DataType");class Gt extends zt{toString(){return"Null"}get typeId(){return dt.Null}}Gt[Symbol.toStringTag]=(e=>e[Symbol.toStringTag]="Null")(Gt.prototype);class jt extends zt{constructor(e,t){super(),this.isSigned=e,this.bitWidth=t}get typeId(){return dt.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:case 64:return this.isSigned?Int32Array:Uint32Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}jt[Symbol.toStringTag]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(jt.prototype);class Yt extends jt{constructor(){super(!0,8)}}class Qt extends jt{constructor(){super(!0,16)}}class Wt extends jt{constructor(){super(!0,32)}}class $t extends jt{constructor(){super(!0,64)}}class Jt extends jt{constructor(){super(!1,8)}}class Xt extends jt{constructor(){super(!1,16)}}class Zt extends jt{constructor(){super(!1,32)}}class er extends jt{constructor(){super(!1,64)}}Object.defineProperty(Yt.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(Qt.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(Wt.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty($t.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(Jt.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(Xt.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(Zt.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(er.prototype,"ArrayType",{value:Uint32Array});class tr extends zt{constructor(e){super(),this.precision=e}get typeId(){return dt.Float}get ArrayType(){switch(this.precision){case yt.HALF:return Uint16Array;case yt.SINGLE:return Float32Array;case yt.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return"Float"+(this.precision<<5||16)}}tr[Symbol.toStringTag]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(tr.prototype);class rr extends tr{constructor(){super(yt.HALF)}}class nr extends tr{constructor(){super(yt.SINGLE)}}class ir extends tr{constructor(){super(yt.DOUBLE)}}Object.defineProperty(rr.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(nr.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(ir.prototype,"ArrayType",{value:Float64Array});class or extends zt{constructor(){super()}get typeId(){return dt.Binary}toString(){return"Binary"}}or[Symbol.toStringTag]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(or.prototype);class sr extends zt{constructor(){super()}get typeId(){return dt.Utf8}toString(){return"Utf8"}}sr[Symbol.toStringTag]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(sr.prototype);class ar extends zt{constructor(){super()}get typeId(){return dt.Bool}toString(){return"Bool"}}ar[Symbol.toStringTag]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(ar.prototype);class cr extends zt{constructor(e,t){super(),this.scale=e,this.precision=t}get typeId(){return dt.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}cr[Symbol.toStringTag]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(cr.prototype);class ur extends zt{constructor(e){super(),this.unit=e}get typeId(){return dt.Date}toString(){return`Date${32*(this.unit+1)}<${ft[this.unit]}>`}}ur[Symbol.toStringTag]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Date"))(ur.prototype);class lr extends ur{constructor(){super(ft.DAY)}}class hr extends ur{constructor(){super(ft.MILLISECOND)}}class dr extends zt{constructor(e,t){super(),this.unit=e,this.bitWidth=t}get typeId(){return dt.Time}toString(){return`Time${this.bitWidth}<${gt[this.unit]}>`}}dr[Symbol.toStringTag]=(e=>(e.unit=null,e.bitWidth=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Time"))(dr.prototype);class pr extends zt{constructor(e,t){super(),this.unit=e,this.timezone=t}get typeId(){return dt.Timestamp}toString(){return`Timestamp<${gt[this.unit]}${this.timezone?", "+this.timezone:""}>`}}pr[Symbol.toStringTag]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Timestamp"))(pr.prototype);class fr extends zt{constructor(e){super(),this.unit=e}get typeId(){return dt.Interval}toString(){return`Interval<${vt[this.unit]}>`}}fr[Symbol.toStringTag]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(fr.prototype);class gr extends zt{constructor(e){super(),this.children=[e]}get typeId(){return dt.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}gr[Symbol.toStringTag]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(gr.prototype);class yr extends zt{constructor(e){super(),this.children=e}get typeId(){return dt.Struct}toString(){return`Struct<{${this.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}yr[Symbol.toStringTag]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(yr.prototype);class mr extends zt{constructor(e,t,r){super(),this.mode=e,this.children=r,this.typeIds=t=Int32Array.from(t),this.typeIdToChildIndex=t.reduce((e,t,r)=>(e[t]=r)&&e||e,Object.create(null))}get typeId(){return dt.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(e=>""+e.type).join(" | ")}>`}}mr[Symbol.toStringTag]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(mr.prototype);class vr extends zt{constructor(e){super(),this.byteWidth=e}get typeId(){return dt.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}vr[Symbol.toStringTag]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(vr.prototype);class br extends zt{constructor(e,t){super(),this.listSize=e,this.children=[t]}get typeId(){return dt.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}br[Symbol.toStringTag]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(br.prototype);class _r extends zt{constructor(e,t=!1){super(),this.children=[e],this.keysSorted=t}get typeId(){return dt.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}toString(){return`Map<{${this.children[0].type.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}_r[Symbol.toStringTag]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(_r.prototype);const wr=(Tr=-1,()=>++Tr);var Tr;class Ir extends zt{constructor(e,t,r,n){super(),this.indices=t,this.dictionary=e,this.isOrdered=n||!1,this.id=null==r?wr():"number"==typeof r?r:r.low}get typeId(){return dt.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function Cr(e){let t=e;switch(e.typeId){case dt.Decimal:return 4;case dt.Timestamp:return 2;case dt.Date:case dt.Interval:return 1+t.unit;case dt.Int:case dt.Time:return+(t.bitWidth>32)+1;case dt.FixedSizeList:return t.listSize;case dt.FixedSizeBinary:return t.byteWidth;default:return 1}}Ir[Symbol.toStringTag]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(Ir.prototype);class Er{constructor(e,t,r,n,i,o,s){let a;this.type=e,this.dictionary=s,this.offset=Math.floor(Math.max(t||0,0)),this.length=Math.floor(Math.max(r||0,0)),this._nullCount=Math.floor(Math.max(n||0,-1)),this.childData=(o||[]).map(e=>e instanceof Er?e:e.data),i instanceof Er?(this.stride=i.stride,this.values=i.values,this.typeIds=i.typeIds,this.nullBitmap=i.nullBitmap,this.valueOffsets=i.valueOffsets):(this.stride=Cr(e),i&&((a=i[0])&&(this.valueOffsets=a),(a=i[1])&&(this.values=a),(a=i[2])&&(this.nullBitmap=a),(a=i[3])&&(this.typeIds=a)))}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let e=0,{valueOffsets:t,values:r,nullBitmap:n,typeIds:i}=this;return t&&(e+=t.byteLength),r&&(e+=r.byteLength),n&&(e+=n.byteLength),i&&(e+=i.byteLength),this.childData.reduce((e,t)=>e+t.byteLength,e)}get nullCount(){let e,t=this._nullCount;return t<=-1&&(e=this.nullBitmap)&&(this._nullCount=t=this.length-At(e,this.offset,this.offset+this.length)),t}clone(e,t=this.offset,r=this.length,n=this._nullCount,i=this,o=this.childData){return new Er(e,t,r,n,i,o,this.dictionary)}slice(e,t){const{stride:r,typeId:n,childData:i}=this,o=+(0===this._nullCount)-1,s=16===n?r:1,a=this._sliceBuffers(e,t,r,n);return this.clone(this.type,this.offset+e,t,o,a,!i.length||this.valueOffsets?i:this._sliceChildren(i,s*e,s*t))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===dt.Null)return this.clone(this.type,0,e,0);const{length:t,nullCount:r}=this,n=new Uint8Array((e+63&-64)>>3).fill(255,0,t>>3);n[t>>3]=(1<<t-(-8&t))-1,r>0&&n.set(Ct(this.offset,t,this.nullBitmap),0);const i=this.buffers;return i[pt.VALIDITY]=n,this.clone(this.type,0,e,r+(e-t),i)}_sliceBuffers(e,t,r,n){let i,{buffers:o}=this;return(i=o[pt.TYPE])&&(o[pt.TYPE]=i.subarray(e,e+t)),(i=o[pt.OFFSET])&&(o[pt.OFFSET]=i.subarray(e,e+t+1))||(i=o[pt.DATA])&&(o[pt.DATA]=6===n?i:i.subarray(r*e,r*(e+t))),o}_sliceChildren(e,t,r){return e.map(e=>e.slice(t,r))}static new(e,t,r,n,i,o,s){switch(i instanceof Er?i=i.buffers:i||(i=[]),e.typeId){case dt.Null:return Er.Null(e,t,r);case dt.Int:return Er.Int(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[]);case dt.Dictionary:return Er.Dictionary(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[],s);case dt.Float:return Er.Float(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[]);case dt.Bool:return Er.Bool(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[]);case dt.Decimal:return Er.Decimal(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[]);case dt.Date:return Er.Date(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[]);case dt.Time:return Er.Time(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[]);case dt.Timestamp:return Er.Timestamp(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[]);case dt.Interval:return Er.Interval(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[]);case dt.FixedSizeBinary:return Er.FixedSizeBinary(e,t,r,n||0,i[pt.VALIDITY],i[pt.DATA]||[]);case dt.Binary:return Er.Binary(e,t,r,n||0,i[pt.VALIDITY],i[pt.OFFSET]||[],i[pt.DATA]||[]);case dt.Utf8:return Er.Utf8(e,t,r,n||0,i[pt.VALIDITY],i[pt.OFFSET]||[],i[pt.DATA]||[]);case dt.List:return Er.List(e,t,r,n||0,i[pt.VALIDITY],i[pt.OFFSET]||[],(o||[])[0]);case dt.FixedSizeList:return Er.FixedSizeList(e,t,r,n||0,i[pt.VALIDITY],(o||[])[0]);case dt.Struct:return Er.Struct(e,t,r,n||0,i[pt.VALIDITY],o||[]);case dt.Map:return Er.Map(e,t,r,n||0,i[pt.VALIDITY],i[pt.OFFSET]||[],(o||[])[0]);case dt.Union:return Er.Union(e,t,r,n||0,i[pt.VALIDITY],i[pt.TYPE]||[],i[pt.OFFSET]||o,o)}throw new Error("Unrecognized typeId "+e.typeId)}static Null(e,t,r){return new Er(e,t,r,0)}static Int(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,Ye(e.ArrayType,o),$e(i)])}static Dictionary(e,t,r,n,i,o,s){return new Er(e,t,r,n,[void 0,Ye(e.indices.ArrayType,o),$e(i)],[],s)}static Float(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,Ye(e.ArrayType,o),$e(i)])}static Bool(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,Ye(e.ArrayType,o),$e(i)])}static Decimal(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,Ye(e.ArrayType,o),$e(i)])}static Date(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,Ye(e.ArrayType,o),$e(i)])}static Time(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,Ye(e.ArrayType,o),$e(i)])}static Timestamp(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,Ye(e.ArrayType,o),$e(i)])}static Interval(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,Ye(e.ArrayType,o),$e(i)])}static FixedSizeBinary(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,Ye(e.ArrayType,o),$e(i)])}static Binary(e,t,r,n,i,o,s){return new Er(e,t,r,n,[Qe(o),$e(s),$e(i)])}static Utf8(e,t,r,n,i,o,s){return new Er(e,t,r,n,[Qe(o),$e(s),$e(i)])}static List(e,t,r,n,i,o,s){return new Er(e,t,r,n,[Qe(o),void 0,$e(i)],[s])}static FixedSizeList(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,void 0,$e(i)],[o])}static Struct(e,t,r,n,i,o){return new Er(e,t,r,n,[void 0,void 0,$e(i)],o)}static Map(e,t,r,n,i,o,s){return new Er(e,t,r,n,[Qe(o),void 0,$e(i)],[s])}static Union(e,t,r,n,i,o,s,a){const c=[void 0,void 0,$e(i),Ye(e.ArrayType,o)];return e.mode===mt.Sparse?new Er(e,t,r,n,c,s):(c[pt.OFFSET]=Qe(s),new Er(e,t,r,n,c,a))}}Er.prototype.childData=Object.freeze([]);function Sr(e){if(null===e)return"null";if(void 0===e)return"undefined";switch(typeof e){case"number":case"bigint":return""+e;case"string":return`"${e}"`}return"function"==typeof e[Symbol.toPrimitive]?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e)}function Ar(e){if(!e||e.length<=0)return function(e){return!0};let t="",r=e.filter(e=>e==e);return r.length>0&&(t=`\n    switch (x) {${r.map(e=>`\n        case ${function(e){if("bigint"!=typeof e)return Sr(e);if(Se)return Sr(e)+"n";return`"${Sr(e)}"`}(e)}:`).join("")}\n            return false;\n    }`),e.length!==r.length&&(t="if (x !== x) return false;\n"+t),new Function("x",t+"\nreturn true;")}const kr=(e,t)=>(e*t+63&-64||64)/t;class Rr{constructor(e,t=1){this.buffer=e,this.stride=t,this.BYTES_PER_ELEMENT=e.BYTES_PER_ELEMENT,this.ArrayType=e.constructor,this._resize(this.length=e.length/t|0)}get byteLength(){return this.length*this.stride*this.BYTES_PER_ELEMENT|0}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(e,t){return this}append(e){return this.set(this.length,e)}reserve(e){if(e>0){this.length+=e;const t=this.stride,r=this.length*t,n=this.buffer.length;r>=n&&this._resize(kr(0===n?1*r:2*r,this.BYTES_PER_ELEMENT))}return this}flush(e=this.length){e=kr(e*this.stride,this.BYTES_PER_ELEMENT);const t=((e,t=0)=>e.length>=t?e.subarray(0,t):Ge(new e.constructor(t),e,0))(this.buffer,e);return this.clear(),t}clear(){return this.length=0,this._resize(0),this}_resize(e){return this.buffer=Ge(new this.ArrayType(e),this.buffer)}}Rr.prototype.offset=0;class Nr extends Rr{last(){return this.get(this.length-1)}get(e){return this.buffer[e]}set(e,t){return this.reserve(e-this.length+1),this.buffer[e*this.stride]=t,this}}class Or extends Nr{constructor(e=new Uint8Array(0)){super(e,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(e){return this.buffer[e>>3]>>e%8&1}set(e,t){const{buffer:r}=this.reserve(e-this.length+1),n=e>>3,i=e%8,o=r[n]>>i&1;return t?0===o&&(r[n]|=1<<i,++this.numValid):1===o&&(r[n]&=~(1<<i),--this.numValid),this}clear(){return this.numValid=0,super.clear()}}class Mr extends Nr{constructor(e=new Int32Array(1)){super(e,1)}append(e){return this.set(this.length-1,e)}set(e,t){const r=this.length-1,n=this.reserve(e-r+1).buffer;return r<e++&&n.fill(n[r],r,e),n[e]=n[e-1]+t,this}flush(e=this.length-1){return e>this.length&&this.set(e-1,0),super.flush(e+1)}}class Pr extends Rr{get ArrayType64(){return this._ArrayType64||(this._ArrayType64=this.buffer instanceof Int32Array?Ae:Re)}set(e,t){switch(this.reserve(e-this.length+1),typeof t){case"bigint":this.buffer64[e]=t;break;case"number":this.buffer[e*this.stride]=t;break;default:this.buffer.set(t,e*this.stride)}return this}_resize(e){const t=super._resize(e),r=t.byteLength/(this.BYTES_PER_ELEMENT*this.stride);return Se&&(this.buffer64=new this.ArrayType64(t.buffer,t.byteOffset,r)),t}}class Br{constructor({type:e,nullValues:t}){this.length=0,this.finished=!1,this.type=e,this.children=[],this.nullValues=t,this.stride=Cr(e),this._nulls=new Or,t&&t.length>0&&(this._isValid=Ar(t))}static new(e){}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e){throw new Error('"throughDOM" not available in this environment')}static throughIterable(e){return function(e){const{queueingStrategy:t="count"}=e,{highWaterMark:r=("bytes"!==t?1e3:16384)}=e,n="bytes"!==t?"length":"byteLength";return function*(t){let i=0,o=Br.new(e);for(const e of t)o.append(e)[n]>=r&&++i&&(yield o.toVector());(o.finish().length>0||0===i)&&(yield o.toVector())}}(e)}static throughAsyncIterable(e){return function(e){const{queueingStrategy:t="count"}=e,{highWaterMark:r=("bytes"!==t?1e3:16384)}=e,n="bytes"!==t?"length":"byteLength";return async function*(t){let i=0,o=Br.new(e);for await(const e of t)o.append(e)[n]>=r&&++i&&(yield o.toVector());(o.finish().length>0||0===i)&&(yield o.toVector())}}(e)}toVector(){return ut.new(this.flush())}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let e=0;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),this._typeIds&&(e+=this._typeIds.byteLength),this.children.reduce((e,t)=>e+t.byteLength,e)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let e=0;return this._offsets&&(e+=this._offsets.reservedByteLength),this._values&&(e+=this._values.reservedByteLength),this._nulls&&(e+=this._nulls.reservedByteLength),this._typeIds&&(e+=this._typeIds.reservedByteLength),this.children.reduce((e,t)=>e+t.reservedByteLength,e)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(e){return this.set(this.length,e)}isValid(e){return this._isValid(e)}set(e,t){return this.setValid(e,this.isValid(t))&&this.setValue(e,t),this}setValue(e,t){this._setValue(this,e,t)}setValid(e,t){return this.length=this._nulls.set(e,+t).length,t}addChild(e,t=""+this.numChildren){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(e){return this.children[e]||null}flush(){const e=[],t=this._values,r=this._offsets,n=this._typeIds,{length:i,nullCount:o}=this;n?(e[pt.TYPE]=n.flush(i),r&&(e[pt.OFFSET]=r.flush(i))):r?(t&&(e[pt.DATA]=t.flush(r.last())),e[pt.OFFSET]=r.flush(i)):t&&(e[pt.DATA]=t.flush(i)),o>0&&(e[pt.VALIDITY]=this._nulls.flush(i));const s=Er.new(this.type,0,i,o,e,this.children.map(e=>e.flush()));return this.clear(),s}finish(){return this.finished=!0,this.children.forEach(e=>e.finish()),this}clear(){return this.length=0,this._offsets&&this._offsets.clear(),this._values&&this._values.clear(),this._nulls&&this._nulls.clear(),this._typeIds&&this._typeIds.clear(),this.children.forEach(e=>e.clear()),this}}Br.prototype.length=1,Br.prototype.stride=1,Br.prototype.children=null,Br.prototype.finished=!1,Br.prototype.nullValues=null,Br.prototype._isValid=()=>!0;class Dr extends Br{constructor(e){super(e),this._values=new Nr(new this.ArrayType(0),this.stride)}setValue(e,t){const r=this._values;return r.reserve(e-r.length+1),super.setValue(e,t)}}class Ur extends Br{constructor(e){super(e),this._pendingLength=0,this._offsets=new Mr}setValue(e,t){const r=this._pending||(this._pending=new Map),n=r.get(e);n&&(this._pendingLength-=n.length),this._pendingLength+=t.length,r.set(e,t)}setValid(e,t){return!!super.setValid(e,t)||((this._pending||(this._pending=new Map)).set(e,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){const e=this._pending,t=this._pendingLength;return this._pendingLength=0,this._pending=void 0,e&&e.size>0&&this._flushPending(e,t),this}}class Lr extends Br{constructor(e){super(e),this._values=new Or}setValue(e,t){this._values.set(e,+t)}}class xr extends Br{setValue(e,t){}setValid(e,t){return this.length=Math.max(e+1,this.length),t}}class Fr extends Dr{}class qr extends Fr{}class Hr extends Fr{}class Kr extends Dr{}class zr extends Br{constructor({type:e,nullValues:t,dictionaryHashFunction:r}){super({type:new Ir(e.dictionary,e.indices,e.id,e.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=Br.new({type:this.type.indices,nullValues:t}),this.dictionary=Br.new({type:this.type.dictionary,nullValues:null}),"function"==typeof r&&(this.valueToKey=r)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(e){return this.indices.isValid(e)}setValid(e,t){const r=this.indices;return t=r.setValid(e,t),this.length=r.length,t}setValue(e,t){let r=this._keysToIndices,n=this.valueToKey(t),i=r[n];return void 0===i&&(r[n]=i=this._dictionaryOffset+this.dictionary.append(t).length-1),this.indices.setValue(e,i)}flush(){const e=this.type,t=this._dictionary,r=this.dictionary.toVector(),n=this.indices.flush().clone(e);return n.dictionary=t?t.concat(r):r,this.finished||(this._dictionaryOffset+=r.length),this._dictionary=n.dictionary,this.clear(),n}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(e){return"string"==typeof e?e:""+e}}class Vr extends Dr{}const Gr=new Float64Array(1),jr=new Uint32Array(Gr.buffer);function Yr(e){let t=(31744&e)>>10,r=(1023&e)/1024,n=(-1)**((32768&e)>>15);switch(t){case 31:return n*(r?NaN:1/0);case 0:return n*(r?6103515625e-14*r:0)}return n*2**(t-15)*(1+r)}function Qr(e){if(e!=e)return 32256;Gr[0]=e;let t=(2147483648&jr[1])>>16&65535,r=2146435072&jr[1],n=0;return r>=1089470464?jr[0]>0?r=31744:(r=(2080374784&r)>>16,n=(1048575&jr[1])>>10):r<=1056964608?(n=1048576+(1048575&jr[1]),n=1048576+(n<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,n=512+(1048575&jr[1])>>10),t|r|65535&n}class Wr extends Dr{}class $r extends Wr{setValue(e,t){this._values.set(e,Qr(t))}}class Jr extends Wr{setValue(e,t){this._values.set(e,t)}}class Xr extends Wr{setValue(e,t){this._values.set(e,t)}}const Zr=Symbol.for("isArrowBigNum");function en(e,...t){return 0===t.length?Object.setPrototypeOf(Ye(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}function tn(...e){return en.apply(this,e)}function rn(...e){return en.apply(this,e)}function nn(...e){return en.apply(this,e)}function on(e){let t,r,{buffer:n,byteOffset:i,length:o,signed:s}=e,a=new Int32Array(n,i,o),c=0,u=0,l=a.length;for(;u<l;)r=a[u++],t=a[u++],s||(t>>>=0),c+=(r>>>0)+t*u**32;return c}let sn,an;function cn(e){let t="",r=new Uint32Array(2),n=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),i=new Uint32Array((n=new Uint16Array(n).reverse()).buffer),o=-1,s=n.length-1;do{for(r[0]=n[o=0];o<s;)n[o++]=r[1]=r[0]/10,r[0]=(r[0]-10*r[1]<<16)+n[o];n[o]=r[1]=r[0]/10,r[0]=r[0]-10*r[1],t=`${r[0]}${t}`}while(i[0]||i[1]||i[2]||i[3]);return t||"0"}en.prototype[Zr]=!0,en.prototype.toJSON=function(){return`"${sn(this)}"`},en.prototype.valueOf=function(){return on(this)},en.prototype.toString=function(){return sn(this)},en.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return on(this);case"string":return sn(this);case"default":return an(this)}return sn(this)},Object.setPrototypeOf(tn.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(rn.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(nn.prototype,Object.create(Uint32Array.prototype)),Object.assign(tn.prototype,en.prototype,{constructor:tn,signed:!0,TypedArray:Int32Array,BigIntArray:Ae}),Object.assign(rn.prototype,en.prototype,{constructor:rn,signed:!1,TypedArray:Uint32Array,BigIntArray:Re}),Object.assign(nn.prototype,en.prototype,{constructor:nn,signed:!0,TypedArray:Uint32Array,BigIntArray:Re}),Se?(an=e=>8===e.byteLength?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:cn(e),sn=e=>8===e.byteLength?""+new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:cn(e)):(sn=cn,an=sn);class un{constructor(e,t){return un.new(e,t)}static new(e,t){switch(t){case!0:return new tn(e);case!1:return new rn(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case Ae:return new tn(e)}return 16===e.byteLength?new nn(e):new rn(e)}static signed(e){return new tn(e)}static unsigned(e){return new rn(e)}static decimal(e){return new nn(e)}}class ln extends Dr{setValue(e,t){this._values.set(e,t)}}class hn extends ln{}class dn extends ln{}class pn extends ln{}class fn extends ln{constructor(e){e.nullValues&&(e.nullValues=e.nullValues.map(bn)),super(e),this._values=new Pr(new Int32Array(0),2)}get values64(){return this._values.buffer64}isValid(e){return super.isValid(bn(e))}}class gn extends ln{}class yn extends ln{}class mn extends ln{}class vn extends ln{constructor(e){e.nullValues&&(e.nullValues=e.nullValues.map(bn)),super(e),this._values=new Pr(new Uint32Array(0),2)}get values64(){return this._values.buffer64}isValid(e){return super.isValid(bn(e))}}const bn=(_n={BigIntArray:Ae},e=>(ArrayBuffer.isView(e)&&(_n.buffer=e.buffer,_n.byteOffset=e.byteOffset,_n.byteLength=e.byteLength,e=an(_n),_n.buffer=null),e));var _n;class wn extends Dr{}class Tn extends wn{}class In extends wn{}class Cn extends wn{}class En extends wn{}class Sn extends Dr{}class An extends Sn{}class kn extends Sn{}class Rn extends Sn{}class Nn extends Sn{}class On extends Dr{}class Mn extends On{}class Pn extends On{}class Bn extends Ur{constructor(e){super(e),this._values=new Rr(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+4*this.length;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,$e(t))}_flushPending(e,t){const r=this._offsets,n=this._values.reserve(t).buffer;let i,o=0,s=0,a=0;for([o,i]of e)void 0===i?r.set(o,0):(s=i.length,n.set(i,a),r.set(o,s),a+=s)}}class Dn extends Ur{constructor(e){super(e),this._values=new Rr(new Uint8Array(0))}get byteLength(){let e=this._pendingLength+4*this.length;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,_e(t))}_flushPending(e,t){}}Dn.prototype._flushPending=Bn.prototype._flushPending;class Un{get length(){return this._values.length}get(e){return this._values[e]}clear(){return this._values=null,this}bind(e){return e instanceof ut?e:(this._values=e,this)}}const Ln=Symbol.for("parent"),xn=Symbol.for("rowIndex"),Fn=Symbol.for("keyToIdx"),qn=Symbol.for("idxToVal"),Hn=Symbol.for("nodejs.util.inspect.custom");class Kn{constructor(e,t){this[Ln]=e,this.size=t}entries(){return this[Symbol.iterator]()}has(e){return void 0!==this.get(e)}get(e){let t=void 0;if(null!=e){const r=this[Fn]||(this[Fn]=new Map);let n=r.get(e);if(void 0!==n){const e=this[qn]||(this[qn]=new Array(this.size));void 0!==(t=e[n])||(e[n]=t=this.getValue(n))}else if((n=this.getIndex(e))>-1){r.set(e,n);const i=this[qn]||(this[qn]=new Array(this.size));void 0!==(t=i[n])||(i[n]=t=this.getValue(n))}}return t}set(e,t){if(null!=e){const r=this[Fn]||(this[Fn]=new Map);let n=r.get(e);if(void 0===n&&r.set(e,n=this.getIndex(e)),n>-1){(this[qn]||(this[qn]=new Array(this.size)))[n]=this.setValue(n,t)}}return this}clear(){throw new Error(`Clearing ${this[Symbol.toStringTag]} not supported.`)}delete(e){throw new Error(`Deleting ${this[Symbol.toStringTag]} values not supported.`)}*[Symbol.iterator](){const e=this.keys(),t=this.values(),r=this[Fn]||(this[Fn]=new Map),n=this[qn]||(this[qn]=new Array(this.size));for(let i,o,s,a,c=0;!(s=e.next()).done&&!(a=t.next()).done;++c)i=s.value,o=a.value,n[c]=o,r.has(i)||r.set(i,c),yield[i,o]}forEach(e,t){const r=this.keys(),n=this.values(),i=void 0===t?e:(r,n,i)=>e.call(t,r,n,i),o=this[Fn]||(this[Fn]=new Map),s=this[qn]||(this[qn]=new Array(this.size));for(let e,t,a,c,u=0;!(a=r.next()).done&&!(c=n.next()).done;++u)e=a.value,t=c.value,s[u]=t,o.has(e)||o.set(e,u),i(t,e,this)}toArray(){return[...this.values()]}toJSON(){const e={};return this.forEach((t,r)=>e[r]=t),e}inspect(){return this.toString()}[Hn](){return this.toString()}toString(){const e=[];return this.forEach((t,r)=>{r=Sr(r),t=Sr(t),e.push(`${r}: ${t}`)}),`{ ${e.join(", ")} }`}}Kn[Symbol.toStringTag]=(e=>(Object.defineProperties(e,{size:{writable:!0,enumerable:!1,configurable:!1,value:0},[Ln]:{writable:!0,enumerable:!1,configurable:!1,value:null},[xn]:{writable:!0,enumerable:!1,configurable:!1,value:-1}}),e[Symbol.toStringTag]="Row"))(Kn.prototype);class zn extends Kn{constructor(e){return super(e,e.length),jn(this)}keys(){return this[Ln].getChildAt(0)[Symbol.iterator]()}values(){return this[Ln].getChildAt(1)[Symbol.iterator]()}getKey(e){return this[Ln].getChildAt(0).get(e)}getIndex(e){return this[Ln].getChildAt(0).indexOf(e)}getValue(e){return this[Ln].getChildAt(1).get(e)}setValue(e,t){this[Ln].getChildAt(1).set(e,t)}}class Vn extends Kn{constructor(e){return super(e,e.type.children.length),Gn(this)}*keys(){for(const e of this[Ln].type.children)yield e.name}*values(){for(const e of this[Ln].type.children)yield this[e.name]}getKey(e){return this[Ln].type.children[e].name}getIndex(e){return this[Ln].type.children.findIndex(t=>t.name===e)}getValue(e){return this[Ln].getChildAt(e).get(this[xn])}setValue(e,t){return this[Ln].getChildAt(e).set(this[xn],t)}}Object.setPrototypeOf(Kn.prototype,Map.prototype);const Gn=(()=>{const e={enumerable:!0,configurable:!1,get:null,set:null};return t=>{let r=-1,n=t[Fn]||(t[Fn]=new Map);const i=e=>function(){return this.get(e)},o=e=>function(t){return this.set(e,t)};for(const s of t.keys())n.set(s,++r),e.get=i(s),e.set=o(s),t.hasOwnProperty(s)||(e.enumerable=!0,Object.defineProperty(t,s,e)),t.hasOwnProperty(r)||(e.enumerable=!1,Object.defineProperty(t,r,e));return e.get=e.set=null,t}})(),jn=(()=>{if("undefined"==typeof Proxy)return Gn;const e=Kn.prototype.has,t=Kn.prototype.get,r=Kn.prototype.set,n=Kn.prototype.getKey,i={isExtensible:()=>!1,deleteProperty:()=>!1,preventExtensions:()=>!0,ownKeys:e=>[...e.keys()].map(e=>""+e),has(e,t){switch(t){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case Ln:case xn:case qn:case Fn:case Hn:return!0}return"number"!=typeof t||e.has(t)||(t=e.getKey(t)),e.has(t)},get(r,i,o){switch(i){case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:case Ln:case xn:case qn:case Fn:case Hn:return Reflect.get(r,i,o)}return"number"!=typeof i||e.call(o,i)||(i=n.call(o,i)),t.call(o,i)},set(t,i,o,s){switch(i){case Ln:case xn:case qn:case Fn:return Reflect.set(t,i,o,s);case"getKey":case"getIndex":case"getValue":case"setValue":case"toArray":case"toJSON":case"inspect":case"constructor":case"isPrototypeOf":case"propertyIsEnumerable":case"toString":case"toLocaleString":case"valueOf":case"size":case"has":case"get":case"set":case"clear":case"delete":case"keys":case"values":case"entries":case"forEach":case"__proto__":case"__defineGetter__":case"__defineSetter__":case"hasOwnProperty":case"__lookupGetter__":case"__lookupSetter__":case Symbol.iterator:case Symbol.toStringTag:return!1}return"number"!=typeof i||e.call(s,i)||(i=n.call(s,i)),!!e.call(s,i)&&!!r.call(s,i,o)}};return e=>new Proxy(e,i)})();let Yn;function Qn(e,t,r,n){let{length:i=0}=e,o="number"!=typeof t?0:t,s="number"!=typeof r?i:r;return o<0&&(o=(o%i+i)%i),s<0&&(s=(s%i+i)%i),s<o&&(Yn=o,o=s,s=Yn),s>i&&(s=i),n?n(e,o,s):[o,s]}const Wn=Se?Ee(0):0,$n=e=>e!=e;function Jn(e){let t=typeof e;if("object"!==t||null===e)return $n(e)?$n:"bigint"!==t?t=>t===e:t=>Wn+t===e;if(e instanceof Date){const t=e.valueOf();return e=>e instanceof Date&&e.valueOf()===t}return ArrayBuffer.isView(e)?t=>!!t&&it(e,t):e instanceof Map?function(e){let t=-1;const r=[];return e.forEach(e=>r[++t]=Jn(e)),Xn(r)}(e):Array.isArray(e)?function(e){const t=[];for(let r=-1,n=e.length;++r<n;)t[r]=Jn(e[r]);return Xn(t)}(e):e instanceof ut?function(e){const t=[];for(let r=-1,n=e.length;++r<n;)t[r]=Jn(e.get(r));return Xn(t)}(e):function(e){const t=Object.keys(e);if(0===t.length)return()=>!1;const r=[];for(let n=-1,i=t.length;++n<i;)r[n]=Jn(e[t[n]]);return Xn(r,t)}(e)}function Xn(e,t){return r=>{if(!r||"object"!=typeof r)return!1;switch(r.constructor){case Array:return function(e,t){const r=e.length;if(t.length!==r)return!1;for(let n=-1;++n<r;)if(!e[n](t[n]))return!1;return!0}(e,r);case Map:case zn:case Vn:return Zn(e,r,r.keys());case Object:case void 0:return Zn(e,r,t||Object.keys(r))}return r instanceof ut&&function(e,t){const r=e.length;if(t.length!==r)return!1;for(let n=-1;++n<r;)if(!e[n](t.get(n)))return!1;return!0}(e,r)}}function Zn(e,t,r){const n=r[Symbol.iterator](),i=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),o=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let s=0,a=e.length,c=o.next(),u=n.next(),l=i.next();for(;s<a&&!u.done&&!l.done&&!c.done&&(u.value===l.value&&e[s](c.value));++s,u=n.next(),l=i.next(),c=o.next());return!!(s===a&&u.done&&l.done&&c.done)||(n.return&&n.return(),i.return&&i.return(),o.return&&o.return(),!1)}class ei extends ut{constructor(e,t=[],r=function(e){let t=new Uint32Array((e||[]).length+1),r=t[0]=0,n=t.length;for(let i=0;++i<n;)t[i]=r+=e[i-1].length;return t}(t)){super(),this._nullCount=-1,this._type=e,this._chunks=t,this._chunkOffsets=r,this._length=r[r.length-1],this._numChildren=(this._type.children||[]).length}static flatten(...e){return ci(ut,e)}static concat(...e){const t=ei.flatten(...e);return new ei(t[0].type,t)}get type(){return this._type}get length(){return this._length}get chunks(){return this._chunks}get typeId(){return this._type.typeId}get VectorName(){return`Chunked<${this._type}>`}get data(){return this._chunks[0]?this._chunks[0].data:null}get ArrayType(){return this._type.ArrayType}get numChildren(){return this._numChildren}get stride(){return this._chunks[0]?this._chunks[0].stride:1}get byteLength(){return this._chunks.reduce((e,t)=>e+t.byteLength,0)}get nullCount(){let e=this._nullCount;return e<0&&(this._nullCount=e=this._chunks.reduce((e,{nullCount:t})=>e+t,0)),e}get indices(){if(zt.isDictionary(this._type)){if(!this._indices){const e=this._chunks;this._indices=1===e.length?e[0].indices:ei.concat(...e.map(e=>e.indices))}return this._indices}return null}get dictionary(){return zt.isDictionary(this._type)?this._chunks[this._chunks.length-1].data.dictionary:null}*[Symbol.iterator](){for(const e of this._chunks)yield*e}clone(e=this._chunks){return new ei(this._type,e)}concat(...e){return this.clone(ei.flatten(this,...e))}slice(e,t){return Qn(this,e,t,this._sliceInternal)}getChildAt(e){if(e<0||e>=this._numChildren)return null;let t,r,n,i=this._children||(this._children=[]);return(t=i[e])?t:(r=(this._type.children||[])[e])&&(n=this._chunks.map(t=>t.getChildAt(e)).filter(e=>null!=e),n.length>0)?i[e]=new ei(r.type,n):null}search(e,t){let r=e,n=this._chunkOffsets,i=n.length-1;if(r<0)return null;if(r>=n[i])return null;if(i<=1)return t?t(this,0,r):[0,r];let o=0,s=0,a=0;do{if(o+1===i)return t?t(this,o,r-s):[o,r-s];a=o+(i-o)/2|0,r>=n[a]?o=a:i=a}while(r<n[i]&&r>=(s=n[o]));return null}isValid(e){return!!this.search(e,this.isValidInternal)}get(e){return this.search(e,this.getInternal)}set(e,t){this.search(e,({chunks:e},r,n)=>e[r].set(n,t))}indexOf(e,t){return t&&"number"==typeof t?this.search(t,(t,r,n)=>this.indexOfInternal(t,r,n,e)):this.indexOfInternal(this,0,Math.max(0,t||0),e)}toArray(){const{chunks:e}=this,t=e.length;let r=this._type.ArrayType;if(t<=0)return new r(0);if(t<=1)return e[0].toArray();let n=0,i=new Array(t);for(let r=-1;++r<t;)n+=(i[r]=e[r].toArray()).length;r!==i[0].constructor&&(r=i[0].constructor);let o=new r(n),s=r===Array?ri:ti;for(let e=-1,r=0;++e<t;)r=s(i[e],o,r);return o}getInternal({_chunks:e},t,r){return e[t].get(r)}isValidInternal({_chunks:e},t,r){return e[t].isValid(r)}indexOfInternal({_chunks:e},t,r,n){let i=t-1,o=e.length,s=r,a=0,c=-1;for(;++i<o;){if(~(c=e[i].indexOf(n,s)))return a+c;s=0,a+=e[i].length}return-1}_sliceInternal(e,t,r){const n=[],{chunks:i,_chunkOffsets:o}=e;for(let e=-1,s=i.length;++e<s;){const s=i[e],a=s.length,c=o[e];if(c>=r)break;if(t>=c+a)continue;if(c>=t&&c+a<=r){n.push(s);continue}const u=Math.max(0,t-c),l=Math.min(r-c,a);n.push(s.slice(u,l))}return e.clone(n)}}const ti=(e,t,r)=>(t.set(e,r),r+e.length),ri=(e,t,r)=>{let n=r;for(let r=-1,i=e.length;++r<i;)t[n++]=e[r];return n};class ni extends ei{constructor(e,t=[],r){if(t=ei.flatten(...t),super(e.type,t,r),this._field=e,1===t.length&&!(this instanceof ii))return new ii(e,t[0],this._chunkOffsets)}static new(e,t,...r){const n=ei.flatten(Array.isArray(t)?[...t,...r]:t instanceof ut?[t,...r]:[ut.new(t,...r)]);if("string"==typeof e){const t=n[0].data.type;e=new fi(e,t,!0)}else!e.nullable&&n.some(({nullCount:e})=>e>0)&&(e=e.clone({nullable:!0}));return new ni(e,n)}get field(){return this._field}get name(){return this._field.name}get nullable(){return this._field.nullable}get metadata(){return this._field.metadata}clone(e=this._chunks){return new ni(this._field,e)}getChildAt(e){if(e<0||e>=this.numChildren)return null;let t,r,n,i=this._children||(this._children=[]);return(t=i[e])?t:(r=(this.type.children||[])[e])&&(n=this._chunks.map(t=>t.getChildAt(e)).filter(e=>null!=e),n.length>0)?i[e]=new ni(r,n):null}}class ii extends ni{constructor(e,t,r){super(e,[t],r),this._chunk=t}search(e,t){return t?t(this,0,e):[0,e]}isValid(e){return this._chunk.isValid(e)}get(e){return this._chunk.get(e)}set(e,t){this._chunk.set(e,t)}indexOf(e,t){return this._chunk.indexOf(e,t)}}const oi=Array.isArray,si=(e,t)=>li(e,t,[],0),ai=e=>di(e,[[],[]]),ci=(e,t)=>function e(t,r,n,i){let o,s=i,a=-1,c=r.length;for(;++a<c;)oi(o=r[a])?s=e(t,o,n,s).length:o instanceof ei?s=e(t,o.chunks,n,s).length:o instanceof t&&(n[s++]=o);return n}(e,t,[],0),ui=(e,t)=>function e(t,r,n,i){let o,s=i,a=-1,c=r.length;for(;++a<c;)oi(o=r[a])?s=e(t,o,n,s).length:o instanceof t?s=li(ut,o.schema.fields.map((e,t)=>o.getChildAt(t)),n,s).length:o instanceof ut&&(n[s++]=o);return n}(e,t,[],0);function li(e,t,r,n){let i,o=n,s=-1,a=t.length;for(;++s<a;)oi(i=t[s])?o=li(e,i,r,o).length:i instanceof e&&(r[o++]=i);return r}const hi=(e,[t,r],n)=>(e[0][n]=t,e[1][n]=r,e);function di(e,t){let r,n;switch(n=e.length){case 0:return t;case 1:if(r=t[0],!e[0])return t;if(oi(e[0]))return di(e[0],t);e[0]instanceof Er||e[0]instanceof ut||e[0]instanceof zt||([r,e]=Object.entries(e[0]).reduce(hi,t));break;default:oi(r=e[n-1])?e=oi(e[0])?e[0]:e.slice(0,n-1):(e=oi(e[0])?e[0]:e,r=[])}let i,o,s=-1,a=-1,c=-1,u=e.length,[l,h]=t;for(;++c<u;)o=e[c],o instanceof ni&&(h[++a]=o)?l[++s]=o.field.clone(r[c],o.type,!0):(({[c]:i=c}=r),o instanceof zt&&(h[++a]=o)?l[++s]=fi.new(i,o,!0):o&&o.type&&(h[++a]=o)&&(o instanceof Er&&(h[a]=o=ut.new(o)),l[++s]=fi.new(i,o.type,!0)));return t}class pi{constructor(e=[],t,r){this.fields=e||[],this.metadata=t||new Map,r||(r=yi(e)),this.dictionaries=r}static from(...e){return pi.new(e[0],e[1])}static new(...e){return new pi(ai(e)[0])}get[Symbol.toStringTag](){return"Schema"}toString(){return`Schema<{ ${this.fields.map((e,t)=>`${t}: ${e}`).join(", ")} }>`}compareTo(e){return Kt.compareSchemas(this,e)}select(...e){const t=e.reduce((e,t)=>(e[t]=!0)&&e,Object.create(null));return new pi(this.fields.filter(e=>t[e.name]),this.metadata)}selectAt(...e){return new pi(e.map(e=>this.fields[e]).filter(Boolean),this.metadata)}assign(...e){const t=e[0]instanceof pi?e[0]:new pi(si(fi,e)),r=[...this.fields],n=gi(gi(new Map,this.metadata),t.metadata),i=t.fields.filter(e=>{const t=r.findIndex(t=>t.name===e.name);return!~t||(r[t]=e.clone({metadata:gi(gi(new Map,r[t].metadata),e.metadata)}))&&!1}),o=yi(i,new Map);return new pi([...r,...i],n,new Map([...this.dictionaries,...o]))}}class fi{constructor(e,t,r=!1,n){this.name=e,this.type=t,this.nullable=r,this.metadata=n||new Map}static new(...e){let[t,r,n,i]=e;return e[0]&&"object"==typeof e[0]&&(({name:t}=e[0]),void 0===r&&(r=e[0].type),void 0===n&&(n=e[0].nullable),void 0===i&&(i=e[0].metadata)),new fi(""+t,r,n,i)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}compareTo(e){return Kt.compareField(this,e)}clone(...e){let[t,r,n,i]=e;return e[0]&&"object"==typeof e[0]?({name:t=this.name,type:r=this.type,nullable:n=this.nullable,metadata:i=this.metadata}=e[0]):[t=this.name,r=this.type,n=this.nullable,i=this.metadata]=e,fi.new(t,r,n,i)}}function gi(e,t){return new Map([...e||new Map,...t||new Map])}function yi(e,t=new Map){for(let r=-1,n=e.length;++r<n;){const n=e[r].type;if(zt.isDictionary(n))if(t.has(n.id)){if(t.get(n.id)!==n.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else t.set(n.id,n.dictionary);n.children&&n.children.length>0&&yi(n.children,t)}return t}pi.prototype.fields=null,pi.prototype.metadata=null,pi.prototype.dictionaries=null,fi.prototype.type=null,fi.prototype.name=null,fi.prototype.nullable=null,fi.prototype.metadata=null;class mi extends Ur{constructor(e){super(e),this._run=new Un,this._offsets=new Mr}addChild(e,t="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new gr(new fi(t,e.type,!0)),this.numChildren-1}clear(){return this._run.clear(),super.clear()}_flushPending(e){const t=this._run,r=this._offsets,n=this._setValue;let i,o=0;for([o,i]of e)void 0===i?r.set(o,0):(r.set(o,i.length),n(this,o,t.bind(i)))}}class vi extends Br{constructor(){super(...arguments),this._run=new Un}setValue(e,t){super.setValue(e,this._run.bind(t))}addChild(e,t="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");const r=this.children.push(e);return this.type=new br(this.type.listSize,new fi(t,e.type,!0)),r}clear(){return this._run.clear(),super.clear()}}class bi extends Ur{set(e,t){return super.set(e,t)}setValue(e,t){t=t instanceof Map?t:new Map(Object.entries(t));const r=this._pending||(this._pending=new Map),n=r.get(e);n&&(this._pendingLength-=n.size),this._pendingLength+=t.size,r.set(e,t)}addChild(e,t=""+this.numChildren){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new _r(new fi(t,e.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(e){const t=this._offsets,r=this._setValue;e.forEach((e,n)=>{void 0===e?t.set(n,0):(t.set(n,e.size),r(this,n,e))})}}class _i extends Br{addChild(e,t=""+this.numChildren){const r=this.children.push(e);return this.type=new yr([...this.type.children,new fi(t,e.type,!0)]),r}}class wi extends Br{constructor(e){super(e),this._typeIds=new Nr(new Int8Array(0),1),"function"==typeof e.valueToChildTypeId&&(this._valueToChildTypeId=e.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(e,t){return this.set(this.length,e,t)}set(e,t,r){return void 0===r&&(r=this._valueToChildTypeId(this,t,e)),this.setValid(e,this.isValid(t))&&this.setValue(e,t,r),this}setValue(e,t,r){this._typeIds.set(e,r),super.setValue(e,t)}addChild(e,t=""+this.children.length){const r=this.children.push(e),{type:{children:n,mode:i,typeIds:o}}=this,s=[...n,new fi(t,e.type)];return this.type=new mr(i,[...o,r],s),r}_valueToChildTypeId(e,t,r){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}class Ti extends wi{}class Ii extends wi{constructor(e){super(e),this._offsets=new Nr(new Int32Array(0))}setValue(e,t,r){const n=this.type.typeIdToChildIndex[r];return this._offsets.set(e,this.getChildAt(n).length),super.setValue(e,t,r)}}class Ci extends Nt{}const Ei=(e,t,r)=>{e[t]=r%4294967296|0,e[t+1]=r/4294967296|0},Si=(e,t,r,n)=>{const{[r]:i,[r+1]:o}=t;null!=i&&null!=o&&e.set(n.subarray(0,o-i),i)},Ai=({values:e},t,r)=>{((e,t,r)=>{e[t]=r/864e5|0})(e,t,r.valueOf())},ki=({values:e},t,r)=>{Ei(e,2*t,r.valueOf())},Ri=({stride:e,values:t},r,n)=>{t[e*r]=n},Ni=({stride:e,values:t},r,n)=>{t[e*r]=Qr(n)},Oi=(e,t,r)=>{switch(typeof r){case"bigint":e.values64[t]=r;break;case"number":e.values[t*e.stride]=r;break;default:const n=r,{stride:i,ArrayType:o}=e,s=Ye(o,n);e.values.set(s.subarray(0,i),i*t)}},Mi=({values:e},t,r)=>Ei(e,2*t,r/1e3),Pi=({values:e},t,r)=>Ei(e,2*t,r),Bi=({values:e},t,r)=>((e,t,r)=>{e[t]=1e3*r%4294967296|0,e[t+1]=1e3*r/4294967296|0})(e,2*t,r),Di=({values:e},t,r)=>((e,t,r)=>{e[t]=1e6*r%4294967296|0,e[t+1]=1e6*r/4294967296|0})(e,2*t,r),Ui=({values:e,stride:t},r,n)=>{e[t*r]=n},Li=({values:e,stride:t},r,n)=>{e[t*r]=n},xi=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},Fi=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},qi=(e,t,r)=>{const n=e.typeIdToChildIndex[e.typeIds[t]],i=e.getChildAt(n);i&&i.set(e.valueOffsets[t],r)},Hi=(e,t,r)=>{const n=e.typeIdToChildIndex[e.typeIds[t]],i=e.getChildAt(n);i&&i.set(t,r)},Ki=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},zi=({values:e},t,r)=>{e[t]=12*r[0]+r[1]%12};Ci.prototype.visitBool=({offset:e,values:t},r,n)=>{const i=e+r;n?t[i>>3]|=1<<i%8:t[i>>3]&=~(1<<i%8)},Ci.prototype.visitInt=(e,t,r)=>{e.type.bitWidth<64?Ri(e,t,r):Oi(e,t,r)},Ci.prototype.visitInt8=Ri,Ci.prototype.visitInt16=Ri,Ci.prototype.visitInt32=Ri,Ci.prototype.visitInt64=Oi,Ci.prototype.visitUint8=Ri,Ci.prototype.visitUint16=Ri,Ci.prototype.visitUint32=Ri,Ci.prototype.visitUint64=Oi,Ci.prototype.visitFloat=(e,t,r)=>{e.type.precision!==yt.HALF?Ri(e,t,r):Ni(e,t,r)},Ci.prototype.visitFloat16=Ni,Ci.prototype.visitFloat32=Ri,Ci.prototype.visitFloat64=Ri,Ci.prototype.visitUtf8=({values:e,valueOffsets:t},r,n)=>{Si(e,t,r,_e(n))},Ci.prototype.visitBinary=({values:e,valueOffsets:t},r,n)=>Si(e,t,r,n),Ci.prototype.visitFixedSizeBinary=({stride:e,values:t},r,n)=>{t.set(n.subarray(0,e),e*r)},Ci.prototype.visitDate=(e,t,r)=>{e.type.unit===ft.DAY?Ai(e,t,r):ki(e,t,r)},Ci.prototype.visitDateDay=Ai,Ci.prototype.visitDateMillisecond=ki,Ci.prototype.visitTimestamp=(e,t,r)=>{switch(e.type.unit){case gt.SECOND:return Mi(e,t,r);case gt.MILLISECOND:return Pi(e,t,r);case gt.MICROSECOND:return Bi(e,t,r);case gt.NANOSECOND:return Di(e,t,r)}},Ci.prototype.visitTimestampSecond=Mi,Ci.prototype.visitTimestampMillisecond=Pi,Ci.prototype.visitTimestampMicrosecond=Bi,Ci.prototype.visitTimestampNanosecond=Di,Ci.prototype.visitTime=(e,t,r)=>{switch(e.type.unit){case gt.SECOND:return Ui(e,t,r);case gt.MILLISECOND:return Li(e,t,r);case gt.MICROSECOND:return xi(e,t,r);case gt.NANOSECOND:return Fi(e,t,r)}},Ci.prototype.visitTimeSecond=Ui,Ci.prototype.visitTimeMillisecond=Li,Ci.prototype.visitTimeMicrosecond=xi,Ci.prototype.visitTimeNanosecond=Fi,Ci.prototype.visitDecimal=({values:e},t,r)=>{e.set(r.subarray(0,4),4*t)},Ci.prototype.visitList=(e,t,r)=>{const n=e.getChildAt(0),i=e.valueOffsets;for(let e=-1,o=i[t],s=i[t+1];o<s;)n.set(o++,r.get(++e))},Ci.prototype.visitStruct=(e,t,r)=>{const n=r instanceof Map?(i=t,o=r,(e,t,r)=>e&&e.set(i,o.get(t.name))):r instanceof ut?((e,t)=>(r,n,i)=>r&&r.set(e,t.get(i)))(t,r):Array.isArray(r)?((e,t)=>(r,n,i)=>r&&r.set(e,t[i]))(t,r):((e,t)=>(r,n,i)=>r&&r.set(e,t[n.name]))(t,r);var i,o;e.type.children.forEach((t,r)=>n(e.getChildAt(r),t,r))},Ci.prototype.visitUnion=(e,t,r)=>{e.type.mode===mt.Dense?qi(e,t,r):Hi(e,t,r)},Ci.prototype.visitDenseUnion=qi,Ci.prototype.visitSparseUnion=Hi,Ci.prototype.visitDictionary=(e,t,r)=>{const n=e.getKey(t);null!==n&&e.setValue(n,r)},Ci.prototype.visitInterval=(e,t,r)=>{e.type.unit===vt.DAY_TIME?Ki(e,t,r):zi(e,t,r)},Ci.prototype.visitIntervalDayTime=Ki,Ci.prototype.visitIntervalYearMonth=zi,Ci.prototype.visitFixedSizeList=(e,t,r)=>{const n=e.getChildAt(0),{stride:i}=e;for(let e=-1,o=t*i;++e<i;)n.set(o+e,r.get(e))},Ci.prototype.visitMap=(e,t,r)=>{const n=e.getChildAt(0),i=e.valueOffsets,o=r instanceof Map?[...r]:Object.entries(r);for(let e=-1,r=i[t],s=i[t+1];r<s;)n.set(r++,o[++e])};const Vi=new Ci;const Gi=new class extends Nt{visitNull(){return xr}visitBool(){return Lr}visitInt(){return ln}visitInt8(){return hn}visitInt16(){return dn}visitInt32(){return pn}visitInt64(){return fn}visitUint8(){return gn}visitUint16(){return yn}visitUint32(){return mn}visitUint64(){return vn}visitFloat(){return Wr}visitFloat16(){return $r}visitFloat32(){return Jr}visitFloat64(){return Xr}visitUtf8(){return Dn}visitBinary(){return Bn}visitFixedSizeBinary(){return Vr}visitDate(){return Fr}visitDateDay(){return qr}visitDateMillisecond(){return Hr}visitTimestamp(){return Sn}visitTimestampSecond(){return An}visitTimestampMillisecond(){return kn}visitTimestampMicrosecond(){return Rn}visitTimestampNanosecond(){return Nn}visitTime(){return wn}visitTimeSecond(){return Tn}visitTimeMillisecond(){return In}visitTimeMicrosecond(){return Cn}visitTimeNanosecond(){return En}visitDecimal(){return Kr}visitList(){return mi}visitStruct(){return _i}visitUnion(){return wi}visitDenseUnion(){return Ii}visitSparseUnion(){return Ti}visitDictionary(){return zr}visitInterval(){return On}visitIntervalDayTime(){return Mn}visitIntervalYearMonth(){return Pn}visitFixedSizeList(){return vi}visitMap(){return bi}};var ji;Br.new=function e(t){const r=t.type,n=new(Gi.getVisitFn(r)())(t);if(r.children&&r.children.length>0){const i=t.children||[],o={nullValues:t.nullValues},s=Array.isArray(i)?(e,t)=>i[t]||o:({name:e})=>i[e]||o;r.children.forEach((t,r)=>{const{type:i}=t,o=s(t,r);n.children.push(e({...o,type:i}))})}return n},Object.keys(dt).map(e=>dt[e]).filter(e=>"number"==typeof e&&e!==dt.NONE).forEach(e=>{Gi.visit(e).prototype._setValue=Vi.getVisitFn(e)}),Dn.prototype._setValue=Vi.visitBinary,function(e){var t,r;t=e.apache||(e.apache={}),function(t){class r{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFooter(e,t){return(t||new r).__init(e.readInt32(e.position())+e.position(),e)}version(){let e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):lt.apache.arrow.flatbuf.MetadataVersion.V1}schema(e){let t=this.bb.__offset(this.bb_pos,6);return t?(e||new lt.apache.arrow.flatbuf.Schema).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}dictionaries(t,r){let n=this.bb.__offset(this.bb_pos,8);return n?(r||new e.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}dictionariesLength(){let e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}recordBatches(t,r){let n=this.bb.__offset(this.bb_pos,10);return n?(r||new e.apache.arrow.flatbuf.Block).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}recordBatchesLength(){let e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}static startFooter(e){e.startObject(4)}static addVersion(e,t){e.addFieldInt16(0,t,lt.apache.arrow.flatbuf.MetadataVersion.V1)}static addSchema(e,t){e.addFieldOffset(1,t,0)}static addDictionaries(e,t){e.addFieldOffset(2,t,0)}static startDictionariesVector(e,t){e.startVector(24,t,8)}static addRecordBatches(e,t){e.addFieldOffset(3,t,0)}static startRecordBatchesVector(e,t){e.startVector(24,t,8)}static endFooter(e){return e.endObject()}static finishFooterBuffer(e,t){e.finish(t)}static createFooter(e,t,n,i,o){return r.startFooter(e),r.addVersion(e,t),r.addSchema(e,n),r.addDictionaries(e,i),r.addRecordBatches(e,o),r.endFooter(e)}}t.Footer=r}((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={}))}(ji||(ji={})),function(e){var t,r;t=e.apache||(e.apache={}),((r=t.arrow||(t.arrow={})).flatbuf||(r.flatbuf={})).Block=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static createBlock(e,t,r,n){return e.prep(8,24),e.writeInt64(n),e.pad(4),e.writeInt32(r),e.writeInt64(t),e.offset()}}}(ji||(ji={}));var Yi=ce.Long,Qi=ce.Builder,Wi=ce.ByteBuffer,$i=ji.apache.arrow.flatbuf.Block,Ji=ji.apache.arrow.flatbuf.Footer;class Xi{constructor(e,t=_t.V4,r,n){this.schema=e,this.version=t,r&&(this._recordBatches=r),n&&(this._dictionaryBatches=n)}static decode(e){e=new Wi($e(e));const t=Ji.getRootAsFooter(e),r=pi.decode(t.schema());return new Zi(r,t)}static encode(e){const t=new Qi,r=pi.encode(t,e.schema);Ji.startRecordBatchesVector(t,e.numRecordBatches),[...e.recordBatches()].slice().reverse().forEach(e=>eo.encode(t,e));const n=t.endVector();Ji.startDictionariesVector(t,e.numDictionaries),[...e.dictionaryBatches()].slice().reverse().forEach(e=>eo.encode(t,e));const i=t.endVector();return Ji.startFooter(t),Ji.addSchema(t,r),Ji.addVersion(t,_t.V4),Ji.addRecordBatches(t,n),Ji.addDictionaries(t,i),Ji.finishFooterBuffer(t,Ji.endFooter(t)),t.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let e,t=-1,r=this.numRecordBatches;++t<r;)(e=this.getRecordBatch(t))&&(yield e)}*dictionaryBatches(){for(let e,t=-1,r=this.numDictionaries;++t<r;)(e=this.getDictionaryBatch(t))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}}class Zi extends Xi{constructor(e,t){super(e,t.version()),this._footer=t}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){const t=this._footer.recordBatches(e);if(t)return eo.decode(t)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){const t=this._footer.dictionaries(e);if(t)return eo.decode(t)}return null}}class eo{static decode(e){return new eo(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,t){const{metaDataLength:r}=t,n=new Yi(t.offset,0),i=new Yi(t.bodyLength,0);return $i.createBlock(e,n,r,i)}constructor(e,t,r){this.metaDataLength=e,this.offset="number"==typeof r?r:r.low,this.bodyLength="number"==typeof t?t:t.low}}class to extends Ce{write(e){if((e=$e(e)).byteLength>0)return super.write(e)}toString(e=!1){return e?be(this.toUint8Array(!0)):this.toUint8Array(!1).then(be)}toUint8Array(e=!1){return e?je(this._values)[0]:(async()=>{let e=[],t=0;for await(const r of this)e.push(r),t+=r.byteLength;return je(e,t)[0]})()}}class ro{constructor(e){e&&(this.source=new io(ot.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class no{constructor(e){e instanceof no?this.source=e.source:e instanceof to?this.source=new oo(ot.fromAsyncIterable(e)):Ke(e)?this.source=new oo(ot.fromNodeStream(e)):He(e)?this.source=new oo(ot.fromDOMStream(e)):qe(e)?this.source=new oo(ot.fromDOMStream(e.body)):De(e)?this.source=new oo(ot.fromIterable(e)):(Be(e)||Ue(e))&&(this.source=new oo(ot.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class io{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e,t="read"){return this.source.next({cmd:t,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||we)}return(e){return Object.create(this.source.return&&this.source.return(e)||we)}}class oo{constructor(e){this.source=e,this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}async cancel(e){await this.return(e)}get closed(){return this._closedPromise}async read(e){return(await this.next(e,"read")).value}async peek(e){return(await this.next(e,"peek")).value}async next(e,t="read"){return await this.source.next({cmd:t,size:e})}async throw(e){const t=this.source.throw&&await this.source.throw(e)||we;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)}async return(e){const t=this.source.return&&await this.source.return(e)||we;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)}}class so extends ro{constructor(e,t){super(),this.position=0,this.buffer=$e(e),this.size=void 0===t?this.buffer.byteLength:t}readInt32(e){const{buffer:t,byteOffset:r}=this.readAt(e,4);return new DataView(t,r).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){const{buffer:t,size:r,position:n}=this;return t&&n<r?("number"!=typeof e&&(e=1/0),this.position=Math.min(r,n+Math.min(r-n,e)),t.subarray(n,this.position)):null}readAt(e,t){const r=this.buffer,n=Math.min(this.size,e+t);return r?r.subarray(e,n):new Uint8Array(t)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}}class ao extends no{constructor(e,t){super(),this.position=0,this._handle=e,"number"==typeof t?this.size=t:this._pending=(async()=>{this.size=(await e.stat()).size,delete this._pending})()}async readInt32(e){const{buffer:t,byteOffset:r}=await this.readAt(e,4);return new DataView(t,r).getInt32(0,!0)}async seek(e){return this._pending&&await this._pending,this.position=Math.min(e,this.size),e<this.size}async read(e){this._pending&&await this._pending;const{_handle:t,size:r,position:n}=this;if(t&&n<r){"number"!=typeof e&&(e=1/0);let i=n,o=0,s=0,a=Math.min(r,i+Math.min(r-i,e)),c=new Uint8Array(Math.max(0,(this.position=a)-i));for(;(i+=s)<a&&(o+=s)<c.byteLength;)({bytesRead:s}=await t.read(c,o,c.byteLength-o,i));return c}return null}async readAt(e,t){this._pending&&await this._pending;const{_handle:r,size:n}=this;if(r&&e+t<n){const i=Math.min(n,e+t),o=new Uint8Array(i-e);return(await r.read(o,0,t,e)).buffer}return new Uint8Array(t)}async close(){const e=this._handle;this._handle=null,e&&await e.close()}async throw(e){return await this.close(),{done:!0,value:e}}async return(e){return await this.close(),{done:!0,value:e}}}function co(e){return e<0&&(e=4294967295+e+1),"0x"+e.toString(16)}const uo=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class lo{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){const t=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),r=new Uint32Array([e.buffer[1]>>>16,65535&e.buffer[1],e.buffer[0]>>>16,65535&e.buffer[0]]);let n=t[3]*r[3];this.buffer[0]=65535&n;let i=n>>>16;return n=t[2]*r[3],i+=n,n=t[3]*r[2]>>>0,i+=n,this.buffer[0]+=i<<16,this.buffer[1]=i>>>0<n?65536:0,this.buffer[1]+=i>>>16,this.buffer[1]+=t[1]*r[3]+t[2]*r[2]+t[3]*r[1],this.buffer[1]+=t[0]*r[3]+t[1]*r[2]+t[2]*r[1]+t[3]*r[0]<<16,this}_plus(e){const t=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],t<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=t}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return`${co(this.buffer[1])} ${co(this.buffer[0])}`}}class ho extends lo{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e,t=new Uint32Array(2)){return ho.fromString("string"==typeof e?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(2)){return ho.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(2)){const r=e.length;let n=new ho(t);for(let t=0;t<r;){const i=8<r-t?8:r-t,o=new ho(new Uint32Array([parseInt(e.substr(t,i),10),0])),s=new ho(new Uint32Array([uo[i],0]));n.times(s),n.plus(o),t+=i}return n}static convertArray(e){const t=new Uint32Array(2*e.length);for(let r=-1,n=e.length;++r<n;)ho.from(e[r],new Uint32Array(t.buffer,t.byteOffset+2*r*4,2));return t}static multiply(e,t){return new ho(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new ho(new Uint32Array(e.buffer)).plus(t)}}class po extends lo{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){const t=this.buffer[1]<<0,r=e.buffer[1]<<0;return t<r||t===r&&this.buffer[0]<e.buffer[0]}static from(e,t=new Uint32Array(2)){return po.fromString("string"==typeof e?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(2)){return po.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(2)){const r=e.startsWith("-"),n=e.length;let i=new po(t);for(let t=r?1:0;t<n;){const r=8<n-t?8:n-t,o=new po(new Uint32Array([parseInt(e.substr(t,r),10),0])),s=new po(new Uint32Array([uo[r],0]));i.times(s),i.plus(o),t+=r}return r?i.negate():i}static convertArray(e){const t=new Uint32Array(2*e.length);for(let r=-1,n=e.length;++r<n;)po.from(e[r],new Uint32Array(t.buffer,t.byteOffset+2*r*4,2));return t}static multiply(e,t){return new po(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new po(new Uint32Array(e.buffer)).plus(t)}}class fo{constructor(e){this.buffer=e}high(){return new po(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new po(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(e){const t=new ho(new Uint32Array([this.buffer[3],0])),r=new ho(new Uint32Array([this.buffer[2],0])),n=new ho(new Uint32Array([this.buffer[1],0])),i=new ho(new Uint32Array([this.buffer[0],0])),o=new ho(new Uint32Array([e.buffer[3],0])),s=new ho(new Uint32Array([e.buffer[2],0])),a=new ho(new Uint32Array([e.buffer[1],0])),c=new ho(new Uint32Array([e.buffer[0],0]));let u=ho.multiply(i,c);this.buffer[0]=u.low();let l=new ho(new Uint32Array([u.high(),0]));return u=ho.multiply(n,c),l.plus(u),u=ho.multiply(i,a),l.plus(u),this.buffer[1]=l.low(),this.buffer[3]=l.lessThan(u)?1:0,this.buffer[2]=l.high(),new ho(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(ho.multiply(r,c)).plus(ho.multiply(n,a)).plus(ho.multiply(i,s)),this.buffer[3]+=ho.multiply(t,c).plus(ho.multiply(r,a)).plus(ho.multiply(n,s)).plus(ho.multiply(i,o)).low(),this}plus(e){let t=new Uint32Array(4);return t[3]=this.buffer[3]+e.buffer[3]>>>0,t[2]=this.buffer[2]+e.buffer[2]>>>0,t[1]=this.buffer[1]+e.buffer[1]>>>0,t[0]=this.buffer[0]+e.buffer[0]>>>0,t[0]<this.buffer[0]>>>0&&++t[1],t[1]<this.buffer[1]>>>0&&++t[2],t[2]<this.buffer[2]>>>0&&++t[3],this.buffer[3]=t[3],this.buffer[2]=t[2],this.buffer[1]=t[1],this.buffer[0]=t[0],this}hex(){return`${co(this.buffer[3])} ${co(this.buffer[2])} ${co(this.buffer[1])} ${co(this.buffer[0])}`}static multiply(e,t){return new fo(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new fo(new Uint32Array(e.buffer)).plus(t)}static from(e,t=new Uint32Array(4)){return fo.fromString("string"==typeof e?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(4)){return fo.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(4)){const r=e.startsWith("-"),n=e.length;let i=new fo(t);for(let t=r?1:0;t<n;){const r=8<n-t?8:n-t,o=new fo(new Uint32Array([parseInt(e.substr(t,r),10),0,0,0])),s=new fo(new Uint32Array([uo[r],0,0,0]));i.times(s),i.plus(o),t+=r}return r?i.negate():i}static convertArray(e){const t=new Uint32Array(4*e.length);for(let r=-1,n=e.length;++r<n;)fo.from(e[r],new Uint32Array(t.buffer,t.byteOffset+16*r,4));return t}}class go extends Nt{constructor(e,t,r,n){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=t,this.buffers=r,this.dictionaries=n}visit(e){return super.visit(e instanceof fi?e.type:e)}visitNull(e,{length:t}=this.nextFieldNode()){return Er.Null(e,0,t)}visitBool(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Bool(e,0,t,r,this.readNullBitmap(e,r),this.readData(e))}visitInt(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Int(e,0,t,r,this.readNullBitmap(e,r),this.readData(e))}visitFloat(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Float(e,0,t,r,this.readNullBitmap(e,r),this.readData(e))}visitUtf8(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Utf8(e,0,t,r,this.readNullBitmap(e,r),this.readOffsets(e),this.readData(e))}visitBinary(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Binary(e,0,t,r,this.readNullBitmap(e,r),this.readOffsets(e),this.readData(e))}visitFixedSizeBinary(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.FixedSizeBinary(e,0,t,r,this.readNullBitmap(e,r),this.readData(e))}visitDate(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Date(e,0,t,r,this.readNullBitmap(e,r),this.readData(e))}visitTimestamp(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Timestamp(e,0,t,r,this.readNullBitmap(e,r),this.readData(e))}visitTime(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Time(e,0,t,r,this.readNullBitmap(e,r),this.readData(e))}visitDecimal(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Decimal(e,0,t,r,this.readNullBitmap(e,r),this.readData(e))}visitList(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.List(e,0,t,r,this.readNullBitmap(e,r),this.readOffsets(e),this.visit(e.children[0]))}visitStruct(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Struct(e,0,t,r,this.readNullBitmap(e,r),this.visitMany(e.children))}visitUnion(e){return e.mode===mt.Sparse?this.visitSparseUnion(e):this.visitDenseUnion(e)}visitDenseUnion(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Union(e,0,t,r,this.readNullBitmap(e,r),this.readTypeIds(e),this.readOffsets(e),this.visitMany(e.children))}visitSparseUnion(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Union(e,0,t,r,this.readNullBitmap(e,r),this.readTypeIds(e),this.visitMany(e.children))}visitDictionary(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Dictionary(e,0,t,r,this.readNullBitmap(e,r),this.readData(e.indices),this.readDictionary(e))}visitInterval(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Interval(e,0,t,r,this.readNullBitmap(e,r),this.readData(e))}visitFixedSizeList(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.FixedSizeList(e,0,t,r,this.readNullBitmap(e,r),this.visit(e.children[0]))}visitMap(e,{length:t,nullCount:r}=this.nextFieldNode()){return Er.Map(e,0,t,r,this.readNullBitmap(e,r),this.readOffsets(e),this.visit(e.children[0]))}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,t,r=this.nextBufferRange()){return t>0&&this.readData(e,r)||new Uint8Array(0)}readOffsets(e,t){return this.readData(e,t)}readTypeIds(e,t){return this.readData(e,t)}readData(e,{length:t,offset:r}=this.nextBufferRange()){return this.bytes.subarray(r,r+t)}readDictionary(e){return this.dictionaries.get(e.id)}}class yo extends go{constructor(e,t,r,n){super(new Uint8Array(0),t,r,n),this.sources=e}readNullBitmap(e,t,{offset:r}=this.nextBufferRange()){return t<=0?new Uint8Array(0):Et(this.sources[r])}readOffsets(e,{offset:t}=this.nextBufferRange()){return Ye(Uint8Array,Ye(Int32Array,this.sources[t]))}readTypeIds(e,{offset:t}=this.nextBufferRange()){return Ye(Uint8Array,Ye(e.ArrayType,this.sources[t]))}readData(e,{offset:t}=this.nextBufferRange()){const{sources:r}=this;return zt.isTimestamp(e)||(zt.isInt(e)||zt.isTime(e))&&64===e.bitWidth||zt.isDate(e)&&e.unit===ft.MILLISECOND?Ye(Uint8Array,po.convertArray(r[t])):zt.isDecimal(e)?Ye(Uint8Array,fo.convertArray(r[t])):zt.isBinary(e)||zt.isFixedSizeBinary(e)?function(e){const t=e.join(""),r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2)r[e>>1]=parseInt(t.substr(e,2),16);return r}(r[t]):zt.isBool(e)?Et(r[t]):zt.isUtf8(e)?_e(r[t].join("")):Ye(Uint8Array,Ye(e.ArrayType,r[t].map(e=>+e)))}}var mo=ce.Long,vo=lt.apache.arrow.flatbuf.Null,bo=lt.apache.arrow.flatbuf.Int,_o=lt.apache.arrow.flatbuf.FloatingPoint,wo=lt.apache.arrow.flatbuf.Binary,To=lt.apache.arrow.flatbuf.Bool,Io=lt.apache.arrow.flatbuf.Utf8,Co=lt.apache.arrow.flatbuf.Decimal,Eo=lt.apache.arrow.flatbuf.Date,So=lt.apache.arrow.flatbuf.Time,Ao=lt.apache.arrow.flatbuf.Timestamp,ko=lt.apache.arrow.flatbuf.Interval,Ro=lt.apache.arrow.flatbuf.List,No=lt.apache.arrow.flatbuf.Struct_,Oo=lt.apache.arrow.flatbuf.Union,Mo=lt.apache.arrow.flatbuf.DictionaryEncoding,Po=lt.apache.arrow.flatbuf.FixedSizeBinary,Bo=lt.apache.arrow.flatbuf.FixedSizeList,Do=lt.apache.arrow.flatbuf.Map;const Uo=new class extends Nt{visit(e,t){return null==e||null==t?void 0:super.visit(e,t)}visitNull(e,t){return vo.startNull(t),vo.endNull(t)}visitInt(e,t){return bo.startInt(t),bo.addBitWidth(t,e.bitWidth),bo.addIsSigned(t,e.isSigned),bo.endInt(t)}visitFloat(e,t){return _o.startFloatingPoint(t),_o.addPrecision(t,e.precision),_o.endFloatingPoint(t)}visitBinary(e,t){return wo.startBinary(t),wo.endBinary(t)}visitBool(e,t){return To.startBool(t),To.endBool(t)}visitUtf8(e,t){return Io.startUtf8(t),Io.endUtf8(t)}visitDecimal(e,t){return Co.startDecimal(t),Co.addScale(t,e.scale),Co.addPrecision(t,e.precision),Co.endDecimal(t)}visitDate(e,t){return Eo.startDate(t),Eo.addUnit(t,e.unit),Eo.endDate(t)}visitTime(e,t){return So.startTime(t),So.addUnit(t,e.unit),So.addBitWidth(t,e.bitWidth),So.endTime(t)}visitTimestamp(e,t){const r=e.timezone&&t.createString(e.timezone)||void 0;return Ao.startTimestamp(t),Ao.addUnit(t,e.unit),void 0!==r&&Ao.addTimezone(t,r),Ao.endTimestamp(t)}visitInterval(e,t){return ko.startInterval(t),ko.addUnit(t,e.unit),ko.endInterval(t)}visitList(e,t){return Ro.startList(t),Ro.endList(t)}visitStruct(e,t){return No.startStruct_(t),No.endStruct_(t)}visitUnion(e,t){Oo.startTypeIdsVector(t,e.typeIds.length);const r=Oo.createTypeIdsVector(t,e.typeIds);return Oo.startUnion(t),Oo.addMode(t,e.mode),Oo.addTypeIds(t,r),Oo.endUnion(t)}visitDictionary(e,t){const r=this.visit(e.indices,t);return Mo.startDictionaryEncoding(t),Mo.addId(t,new mo(e.id,0)),Mo.addIsOrdered(t,e.isOrdered),void 0!==r&&Mo.addIndexType(t,r),Mo.endDictionaryEncoding(t)}visitFixedSizeBinary(e,t){return Po.startFixedSizeBinary(t),Po.addByteWidth(t,e.byteWidth),Po.endFixedSizeBinary(t)}visitFixedSizeList(e,t){return Bo.startFixedSizeList(t),Bo.addListSize(t,e.listSize),Bo.endFixedSizeList(t)}visitMap(e,t){return Do.startMap(t),Do.addKeysSorted(t,e.keysSorted),Do.endMap(t)}};function Lo(e){return new rs(e.count,function e(t){return(t||[]).reduce((t,r)=>{return[...t,new os(r.count,(n=r.VALIDITY,(n||[]).reduce((e,t)=>e+ +(0===t),0))),...e(r.children)];var n},[])}(e.columns),function e(t,r=[]){for(let n=-1,i=(t||[]).length;++n<i;){const i=t[n];i.VALIDITY&&r.push(new is(r.length,i.VALIDITY.length)),i.TYPE&&r.push(new is(r.length,i.TYPE.length)),i.OFFSET&&r.push(new is(r.length,i.OFFSET.length)),i.DATA&&r.push(new is(r.length,i.DATA.length)),r=e(i.children,r)}return r}(e.columns))}function xo(e,t){return(e.children||[]).filter(Boolean).map(e=>fi.fromJSON(e,t))}function Fo(e){return new Map(Object.entries(e||{}))}function qo(e){return new jt(e.isSigned,e.bitWidth)}function Ho(e,t){const r=e.type.name;switch(r){case"NONE":case"null":return new Gt;case"binary":return new or;case"utf8":return new sr;case"bool":return new ar;case"list":return new gr((t||[])[0]);case"struct":case"struct_":return new yr(t||[])}switch(r){case"int":{const t=e.type;return new jt(t.isSigned,t.bitWidth)}case"floatingpoint":{const t=e.type;return new tr(yt[t.precision])}case"decimal":{const t=e.type;return new cr(t.scale,t.precision)}case"date":{const t=e.type;return new ur(ft[t.unit])}case"time":{const t=e.type;return new dr(gt[t.unit],t.bitWidth)}case"timestamp":{const t=e.type;return new pr(gt[t.unit],t.timezone)}case"interval":{const t=e.type;return new fr(vt[t.unit])}case"union":{const r=e.type;return new mr(mt[r.mode],r.typeIds||[],t||[])}case"fixedsizebinary":{const t=e.type;return new vr(t.byteWidth)}case"fixedsizelist":{const r=e.type;return new br(r.listSize,(t||[])[0])}case"map":{const r=e.type;return new _r((t||[])[0],r.keysSorted)}}throw new Error(`Unrecognized type: "${r}"`)}var Ko=ce.Long,zo=ce.Builder,Vo=ce.ByteBuffer,Go=lt.apache.arrow.flatbuf.Type,jo=lt.apache.arrow.flatbuf.Field,Yo=lt.apache.arrow.flatbuf.Schema,Qo=lt.apache.arrow.flatbuf.Buffer,Wo=ht.apache.arrow.flatbuf.Message,$o=lt.apache.arrow.flatbuf.KeyValue,Jo=ht.apache.arrow.flatbuf.FieldNode,Xo=lt.apache.arrow.flatbuf.Endianness,Zo=ht.apache.arrow.flatbuf.RecordBatch,es=ht.apache.arrow.flatbuf.DictionaryBatch;class ts{constructor(e,t,r,n){this._version=t,this._headerType=r,this.body=new Uint8Array(0),n&&(this._createHeader=()=>n),this._bodyLength="number"==typeof e?e:e.low}static fromJSON(e,t){const r=new ts(0,_t.V4,t);return r._createHeader=function(e,t){return()=>{switch(t){case bt.Schema:return pi.fromJSON(e);case bt.RecordBatch:return rs.fromJSON(e);case bt.DictionaryBatch:return ns.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${bt[t]}, type: ${t} }`)}}(e,t),r}static decode(e){e=new Vo($e(e));const t=Wo.getRootAsMessage(e),r=t.bodyLength(),n=t.version(),i=t.headerType(),o=new ts(r,n,i);return o._createHeader=function(e,t){return()=>{switch(t){case bt.Schema:return pi.decode(e.header(new Yo));case bt.RecordBatch:return rs.decode(e.header(new Zo),e.version());case bt.DictionaryBatch:return ns.decode(e.header(new es),e.version())}throw new Error(`Unrecognized Message type: { name: ${bt[t]}, type: ${t} }`)}}(t,i),o}static encode(e){let t=new zo,r=-1;return e.isSchema()?r=pi.encode(t,e.header()):e.isRecordBatch()?r=rs.encode(t,e.header()):e.isDictionaryBatch()&&(r=ns.encode(t,e.header())),Wo.startMessage(t),Wo.addVersion(t,_t.V4),Wo.addHeader(t,r),Wo.addHeaderType(t,e.headerType),Wo.addBodyLength(t,new Ko(e.bodyLength,0)),Wo.finishMessageBuffer(t,Wo.endMessage(t)),t.asUint8Array()}static from(e,t=0){if(e instanceof pi)return new ts(0,_t.V4,bt.Schema,e);if(e instanceof rs)return new ts(t,_t.V4,bt.RecordBatch,e);if(e instanceof ns)return new ts(t,_t.V4,bt.DictionaryBatch,e);throw new Error("Unrecognized Message header: "+e)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===bt.Schema}isRecordBatch(){return this.headerType===bt.RecordBatch}isDictionaryBatch(){return this.headerType===bt.DictionaryBatch}}class rs{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(e,t,r){this._nodes=t,this._buffers=r,this._length="number"==typeof e?e:e.low}}class ns{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(e,t,r=!1){this._data=e,this._isDelta=r,this._id="number"==typeof t?t:t.low}}class is{constructor(e,t){this.offset="number"==typeof e?e:e.low,this.length="number"==typeof t?t:t.low}}class os{constructor(e,t){this.length="number"==typeof e?e:e.low,this.nullCount="number"==typeof t?t:t.low}}function ss(e,t){const r=[];for(let n,i=-1,o=-1,s=e.childrenLength();++i<s;)(n=e.children(i))&&(r[++o]=fi.decode(n,t));return r}function as(e){const t=new Map;if(e)for(let r,n,i=-1,o=0|e.customMetadataLength();++i<o;)(r=e.customMetadata(i))&&null!=(n=r.key())&&t.set(n,r.value());return t}function cs(e){return new jt(e.isSigned(),e.bitWidth())}function us(e,t){const r=e.typeType();switch(r){case Go.NONE:case Go.Null:return new Gt;case Go.Binary:return new or;case Go.Utf8:return new sr;case Go.Bool:return new ar;case Go.List:return new gr((t||[])[0]);case Go.Struct_:return new yr(t||[])}switch(r){case Go.Int:{const t=e.type(new lt.apache.arrow.flatbuf.Int);return new jt(t.isSigned(),t.bitWidth())}case Go.FloatingPoint:{const t=e.type(new lt.apache.arrow.flatbuf.FloatingPoint);return new tr(t.precision())}case Go.Decimal:{const t=e.type(new lt.apache.arrow.flatbuf.Decimal);return new cr(t.scale(),t.precision())}case Go.Date:{const t=e.type(new lt.apache.arrow.flatbuf.Date);return new ur(t.unit())}case Go.Time:{const t=e.type(new lt.apache.arrow.flatbuf.Time);return new dr(t.unit(),t.bitWidth())}case Go.Timestamp:{const t=e.type(new lt.apache.arrow.flatbuf.Timestamp);return new pr(t.unit(),t.timezone())}case Go.Interval:{const t=e.type(new lt.apache.arrow.flatbuf.Interval);return new fr(t.unit())}case Go.Union:{const r=e.type(new lt.apache.arrow.flatbuf.Union);return new mr(r.mode(),r.typeIdsArray()||[],t||[])}case Go.FixedSizeBinary:{const t=e.type(new lt.apache.arrow.flatbuf.FixedSizeBinary);return new vr(t.byteWidth())}case Go.FixedSizeList:{const r=e.type(new lt.apache.arrow.flatbuf.FixedSizeList);return new br(r.listSize(),(t||[])[0])}case Go.Map:{const r=e.type(new lt.apache.arrow.flatbuf.Map);return new _r((t||[])[0],r.keysSorted())}}throw new Error(`Unrecognized type: "${Go[r]}" (${r})`)}fi.encode=function(e,t){let r=-1,n=-1,i=-1,o=t.type,s=t.typeId;zt.isDictionary(o)?(s=o.dictionary.typeId,i=Uo.visit(o,e),n=Uo.visit(o.dictionary,e)):n=Uo.visit(o,e);const a=(o.children||[]).map(t=>fi.encode(e,t)),c=jo.createChildrenVector(e,a),u=t.metadata&&t.metadata.size>0?jo.createCustomMetadataVector(e,[...t.metadata].map(([t,r])=>{const n=e.createString(""+t),i=e.createString(""+r);return $o.startKeyValue(e),$o.addKey(e,n),$o.addValue(e,i),$o.endKeyValue(e)})):-1;t.name&&(r=e.createString(t.name));jo.startField(e),jo.addType(e,n),jo.addTypeType(e,s),jo.addChildren(e,c),jo.addNullable(e,!!t.nullable),-1!==r&&jo.addName(e,r);-1!==i&&jo.addDictionary(e,i);-1!==u&&jo.addCustomMetadata(e,u);return jo.endField(e)},fi.decode=function(e,t){let r,n,i,o,s,a;t&&(a=e.dictionary())?t.has(r=a.id().low)?(o=(o=a.indexType())?cs(o):new Wt,s=new Ir(t.get(r),o,r,a.isOrdered()),n=new fi(e.name(),s,e.nullable(),as(e))):(o=(o=a.indexType())?cs(o):new Wt,t.set(r,i=us(e,ss(e,t))),s=new Ir(i,o,r,a.isOrdered()),n=new fi(e.name(),s,e.nullable(),as(e))):(i=us(e,ss(e,t)),n=new fi(e.name(),i,e.nullable(),as(e)));return n||null},fi.fromJSON=function(e,t){let r,n,i,o,s,a;return t&&(o=e.dictionary)?t.has(r=o.id)?(n=(n=o.indexType)?qo(n):new Wt,a=new Ir(t.get(r),n,r,o.isOrdered),i=new fi(e.name,a,e.nullable,Fo(e.customMetadata))):(n=(n=o.indexType)?qo(n):new Wt,t.set(r,s=Ho(e,xo(e,t))),a=new Ir(s,n,r,o.isOrdered),i=new fi(e.name,a,e.nullable,Fo(e.customMetadata))):(s=Ho(e,xo(e,t)),i=new fi(e.name,s,e.nullable,Fo(e.customMetadata))),i||null},pi.encode=function(e,t){const r=t.fields.map(t=>fi.encode(e,t));Yo.startFieldsVector(e,r.length);const n=Yo.createFieldsVector(e,r),i=t.metadata&&t.metadata.size>0?Yo.createCustomMetadataVector(e,[...t.metadata].map(([t,r])=>{const n=e.createString(""+t),i=e.createString(""+r);return $o.startKeyValue(e),$o.addKey(e,n),$o.addValue(e,i),$o.endKeyValue(e)})):-1;Yo.startSchema(e),Yo.addFields(e,n),Yo.addEndianness(e,ls?Xo.Little:Xo.Big),-1!==i&&Yo.addCustomMetadata(e,i);return Yo.endSchema(e)},pi.decode=function(e,t=new Map){const r=function(e,t){const r=[];for(let n,i=-1,o=-1,s=e.fieldsLength();++i<s;)(n=e.fields(i))&&(r[++o]=fi.decode(n,t));return r}(e,t);return new pi(r,as(e),t)},pi.fromJSON=function(e,t=new Map){return new pi(function(e,t){return(e.fields||[]).filter(Boolean).map(e=>fi.fromJSON(e,t))}(e,t),Fo(e.customMetadata),t)},rs.encode=function(e,t){const r=t.nodes||[],n=t.buffers||[];Zo.startNodesVector(e,r.length),r.slice().reverse().forEach(t=>os.encode(e,t));const i=e.endVector();Zo.startBuffersVector(e,n.length),n.slice().reverse().forEach(t=>is.encode(e,t));const o=e.endVector();return Zo.startRecordBatch(e),Zo.addLength(e,new Ko(t.length,0)),Zo.addNodes(e,i),Zo.addBuffers(e,o),Zo.endRecordBatch(e)},rs.decode=function(e,t=_t.V4){return new rs(e.length(),function(e){const t=[];for(let r,n=-1,i=-1,o=e.nodesLength();++n<o;)(r=e.nodes(n))&&(t[++i]=os.decode(r));return t}(e),function(e,t){const r=[];for(let n,i=-1,o=-1,s=e.buffersLength();++i<s;)(n=e.buffers(i))&&(t<_t.V4&&(n.bb_pos+=8*(i+1)),r[++o]=is.decode(n));return r}(e,t))},rs.fromJSON=Lo,ns.encode=function(e,t){const r=rs.encode(e,t.data);return es.startDictionaryBatch(e),es.addId(e,new Ko(t.id,0)),es.addIsDelta(e,t.isDelta),es.addData(e,r),es.endDictionaryBatch(e)},ns.decode=function(e,t=_t.V4){return new ns(rs.decode(e.data(),t),e.id(),e.isDelta())},ns.fromJSON=function(e){return new ns(Lo(e.data),e.id,e.isDelta)},os.encode=function(e,t){return Jo.createFieldNode(e,new Ko(t.length,0),new Ko(t.nullCount,0))},os.decode=function(e){return new os(e.length(),e.nullCount())},is.encode=function(e,t){return Qo.createBuffer(e,new Ko(t.offset,0),new Ko(t.length,0))},is.decode=function(e){return new is(e.offset(),e.length())};const ls=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}();var hs=ce.ByteBuffer;const ds=e=>`Expected ${bt[e]} Message in stream, but was null or length 0.`,ps=e=>`Header pointer of flatbuffer-encoded ${bt[e]} Message is null or length 0.`,fs=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,gs=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`;class ys{constructor(e){this.source=e instanceof ro?e:new ro(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||-1===e.value&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?we:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(ds(e));return t.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);const t=$e(this.source.read(e));if(t.byteLength<e)throw new Error(gs(e,t.byteLength));return t.byteOffset%8==0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()}readSchema(e=!1){const t=bt.Schema,r=this.readMessage(t),n=r&&r.header();if(e&&!n)throw new Error(ps(t));return n}readMetadataLength(){const e=this.source.read(bs),t=e&&new hs(e),r=t&&t.readInt32(0)||0;return{done:0===r,value:r}}readMetadata(e){const t=this.source.read(e);if(!t)return we;if(t.byteLength<e)throw new Error(fs(e,t.byteLength));return{done:!1,value:ts.decode(t)}}}class ms{constructor(e,t){this.source=e instanceof no?e:Fe(e)?new ao(e,t):new no(e)}[Symbol.asyncIterator](){return this}async next(){let e;return(e=await this.readMetadataLength()).done||-1===e.value&&(e=await this.readMetadataLength()).done||(e=await this.readMetadata(e.value)).done?we:e}async throw(e){return await this.source.throw(e)}async return(e){return await this.source.return(e)}async readMessage(e){let t;if((t=await this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(ds(e));return t.value}async readMessageBody(e){if(e<=0)return new Uint8Array(0);const t=$e(await this.source.read(e));if(t.byteLength<e)throw new Error(gs(e,t.byteLength));return t.byteOffset%8==0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()}async readSchema(e=!1){const t=bt.Schema,r=await this.readMessage(t),n=r&&r.header();if(e&&!n)throw new Error(ps(t));return n}async readMetadataLength(){const e=await this.source.read(bs),t=e&&new hs(e),r=t&&t.readInt32(0)||0;return{done:0===r,value:r}}async readMetadata(e){const t=await this.source.read(e);if(!t)return we;if(t.byteLength<e)throw new Error(fs(e,t.byteLength));return{done:!1,value:ts.decode(t)}}}class vs extends ys{constructor(e){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof Te?e:new Te(e)}next(){const{_json:e}=this;if(!this._schema){this._schema=!0;return{done:!1,value:ts.fromJSON(e.schema,bt.Schema)}}if(this._dictionaryIndex<e.dictionaries.length){const t=e.dictionaries[this._dictionaryIndex++];this._body=t.data.columns;return{done:!1,value:ts.fromJSON(t,bt.DictionaryBatch)}}if(this._batchIndex<e.batches.length){const t=e.batches[this._batchIndex++];this._body=t.columns;return{done:!1,value:ts.fromJSON(t,bt.RecordBatch)}}return this._body=[],we}readMessageBody(e){return function e(t){return(t||[]).reduce((t,r)=>[...t,...r.VALIDITY&&[r.VALIDITY]||[],...r.TYPE&&[r.TYPE]||[],...r.OFFSET&&[r.OFFSET]||[],...r.DATA&&[r.DATA]||[],...e(r.children)],[])}(this._body)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(ds(e));return t.value}readSchema(){const e=bt.Schema,t=this.readMessage(e),r=t&&t.header();if(!t||!r)throw new Error(ps(e));return r}}const bs=4,_s=new Uint8Array("ARROW1".length);for(let e=0;e<"ARROW1".length;e+=1)_s[e]="ARROW1".charCodeAt(e);function ws(e,t=0){for(let r=-1,n=_s.length;++r<n;)if(_s[r]!==e[t+r])return!1;return!0}const Ts=_s.length,Is=Ts+bs,Cs=2*Ts+bs;class Es extends Nt{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...e){const t=new Es,r=ui(Ic,e),[n=t]=t.visitMany(r);return n}visit(e){if(!zt.isDictionary(e.type)){const{data:t,length:r,nullCount:n}=e;if(r>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");zt.isNull(e.type)||Ss.call(this,n<=0?new Uint8Array(0):Ct(t.offset,r,t.nullBitmap)),this.nodes.push(new os(r,n))}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.indices)}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function Ss(e){const t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new is(this._byteLength,t)),this._byteLength+=t,this}function As(e){return Ss.call(this,e.values.subarray(0,e.length*e.stride))}function ks(e){const{length:t,values:r,valueOffsets:n}=e,i=n[0],o=n[t],s=Math.min(o-i,r.byteLength-i);return Ss.call(this,nt(-n[0],t,n)),Ss.call(this,r.subarray(i,i+s)),this}function Rs(e){const{length:t,valueOffsets:r}=e;return r&&Ss.call(this,nt(r[0],t,r)),this.visit(e.getChildAt(0))}function Ns(e){return this.visitMany(e.type.children.map((t,r)=>e.getChildAt(r)).filter(Boolean))[0]}Es.prototype.visitBool=function(e){let t;return e.nullCount>=e.length?Ss.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?Ss.call(this,Ct(e.offset,e.length,t)):Ss.call(this,Et(e))},Es.prototype.visitInt=As,Es.prototype.visitFloat=As,Es.prototype.visitUtf8=ks,Es.prototype.visitBinary=ks,Es.prototype.visitFixedSizeBinary=As,Es.prototype.visitDate=As,Es.prototype.visitTimestamp=As,Es.prototype.visitTime=As,Es.prototype.visitDecimal=As,Es.prototype.visitList=Rs,Es.prototype.visitStruct=Ns,Es.prototype.visitUnion=function(e){const{type:t,length:r,typeIds:n,valueOffsets:i}=e;if(Ss.call(this,n),t.mode===mt.Sparse)return Ns.call(this,e);if(t.mode===mt.Dense){if(e.offset<=0)return Ss.call(this,i),Ns.call(this,e);{const o=n.reduce((e,t)=>Math.max(e,t),n[0]),s=new Int32Array(o+1),a=new Int32Array(o+1).fill(-1),c=new Int32Array(r),u=nt(-i[0],r,i);for(let e,t,i=-1;++i<r;)-1===(t=a[e=n[i]])&&(t=a[e]=u[e]),c[i]=u[i]-t,++s[e];Ss.call(this,c);for(let n,i=-1,o=t.children.length;++i<o;)if(n=e.getChildAt(i)){const e=t.typeIds[i],o=Math.min(r,s[e]);this.visit(n.slice(a[e],o))}}}return this},Es.prototype.visitInterval=As,Es.prototype.visitFixedSizeList=Rs,Es.prototype.visitMap=Rs;class Os extends Ie{constructor(e){super(),this._position=0,this._started=!1,this._sink=new to,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,Pe(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy="boolean"!=typeof e.autoDestroy||e.autoDestroy,this._writeLegacyIpcFormat="boolean"==typeof e.writeLegacyIpcFormat&&e.writeLegacyIpcFormat}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}toString(e=!1){return this._sink.toString(e)}toUint8Array(e=!1){return this._sink.toUint8Array(e)}writeAll(e){return Be(e)?e.then(e=>this.writeAll(e)):Ue(e)?Ds(this,e):Bs(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(e=this._sink,t=null){var r;return e===this._sink||e instanceof to?this._sink=e:(this._sink=new to,e&&(Pe(r=e)&&Me(r.abort)&&Me(r.getWriter)&&!(r instanceof Ie))?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&(e=>Pe(e)&&Me(e.end)&&Me(e.write)&&Oe(e.writable)&&!(e instanceof Ie))(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,t&&t.compareTo(this._schema)||(null===t?(this._position=0,this._schema=null):(this._started=!0,this._schema=t,this._writeSchema(t))),this}write(e){let t=null;if(!this._sink)throw new Error("RecordBatchWriter is closed");if(null==e)return this.finish()&&void 0;if(e instanceof Tc&&!(t=e.schema))return this.finish()&&void 0;if(e instanceof Ic&&!(t=e.schema))return this.finish()&&void 0;if(t&&!t.compareTo(this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,t)}e instanceof Ic?e instanceof Cc||this._writeRecordBatch(e):e instanceof Tc?this.writeAll(e.chunks):De(e)&&this.writeAll(e)}_writeMessage(e,t=8){const r=t-1,n=ts.encode(e),i=n.byteLength,o=this._writeLegacyIpcFormat?4:8,s=i+o+r&~r,a=s-i-o;return e.headerType===bt.RecordBatch?this._recordBatchBlocks.push(new eo(s,e.bodyLength,this._position)):e.headerType===bt.DictionaryBatch&&this._dictionaryBlocks.push(new eo(s,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(s-o)),i>0&&this._write(n),this._writePadding(a)}_write(e){if(this._started){const t=$e(e);t&&t.byteLength>0&&(this._sink.write(t),this._position+=t.byteLength)}return this}_writeSchema(e){return this._writeMessage(ts.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(_s)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){const{byteLength:t,nodes:r,bufferRegions:n,buffers:i}=Es.assemble(e),o=new rs(e.length,r,n),s=ts.from(o,t);return this._writeDictionaries(e)._writeMessage(s)._writeBodyBuffers(i)}_writeDictionaryBatch(e,t,r=!1){this._dictionaryDeltaOffsets.set(t,e.length+(this._dictionaryDeltaOffsets.get(t)||0));const{byteLength:n,nodes:i,bufferRegions:o,buffers:s}=Es.assemble(e),a=new rs(e.length,i,o),c=new ns(a,t,r),u=ts.from(c,n);return this._writeMessage(u)._writeBodyBuffers(s)}_writeBodyBuffers(e){let t,r,n;for(let i=-1,o=e.length;++i<o;)(t=e[i])&&(r=t.byteLength)>0&&(this._write(t),(n=(r+7&-8)-r)>0&&this._writePadding(n));return this}_writeDictionaries(e){for(let[t,r]of e.dictionaries){let e=this._dictionaryDeltaOffsets.get(t)||0;if(0===e||(r=r.slice(e)).length>0){const n="chunks"in r?r.chunks:[r];for(const r of n)this._writeDictionaryBatch(r,t,e>0),e+=r.length}}return this}}class Ms extends Os{static writeAll(e,t){const r=new Ms(t);return Be(e)?e.then(e=>r.writeAll(e)):Ue(e)?Ds(r,e):Bs(r,e)}}class Ps extends Os{constructor(){super(),this._autoDestroy=!0}static writeAll(e){const t=new Ps;return Be(e)?e.then(e=>t.writeAll(e)):Ue(e)?Ds(t,e):Bs(t,e)}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeFooter(e){const t=Xi.encode(new Xi(e,_t.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(t)._write(Int32Array.of(t.byteLength))._writeMagic()}}function Bs(e,t){let r=t;t instanceof Tc&&(r=t.chunks,e.reset(void 0,t.schema));for(const t of r)e.write(t);return e.finish()}async function Ds(e,t){for await(const r of t)e.write(r);return e.finish()}const Us=new Uint8Array(0),Ls=e=>[Us,Us,new Uint8Array(e),Us];function xs(e,t){return function(e,t){const r=[...e.fields],n=[],i={numBatches:t.reduce((e,t)=>Math.max(e,t.length),0)};let o,s=0,a=0,c=-1,u=t.length,l=[];for(;i.numBatches-- >0;){for(a=Number.POSITIVE_INFINITY,c=-1;++c<u;)l[c]=o=t[c].shift(),a=Math.min(a,o?o.length:a);isFinite(a)&&(l=Fs(r,a,l,t,i),a>0&&(n[s++]=[a,l.slice()]))}return[e=new pi(r,e.metadata),n.map(t=>new Ic(e,...t))]}(e,t.map(e=>e instanceof ei?e.chunks.map(e=>e.data):[e.data]))}function Fs(e,t,r,n,i){let o,s,a=0,c=-1,u=n.length;const l=(t+63&-64)>>3;for(;++c<u;)(o=r[c])&&(a=o.length)>=t?a===t?r[c]=o:(r[c]=o.slice(0,t),o=o.slice(t,a-t),i.numBatches=Math.max(i.numBatches,n[c].unshift(o))):((s=e[c]).nullable||(e[c]=s.clone({nullable:!0})),r[c]=o?o._changeLengthAndBackfillNullBitmap(t):Er.new(s.type,0,t,t,Ls(l)));return r}class qs extends ut{constructor(e,t){super(),this._children=t,this.numChildren=e.childData.length,this._bindDataAccessors(this.data=e)}get type(){return this.data.type}get typeId(){return this.data.typeId}get length(){return this.data.length}get offset(){return this.data.offset}get stride(){return this.data.stride}get nullCount(){return this.data.nullCount}get byteLength(){return this.data.byteLength}get VectorName(){return dt[this.typeId]+"Vector"}get ArrayType(){return this.type.ArrayType}get values(){return this.data.values}get typeIds(){return this.data.typeIds}get nullBitmap(){return this.data.nullBitmap}get valueOffsets(){return this.data.valueOffsets}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}clone(e,t=this._children){return ut.new(e,t)}concat(...e){return ei.concat(this,...e)}slice(e,t){return Qn(this,e,t,this._sliceInternal)}isValid(e){if(this.nullCount>0){const t=this.offset+e;return 0!==(this.nullBitmap[t>>3]&1<<t%8)}return!0}getChildAt(e){return e<0||e>=this.numChildren?null:(this._children||(this._children=[]))[e]||(this._children[e]=ut.new(this.data.childData[e]))}toJSON(){return[...this]}_sliceInternal(e,t,r){return e.clone(e.data.slice(t,r-t),null)}_bindDataAccessors(e){}}qs.prototype[Symbol.isConcatSpreadable]=!0;class Hs extends qs{asUtf8(){return ut.new(this.data.clone(new sr))}}class Ks extends qs{static from(e){return wc(()=>new ar,e)}}class zs extends qs{static from(...e){return 2===e.length?wc(()=>e[1]===ft.DAY?new lr:new hr,e[0]):wc(()=>new hr,e[0])}}class Vs extends zs{}class Gs extends zs{}class js extends qs{}class Ys extends qs{constructor(e){super(e),this.indices=ut.new(e.clone(this.type.indices))}static from(...e){if(3===e.length){const[t,r,n]=e,i=new Ir(t.type,r,null,null);return ut.new(Er.Dictionary(i,0,n.length,0,null,n,t))}return wc(()=>e[0].type,e[0])}get dictionary(){return this.data.dictionary}reverseLookup(e){return this.dictionary.indexOf(e)}getKey(e){return this.indices.get(e)}getValue(e){return this.dictionary.get(e)}setKey(e,t){return this.indices.set(e,t)}setValue(e,t){return this.dictionary.set(e,t)}}Ys.prototype.indices=null;class Qs extends qs{}class Ws extends qs{}class $s extends qs{static from(e){let t=ra(this);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)){let r=ta(e.constructor)||t;if(null===t&&(t=r),t&&t===r){let r=new t,n=e.byteLength/r.ArrayType.BYTES_PER_ELEMENT;if(!ea(t,e.constructor))return ut.new(Er.Float(r,0,n,0,null,e))}}if(t)return wc(()=>new t,e);if(e instanceof DataView||e instanceof ArrayBuffer)throw new TypeError("Cannot infer float type from instance of "+e.constructor.name);throw new TypeError("Unrecognized FloatVector input")}}class Js extends $s{toFloat32Array(){return new Float32Array(this)}toFloat64Array(){return new Float64Array(this)}}class Xs extends $s{}class Zs extends $s{}const ea=(e,t)=>e===rr&&t!==Uint16Array,ta=e=>{switch(e){case Uint16Array:return rr;case Float32Array:return nr;case Float64Array:return ir;default:return null}},ra=e=>{switch(e){case Js:return rr;case Xs:return nr;case Zs:return ir;default:return null}};class na extends qs{}class ia extends na{}class oa extends na{}class sa extends qs{static from(...e){let[t,r=!1]=e,n=ma(this,r);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)){let e=ya(t.constructor,r)||n;if(null===n&&(n=e),n&&n===e){let e=new n,r=t.byteLength/e.ArrayType.BYTES_PER_ELEMENT;return ga(n,t.constructor)&&(r*=.5),ut.new(Er.Int(e,0,r,0,null,t))}}if(n)return wc(()=>new n,t);if(t instanceof DataView||t instanceof ArrayBuffer)throw new TypeError("Cannot infer integer type from instance of "+t.constructor.name);throw new TypeError("Unrecognized IntVector input")}}class aa extends sa{}class ca extends sa{}class ua extends sa{}class la extends sa{toBigInt64Array(){return We(this.values)}get values64(){return this._values64||(this._values64=this.toBigInt64Array())}}class ha extends sa{}class da extends sa{}class pa extends sa{}class fa extends sa{toBigUint64Array(){return Je(this.values)}get values64(){return this._values64||(this._values64=this.toBigUint64Array())}}const ga=(e,t)=>!(e!==$t&&e!==er||t!==Int32Array&&t!==Uint32Array),ya=(e,t)=>{switch(e){case Int8Array:return Yt;case Int16Array:return Qt;case Int32Array:return t?$t:Wt;case Ae:return $t;case Uint8Array:return Jt;case Uint16Array:return Xt;case Uint32Array:return t?er:Zt;case Re:return er;default:return null}},ma=(e,t)=>{switch(e){case aa:return Yt;case ca:return Qt;case ua:return t?$t:Wt;case la:return $t;case ha:return Jt;case da:return Xt;case pa:return t?er:Zt;case fa:return er;default:return null}};class va extends qs{}class ba extends qs{asList(){const e=this.type.children[0];return ut.new(this.data.clone(new gr(e)))}bind(e){const t=this.getChildAt(0),{[e]:r,[e+1]:n}=this.valueOffsets;return new zn(t.slice(r,n))}}class _a extends qs{}const wa=Symbol.for("rowIndex");class Ta extends qs{bind(e){const t=this._row||(this._row=new Vn(this)),r=Object.create(t);return r[wa]=e,r}}class Ia extends qs{}class Ca extends Ia{}class Ea extends Ia{}class Sa extends Ia{}class Aa extends Ia{}class ka extends qs{}class Ra extends ka{}class Na extends ka{}class Oa extends ka{}class Ma extends ka{}class Pa extends qs{get typeIdToChildIndex(){return this.data.type.typeIdToChildIndex}}class Ba extends Pa{get valueOffsets(){return this.data.valueOffsets}}class Da extends Pa{}class Ua extends qs{static from(e){return wc(()=>new sr,e)}asBinary(){return ut.new(this.data.clone(new or))}}function La(e){return function(){return e(this)}}function xa(e){return function(t,r){return e(this,t,r)}}class Fa extends Nt{}const qa=(e,t)=>4294967296*e[t+1]+(e[t]>>>0),Ha=e=>new Date(e),Ka=(e,t,r)=>{const{[r]:n,[r+1]:i}=t;return null!=n&&null!=i?e.subarray(n,i):null},za=({values:e},t)=>((e,t)=>Ha(((e,t)=>864e5*e[t])(e,t)))(e,t),Va=({values:e},t)=>((e,t)=>Ha(qa(e,t)))(e,2*t),Ga=({stride:e,values:t},r)=>t[e*r],ja=({stride:e,values:t},r)=>Yr(t[e*r]),Ya=({stride:e,values:t,type:r},n)=>un.new(t.subarray(e*n,e*(n+1)),r.isSigned),Qa=({values:e},t)=>1e3*qa(e,2*t),Wa=({values:e},t)=>qa(e,2*t),$a=({values:e},t)=>((e,t)=>e[t+1]/1e3*4294967296+(e[t]>>>0)/1e3)(e,2*t),Ja=({values:e},t)=>((e,t)=>e[t+1]/1e6*4294967296+(e[t]>>>0)/1e6)(e,2*t),Xa=({values:e,stride:t},r)=>e[t*r],Za=({values:e,stride:t},r)=>e[t*r],ec=({values:e},t)=>un.signed(e.subarray(2*t,2*(t+1))),tc=({values:e},t)=>un.signed(e.subarray(2*t,2*(t+1))),rc=(e,t)=>{const r=e.typeIdToChildIndex[e.typeIds[t]],n=e.getChildAt(r);return n?n.get(e.valueOffsets[t]):null},nc=(e,t)=>{const r=e.typeIdToChildIndex[e.typeIds[t]],n=e.getChildAt(r);return n?n.get(t):null},ic=({values:e},t)=>e.subarray(2*t,2*(t+1)),oc=({values:e},t)=>{const r=e[t],n=new Int32Array(2);return n[0]=r/12|0,n[1]=r%12|0,n};Fa.prototype.visitNull=(e,t)=>null,Fa.prototype.visitBool=({offset:e,values:t},r)=>{const n=e+r;return 0!=(t[n>>3]&1<<n%8)},Fa.prototype.visitInt=(e,t)=>e.type.bitWidth<64?Ga(e,t):Ya(e,t),Fa.prototype.visitInt8=Ga,Fa.prototype.visitInt16=Ga,Fa.prototype.visitInt32=Ga,Fa.prototype.visitInt64=Ya,Fa.prototype.visitUint8=Ga,Fa.prototype.visitUint16=Ga,Fa.prototype.visitUint32=Ga,Fa.prototype.visitUint64=Ya,Fa.prototype.visitFloat=(e,t)=>e.type.precision!==yt.HALF?Ga(e,t):ja(e,t),Fa.prototype.visitFloat16=ja,Fa.prototype.visitFloat32=Ga,Fa.prototype.visitFloat64=Ga,Fa.prototype.visitUtf8=({values:e,valueOffsets:t},r)=>{const n=Ka(e,t,r);return null!==n?be(n):null},Fa.prototype.visitBinary=({values:e,valueOffsets:t},r)=>Ka(e,t,r),Fa.prototype.visitFixedSizeBinary=({stride:e,values:t},r)=>t.subarray(e*r,e*(r+1)),Fa.prototype.visitDate=(e,t)=>e.type.unit===ft.DAY?za(e,t):Va(e,t),Fa.prototype.visitDateDay=za,Fa.prototype.visitDateMillisecond=Va,Fa.prototype.visitTimestamp=(e,t)=>{switch(e.type.unit){case gt.SECOND:return Qa(e,t);case gt.MILLISECOND:return Wa(e,t);case gt.MICROSECOND:return $a(e,t);case gt.NANOSECOND:return Ja(e,t)}},Fa.prototype.visitTimestampSecond=Qa,Fa.prototype.visitTimestampMillisecond=Wa,Fa.prototype.visitTimestampMicrosecond=$a,Fa.prototype.visitTimestampNanosecond=Ja,Fa.prototype.visitTime=(e,t)=>{switch(e.type.unit){case gt.SECOND:return Xa(e,t);case gt.MILLISECOND:return Za(e,t);case gt.MICROSECOND:return ec(e,t);case gt.NANOSECOND:return tc(e,t)}},Fa.prototype.visitTimeSecond=Xa,Fa.prototype.visitTimeMillisecond=Za,Fa.prototype.visitTimeMicrosecond=ec,Fa.prototype.visitTimeNanosecond=tc,Fa.prototype.visitDecimal=({values:e},t)=>un.decimal(e.subarray(4*t,4*(t+1))),Fa.prototype.visitList=(e,t)=>{const r=e.getChildAt(0),{valueOffsets:n,stride:i}=e;return r.slice(n[t*i],n[t*i+1])},Fa.prototype.visitStruct=(e,t)=>e.bind(t),Fa.prototype.visitUnion=(e,t)=>e.type.mode===mt.Dense?rc(e,t):nc(e,t),Fa.prototype.visitDenseUnion=rc,Fa.prototype.visitSparseUnion=nc,Fa.prototype.visitDictionary=(e,t)=>e.getValue(e.getKey(t)),Fa.prototype.visitInterval=(e,t)=>e.type.unit===vt.DAY_TIME?ic(e,t):oc(e,t),Fa.prototype.visitIntervalDayTime=ic,Fa.prototype.visitIntervalYearMonth=oc,Fa.prototype.visitFixedSizeList=(e,t)=>{const r=e.getChildAt(0),{stride:n}=e;return r.slice(t*n,(t+1)*n)},Fa.prototype.visitMap=(e,t)=>e.bind(t);const sc=new Fa;class ac extends Nt{}function cc(e,t,r){if(void 0===t)return-1;if(null===t)return function(e,t){const{nullBitmap:r}=e;if(!r||e.nullCount<=0)return-1;let n=0;for(const i of St(r,e.data.offset+(t||0),e.length,r,wt)){if(!i)return n;++n}return-1}(e,r);const n=Jn(t);for(let t=(r||0)-1,i=e.length;++t<i;)if(n(e.get(t)))return t;return-1}function uc(e,t,r){const n=Jn(t);for(let t=(r||0)-1,i=e.length;++t<i;)if(n(e.get(t)))return t;return-1}ac.prototype.visitNull=function(e,t){return null===t&&e.length>0?0:-1},ac.prototype.visitBool=cc,ac.prototype.visitInt=cc,ac.prototype.visitInt8=cc,ac.prototype.visitInt16=cc,ac.prototype.visitInt32=cc,ac.prototype.visitInt64=cc,ac.prototype.visitUint8=cc,ac.prototype.visitUint16=cc,ac.prototype.visitUint32=cc,ac.prototype.visitUint64=cc,ac.prototype.visitFloat=cc,ac.prototype.visitFloat16=cc,ac.prototype.visitFloat32=cc,ac.prototype.visitFloat64=cc,ac.prototype.visitUtf8=cc,ac.prototype.visitBinary=cc,ac.prototype.visitFixedSizeBinary=cc,ac.prototype.visitDate=cc,ac.prototype.visitDateDay=cc,ac.prototype.visitDateMillisecond=cc,ac.prototype.visitTimestamp=cc,ac.prototype.visitTimestampSecond=cc,ac.prototype.visitTimestampMillisecond=cc,ac.prototype.visitTimestampMicrosecond=cc,ac.prototype.visitTimestampNanosecond=cc,ac.prototype.visitTime=cc,ac.prototype.visitTimeSecond=cc,ac.prototype.visitTimeMillisecond=cc,ac.prototype.visitTimeMicrosecond=cc,ac.prototype.visitTimeNanosecond=cc,ac.prototype.visitDecimal=cc,ac.prototype.visitList=cc,ac.prototype.visitStruct=cc,ac.prototype.visitUnion=cc,ac.prototype.visitDenseUnion=uc,ac.prototype.visitSparseUnion=uc,ac.prototype.visitDictionary=cc,ac.prototype.visitInterval=cc,ac.prototype.visitIntervalDayTime=cc,ac.prototype.visitIntervalYearMonth=cc,ac.prototype.visitFixedSizeList=cc,ac.prototype.visitMap=cc;const lc=new ac;class hc extends Nt{}function dc(e){if(e.nullCount>0)return function(e){const t=sc.getVisitFn(e);return St(e.nullBitmap,e.offset,e.length,e,(e,r,n,i)=>0!=(n&1<<i)?t(e,r):null)}(e);const{type:t,typeId:r,length:n}=e;return 1===e.stride&&(r===dt.Timestamp||r===dt.Int&&64!==t.bitWidth||r===dt.Time&&64!==t.bitWidth||r===dt.Float&&t.precision>0)?e.values.subarray(0,n)[Symbol.iterator]():function*(t){for(let r=-1;++r<n;)yield t(e,r)}(sc.getVisitFn(e))}hc.prototype.visitNull=dc,hc.prototype.visitBool=dc,hc.prototype.visitInt=dc,hc.prototype.visitInt8=dc,hc.prototype.visitInt16=dc,hc.prototype.visitInt32=dc,hc.prototype.visitInt64=dc,hc.prototype.visitUint8=dc,hc.prototype.visitUint16=dc,hc.prototype.visitUint32=dc,hc.prototype.visitUint64=dc,hc.prototype.visitFloat=dc,hc.prototype.visitFloat16=dc,hc.prototype.visitFloat32=dc,hc.prototype.visitFloat64=dc,hc.prototype.visitUtf8=dc,hc.prototype.visitBinary=dc,hc.prototype.visitFixedSizeBinary=dc,hc.prototype.visitDate=dc,hc.prototype.visitDateDay=dc,hc.prototype.visitDateMillisecond=dc,hc.prototype.visitTimestamp=dc,hc.prototype.visitTimestampSecond=dc,hc.prototype.visitTimestampMillisecond=dc,hc.prototype.visitTimestampMicrosecond=dc,hc.prototype.visitTimestampNanosecond=dc,hc.prototype.visitTime=dc,hc.prototype.visitTimeSecond=dc,hc.prototype.visitTimeMillisecond=dc,hc.prototype.visitTimeMicrosecond=dc,hc.prototype.visitTimeNanosecond=dc,hc.prototype.visitDecimal=dc,hc.prototype.visitList=dc,hc.prototype.visitStruct=dc,hc.prototype.visitUnion=dc,hc.prototype.visitDenseUnion=dc,hc.prototype.visitSparseUnion=dc,hc.prototype.visitDictionary=dc,hc.prototype.visitInterval=dc,hc.prototype.visitIntervalDayTime=dc,hc.prototype.visitIntervalYearMonth=dc,hc.prototype.visitFixedSizeList=dc,hc.prototype.visitMap=dc;const pc=new hc;class fc extends Nt{}function gc(e){const{type:t,length:r,stride:n}=e;switch(t.typeId){case dt.Int:case dt.Float:case dt.Decimal:case dt.Time:case dt.Timestamp:return e.values.subarray(0,r*n)}return[...pc.visit(e)]}fc.prototype.visitNull=gc,fc.prototype.visitBool=gc,fc.prototype.visitInt=gc,fc.prototype.visitInt8=gc,fc.prototype.visitInt16=gc,fc.prototype.visitInt32=gc,fc.prototype.visitInt64=gc,fc.prototype.visitUint8=gc,fc.prototype.visitUint16=gc,fc.prototype.visitUint32=gc,fc.prototype.visitUint64=gc,fc.prototype.visitFloat=gc,fc.prototype.visitFloat16=gc,fc.prototype.visitFloat32=gc,fc.prototype.visitFloat64=gc,fc.prototype.visitUtf8=gc,fc.prototype.visitBinary=gc,fc.prototype.visitFixedSizeBinary=gc,fc.prototype.visitDate=gc,fc.prototype.visitDateDay=gc,fc.prototype.visitDateMillisecond=gc,fc.prototype.visitTimestamp=gc,fc.prototype.visitTimestampSecond=gc,fc.prototype.visitTimestampMillisecond=gc,fc.prototype.visitTimestampMicrosecond=gc,fc.prototype.visitTimestampNanosecond=gc,fc.prototype.visitTime=gc,fc.prototype.visitTimeSecond=gc,fc.prototype.visitTimeMillisecond=gc,fc.prototype.visitTimeMicrosecond=gc,fc.prototype.visitTimeNanosecond=gc,fc.prototype.visitDecimal=gc,fc.prototype.visitList=gc,fc.prototype.visitStruct=gc,fc.prototype.visitUnion=gc,fc.prototype.visitDenseUnion=gc,fc.prototype.visitSparseUnion=gc,fc.prototype.visitDictionary=gc,fc.prototype.visitInterval=gc,fc.prototype.visitIntervalDayTime=gc,fc.prototype.visitIntervalYearMonth=gc,fc.prototype.visitFixedSizeList=gc,fc.prototype.visitMap=gc;const yc=new fc,mc=(e,t)=>e+t,vc=e=>"Cannot compute the byte width of variable-width column "+e;const bc=new class extends Nt{visitNull(e){return 0}visitInt(e){return e.bitWidth/8}visitFloat(e){return e.ArrayType.BYTES_PER_ELEMENT}visitBinary(e){throw new Error(vc(e))}visitUtf8(e){throw new Error(vc(e))}visitBool(e){return 1/8}visitDecimal(e){return 16}visitDate(e){return 4*(e.unit+1)}visitTime(e){return e.bitWidth/8}visitTimestamp(e){return e.unit===gt.SECOND?4:8}visitInterval(e){return 4*(e.unit+1)}visitList(e){throw new Error(vc(e))}visitStruct(e){return this.visitFields(e.children).reduce(mc,0)}visitUnion(e){return this.visitFields(e.children).reduce(mc,0)}visitFixedSizeBinary(e){return e.byteWidth}visitFixedSizeList(e){return e.listSize*this.visitFields(e.children).reduce(mc,0)}visitMap(e){return this.visitFields(e.children).reduce(mc,0)}visitDictionary(e){return this.visit(e.indices)}visitFields(e){return(e||[]).map(e=>this.visit(e.type))}visitSchema(e){return this.visitFields(e.fields).reduce(mc,0)}};const _c=new class extends Nt{visitNull(){return _a}visitBool(){return Ks}visitInt(){return sa}visitInt8(){return aa}visitInt16(){return ca}visitInt32(){return ua}visitInt64(){return la}visitUint8(){return ha}visitUint16(){return da}visitUint32(){return pa}visitUint64(){return fa}visitFloat(){return $s}visitFloat16(){return Js}visitFloat32(){return Xs}visitFloat64(){return Zs}visitUtf8(){return Ua}visitBinary(){return Hs}visitFixedSizeBinary(){return Qs}visitDate(){return zs}visitDateDay(){return Vs}visitDateMillisecond(){return Gs}visitTimestamp(){return Ia}visitTimestampSecond(){return Ca}visitTimestampMillisecond(){return Ea}visitTimestampMicrosecond(){return Sa}visitTimestampNanosecond(){return Aa}visitTime(){return ka}visitTimeSecond(){return Ra}visitTimeMillisecond(){return Na}visitTimeMicrosecond(){return Oa}visitTimeNanosecond(){return Ma}visitDecimal(){return js}visitList(){return va}visitStruct(){return Ta}visitUnion(){return Pa}visitDenseUnion(){return Ba}visitSparseUnion(){return Da}visitDictionary(){return Ys}visitInterval(){return na}visitIntervalDayTime(){return ia}visitIntervalYearMonth(){return oa}visitFixedSizeList(){return Ws}visitMap(){return ba}};function wc(e,t){if(De(t))return ut.from({nullValues:[null,void 0],type:e(),values:t});if(Ue(t))return ut.from({nullValues:[null,void 0],type:e(),values:t});const{values:r=[],type:n=e(),nullValues:i=[null,void 0]}={...t};return De(r),ut.from({nullValues:i,...t,type:n})}ut.new=function(e,...t){return new(_c.getVisitFn(e)())(e,...t)},ut.from=function(e){const{values:t=[],...r}={nullValues:[null,void 0],...e};if(De(t)){const e=[...Br.throughIterable(r)(t)];return 1===e.length?e[0]:ei.concat(e)}return(async e=>{const n=Br.throughAsyncIterable(r);for await(const r of n(t))e.push(r);return 1===e.length?e[0]:ei.concat(e)})([])},qs.prototype.get=function(e){return sc.visit(this,e)},qs.prototype.set=function(e,t){return Vi.visit(this,e,t)},qs.prototype.indexOf=function(e,t){return lc.visit(this,e,t)},qs.prototype.toArray=function(){return yc.visit(this)},qs.prototype.getByteWidth=function(){return bc.visit(this.type)},qs.prototype[Symbol.iterator]=function(){return pc.visit(this)},qs.prototype._bindDataAccessors=function(){const e=this.nullBitmap;e&&e.byteLength>0&&(this.get=(t=this.get,function(e){return this.isValid(e)?t.call(this,e):null}),this.set=function(e){return function(t,r){It(this.nullBitmap,this.offset+t,!(null==r))&&e.call(this,t,r)}}(this.set));var t},Object.keys(dt).map(e=>dt[e]).filter(e=>"number"==typeof e).filter(e=>e!==dt.NONE).forEach(e=>{const t=_c.visit(e);var r;t.prototype.get=(r=sc.getVisitFn(e),function(e){return r(this,e)}),t.prototype.set=xa(Vi.getVisitFn(e)),t.prototype.indexOf=xa(lc.getVisitFn(e)),t.prototype.toArray=La(yc.getVisitFn(e)),t.prototype.getByteWidth=function(e){return function(){return e(this.type)}}(bc.getVisitFn(e)),t.prototype[Symbol.iterator]=La(pc.getVisitFn(e))});class Tc extends ei{constructor(...e){let t=null;e[0]instanceof pi&&(t=e.shift());let r=si(Ic,e);if(!t&&!(t=r[0]&&r[0].schema))throw new TypeError("Table must be initialized with a Schema or at least one RecordBatch");r[0]||(r[0]=new Cc(t)),super(new yr(t.fields),r),this._schema=t,this._chunks=r}static empty(e=new pi([])){return new Tc(e,[])}static from(e){if(!e)return Tc.empty();if("object"==typeof e){let t=De(e.values)?function(e){const{type:t}=e;if(t instanceof yr)return Tc.fromStruct(Ta.from(e));return null}(e):Ue(e.values)?function(e){const{type:t}=e;if(t instanceof yr)return Ta.from(e).then(e=>Tc.fromStruct(e));return null}(e):null;if(null!==t)return t}let t=Sc.from(e);return Be(t)?(async()=>await Tc.from(await t))():t.isSync()&&(t=t.open())?t.schema?new Tc(t.schema,[...t]):Tc.empty():(async e=>{const t=await e,r=t.schema,n=[];if(r){for await(let e of t)n.push(e);return new Tc(r,n)}return Tc.empty()})(t.open())}static async fromAsync(e){return await Tc.from(e)}static fromStruct(e){return Tc.new(e.data.childData,e.type.children)}static new(...e){return new Tc(...(t=(e=>{const[t,r]=di(e,[[],[]]);return r.map((e,r)=>e instanceof ni?ni.new(e.field.clone(t[r]),e):e instanceof ut?ni.new(t[r],e):ni.new(t[r],[]))})(e),xs(new pi(t.map(({field:e})=>e)),t)));var t}get schema(){return this._schema}get length(){return this._length}get chunks(){return this._chunks}get numCols(){return this._numChildren}clone(e=this._chunks){return new Tc(this._schema,e)}getColumn(e){return this.getColumnAt(this.getColumnIndex(e))}getColumnAt(e){return this.getChildAt(e)}getColumnIndex(e){return this._schema.fields.findIndex(t=>t.name===e)}getChildAt(e){if(e<0||e>=this.numChildren)return null;let t,r;const n=this._schema.fields,i=this._children||(this._children=[]);if(r=i[e])return r;if(t=n[e]){const r=this._chunks.map(t=>t.getChildAt(e)).filter(e=>null!=e);if(r.length>0)return i[e]=new ni(t,r)}return null}serialize(e="binary",t=!0){return(t?Ms:Ps).writeAll(this).toUint8Array(!0)}count(){return this._length}select(...e){const t=this._schema.fields.reduce((e,t,r)=>e.set(t.name,r),new Map);return this.selectAt(...e.map(e=>t.get(e)).filter(e=>e>-1))}selectAt(...e){const t=this._schema.selectAt(...e);return new Tc(t,this._chunks.map(({length:r,data:{childData:n}})=>new Ic(t,r,e.map(e=>n[e]).filter(Boolean))))}assign(e){const t=this._schema.fields,[r,n]=e.schema.fields.reduce((e,r,n)=>{const[i,o]=e,s=t.findIndex(e=>e.name===r.name);return~s?o[s]=n:i.push(n),e},[[],[]]),i=this._schema.assign(e.schema),o=[...t.map((t,r,i,o=n[r])=>void 0===o?this.getColumnAt(r):e.getColumnAt(o)),...r.map(t=>e.getColumnAt(t))].filter(Boolean);return new Tc(...xs(i,o))}}class Ic extends Ta{constructor(...e){let t,r,n=e[0];if(e[1]instanceof Er)[,t,r]=e;else{const r=n.fields,[,i,o]=e;t=Er.Struct(new yr(r),0,i,0,null,o)}super(t,r),this._schema=n}static from(e){return De(e.values),Tc.from(e)}static new(...e){const[t,r]=ai(e),n=r.filter(e=>e instanceof ut);return new Ic(...function(e,t,r=t.reduce((e,t)=>Math.max(e,t.length),0)){let n,i,o=-1,s=t.length;const a=[...e.fields],c=[],u=(r+63&-64)>>3;for(;++o<s;)(n=t[o])&&n.length===r?c[o]=n:((i=a[o]).nullable||(a[o]=a[o].clone({nullable:!0})),c[o]=n?n._changeLengthAndBackfillNullBitmap(r):Er.new(i.type,0,r,r,Ls(u)));return[new pi(a),r,c]}(new pi(t),n.map(e=>e.data)))}clone(e,t=this._children){return new Ic(this._schema,e,t)}concat(...e){const t=this._schema,r=ei.flatten(this,...e);return new Tc(t,r.map(({data:e})=>new Ic(t,e)))}get schema(){return this._schema}get numCols(){return this._schema.fields.length}get dictionaries(){return this._dictionaries||(this._dictionaries=Ec.collect(this))}select(...e){const t=this._schema.fields.reduce((e,t,r)=>e.set(t.name,r),new Map);return this.selectAt(...e.map(e=>t.get(e)).filter(e=>e>-1))}selectAt(...e){const t=this._schema.selectAt(...e),r=e.map(e=>this.data.childData[e]).filter(Boolean);return new Ic(t,this.length,r)}}class Cc extends Ic{constructor(e){super(e,0,e.fields.map(e=>Er.new(e.type,0,0,0)))}}class Ec extends Nt{constructor(){super(...arguments),this.dictionaries=new Map}static collect(e){return(new Ec).visit(e.data,new yr(e.schema.fields)).dictionaries}visit(e,t){return zt.isDictionary(t)?this.visitDictionary(e,t):(e.childData.forEach((e,r)=>this.visit(e,t.children[r].type)),this)}visitDictionary(e,t){const r=e.dictionary;return r&&r.length>0&&this.dictionaries.set(t.id,r),this}}class Sc extends Ie{constructor(e){super(),this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){const t=this._impl.open(e);return Be(t)?t.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return ot.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return ot.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof Sc?e:Le(e)?function(e){return new Ac(new Uc(e))}(e):Fe(e)?async function(e){const{size:t}=await e.stat(),r=new ao(e,t);if(t>=Cs&&ws(await r.readAt(0,Ts+7&-8)))return new Nc(new Dc(r));return new kc(new Pc(r))}(e):Be(e)?(async()=>await Sc.from(await e))():qe(e)||He(e)||Ke(e)||Ue(e)?async function(e){const t=await e.peek(Ts+7&-8);return t&&t.byteLength>=4?ws(t)?new Rc(new Bc(await e.read())):new kc(new Pc(e)):new kc(new Pc(async function*(){}()))}(new no(e)):function(e){const t=e.peek(Ts+7&-8);return t&&t.byteLength>=4?ws(t)?new Rc(new Bc(e.read())):new Ac(new Mc(e)):new Ac(new Mc(function*(){}()))}(new ro(e))}static readAll(e){return e instanceof Sc?e.isSync()?xc(e):Fc(e):Le(e)||ArrayBuffer.isView(e)||De(e)||xe(e)?xc(e):Fc(e)}}class Ac extends Sc{constructor(e){super(e),this._impl=e}[Symbol.iterator](){return this._impl[Symbol.iterator]()}async*[Symbol.asyncIterator](){yield*this[Symbol.iterator]()}}class kc extends Sc{constructor(e){super(e),this._impl=e}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class Rc extends Ac{constructor(e){super(e),this._impl=e}}class Nc extends kc{constructor(e){super(e),this._impl=e}}class Oc{constructor(e=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,t){return new Ic(this.schema,e.length,this._loadVectors(e,t,this.schema.fields))}_loadDictionaryBatch(e,t){const{id:r,isDelta:n,data:i}=e,{dictionaries:o,schema:s}=this,a=o.get(r);if(n||!a){const e=s.dictionaries.get(r);return a&&n?a.concat(ut.new(this._loadVectors(i,t,[e])[0])):ut.new(this._loadVectors(i,t,[e])[0])}return a}_loadVectors(e,t,r){return new go(t,e.nodes,e.buffers,this.dictionaries).visitMany(r)}}class Mc extends Oc{constructor(e,t){super(t),this._reader=Le(e)?new vs(this._handle=e):new ys(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=Lc(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):we}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):we}next(){if(this.closed)return we;let e,{_reader:t}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const r=e.header(),n=t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(r,n)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const r=e.header(),n=t.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(r,n);this.dictionaries.set(r.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new Cc(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}}class Pc extends Oc{constructor(e,t){super(t),this._reader=new ms(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}async cancel(){!this.closed&&(this.closed=!0)&&(await this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}async open(e){return this.closed||(this.autoDestroy=Lc(this,e),this.schema||(this.schema=await this._reader.readSchema())||await this.cancel()),this}async throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.throw(e):we}async return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset()._reader.return(e):we}async next(){if(this.closed)return we;let e,{_reader:t}=this;for(;e=await this._readNextMessageAndValidate();)if(e.isSchema())await this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const r=e.header(),n=await t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(r,n)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const r=e.header(),n=await t.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(r,n);this.dictionaries.set(r.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new Cc(this.schema)}):await this.return()}async _readNextMessageAndValidate(e){return await this._reader.readMessage(e)}}class Bc extends Mc{constructor(e,t){super(e instanceof so?e:new so(e),t)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){if(this.closed)return null;this._footer||this.open();const t=this._footer&&this._footer.getRecordBatch(e);if(t&&this._handle.seek(t.offset)){const e=this._reader.readMessage(bt.RecordBatch);if(e&&e.isRecordBatch()){const t=e.header(),r=this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,r)}}return null}_readDictionaryBatch(e){const t=this._footer&&this._footer.getDictionaryBatch(e);if(t&&this._handle.seek(t.offset)){const e=this._reader.readMessage(bt.DictionaryBatch);if(e&&e.isDictionaryBatch()){const t=e.header(),r=this._reader.readMessageBody(e.bodyLength),n=this._loadDictionaryBatch(t,r);this.dictionaries.set(t.id,n)}}}_readFooter(){const{_handle:e}=this,t=e.size-Is,r=e.readInt32(t),n=e.readAt(t-r,r);return Xi.decode(n)}_readNextMessageAndValidate(e){if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const t=this._footer&&this._footer.getRecordBatch(this._recordBatchIndex);if(t&&this._handle.seek(t.offset))return this._reader.readMessage(e)}return null}}class Dc extends Pc{constructor(e,...t){const r="number"!=typeof t[0]?t.shift():void 0,n=t[0]instanceof Map?t.shift():void 0;super(e instanceof ao?e:new ao(e,r),n)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}async open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=await this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&await this._readDictionaryBatch(this._dictionaryIndex++)}return await super.open(e)}async readRecordBatch(e){if(this.closed)return null;this._footer||await this.open();const t=this._footer&&this._footer.getRecordBatch(e);if(t&&await this._handle.seek(t.offset)){const e=await this._reader.readMessage(bt.RecordBatch);if(e&&e.isRecordBatch()){const t=e.header(),r=await this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,r)}}return null}async _readDictionaryBatch(e){const t=this._footer&&this._footer.getDictionaryBatch(e);if(t&&await this._handle.seek(t.offset)){const e=await this._reader.readMessage(bt.DictionaryBatch);if(e&&e.isDictionaryBatch()){const t=e.header(),r=await this._reader.readMessageBody(e.bodyLength),n=this._loadDictionaryBatch(t,r);this.dictionaries.set(t.id,n)}}}async _readFooter(){const{_handle:e}=this;e._pending&&await e._pending;const t=e.size-Is,r=await e.readInt32(t),n=await e.readAt(t-r,r);return Xi.decode(n)}async _readNextMessageAndValidate(e){if(this._footer||await this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const t=this._footer.getRecordBatch(this._recordBatchIndex);if(t&&await this._handle.seek(t.offset))return await this._reader.readMessage(e)}return null}}class Uc extends Mc{constructor(e,t){super(e,t)}_loadVectors(e,t,r){return new yo(t,e.nodes,e.buffers,this.dictionaries).visitMany(r)}}function Lc(e,t){return t&&"boolean"==typeof t.autoDestroy?t.autoDestroy:e.autoDestroy}function*xc(e){const t=Sc.from(e);try{if(!t.open({autoDestroy:!1}).closed)do{yield t}while(!t.reset().open().closed)}finally{t.cancel()}}async function*Fc(e){const t=await Sc.from(e);try{if(!(await t.open({autoDestroy:!1})).closed)do{yield t}while(!(await t.reset().open()).closed)}finally{await t.cancel()}}class qc{constructor(e){this._numChunks=0,this._finished=!1,this._bufferedSize=0;const{readableStrategy:t,writableStrategy:r,queueingStrategy:n="count",...i}=e;this._controller=null,this._builder=Br.new(i),this._getSize="bytes"!==n?Hc:Kc;const{highWaterMark:o=("bytes"===n?16384:1e3)}={...t},{highWaterMark:s=("bytes"===n?16384:1e3)}={...r};this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:e=>{this._maybeFlush(this._builder,this._controller=e)},start:e=>{this._maybeFlush(this._builder,this._controller=e)}},{highWaterMark:o,size:"bytes"!==n?Hc:Kc}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:s,size:e=>this._writeValueAndReturnChunkSize(e)})}_writeValueAndReturnChunkSize(e){const t=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(e)),this._bufferedSize-t}_maybeFlush(e,t){null!==t&&(this._bufferedSize>=t.desiredSize&&++this._numChunks&&this._enqueue(t,e.toVector()),e.finished&&((e.length>0||0===this._numChunks)&&++this._numChunks&&this._enqueue(t,e.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(t,null)))}_enqueue(e,t){this._bufferedSize=0,this._controller=null,null===t?e.close():e.enqueue(t)}}const Hc=e=>e.length,Kc=e=>e.byteLength;class zc{eq(e){return e instanceof zc||(e=new Vc(e)),new Jc(this,e)}le(e){return e instanceof zc||(e=new Vc(e)),new Xc(this,e)}ge(e){return e instanceof zc||(e=new Vc(e)),new Zc(this,e)}lt(e){return new eu(this.ge(e))}gt(e){return new eu(this.le(e))}ne(e){return new eu(this.eq(e))}}class Vc extends zc{constructor(e){super(),this.v=e}}class Gc extends zc{constructor(e){super(),this.name=e}bind(e){if(!this.colidx){this.colidx=-1;const t=e.schema.fields;for(let e=-1;++e<t.length;)if(t[e].name===this.name){this.colidx=e;break}if(this.colidx<0)throw new Error(`Failed to bind Col "${this.name}"`)}const t=this.vector=e.getChildAt(this.colidx);return e=>t.get(e)}}class jc{and(...e){return new Wc(this,...e)}or(...e){return new $c(this,...e)}not(){return new eu(this)}}class Yc extends jc{constructor(e,t){super(),this.left=e,this.right=t}bind(e){return this.left instanceof Vc?this.right instanceof Vc?this._bindLitLit(e,this.left,this.right):this._bindLitCol(e,this.left,this.right):this.right instanceof Vc?this._bindColLit(e,this.left,this.right):this._bindColCol(e,this.left,this.right)}}class Qc extends jc{constructor(...e){super(),this.children=e}}Qc.prototype.children=Object.freeze([]);class Wc extends Qc{constructor(...e){e=e.reduce((e,t)=>e.concat(t instanceof Wc?t.children:t),[]),super(...e)}bind(e){const t=this.children.map(t=>t.bind(e));return(e,r)=>t.every(t=>t(e,r))}}class $c extends Qc{constructor(...e){e=e.reduce((e,t)=>e.concat(t instanceof $c?t.children:t),[]),super(...e)}bind(e){const t=this.children.map(t=>t.bind(e));return(e,r)=>t.some(t=>t(e,r))}}class Jc extends Yc{_bindLitLit(e,t,r){const n=t.v==r.v;return()=>n}_bindColCol(e,t,r){const n=t.bind(e),i=r.bind(e);return(e,t)=>n(e,t)==i(e,t)}_bindColLit(e,t,r){const n=t.bind(e);if(t.vector instanceof Ys){let e;const n=t.vector;return n.dictionary!==this.lastDictionary?(e=n.reverseLookup(r.v),this.lastDictionary=n.dictionary,this.lastKey=e):e=this.lastKey,-1===e?()=>!1:t=>n.getKey(t)===e}return(e,t)=>n(e,t)==r.v}_bindLitCol(e,t,r){return this._bindColLit(e,r,t)}}class Xc extends Yc{_bindLitLit(e,t,r){const n=t.v<=r.v;return()=>n}_bindColCol(e,t,r){const n=t.bind(e),i=r.bind(e);return(e,t)=>n(e,t)<=i(e,t)}_bindColLit(e,t,r){const n=t.bind(e);return(e,t)=>n(e,t)<=r.v}_bindLitCol(e,t,r){const n=r.bind(e);return(e,r)=>t.v<=n(e,r)}}class Zc extends Yc{_bindLitLit(e,t,r){const n=t.v>=r.v;return()=>n}_bindColCol(e,t,r){const n=t.bind(e),i=r.bind(e);return(e,t)=>n(e,t)>=i(e,t)}_bindColLit(e,t,r){const n=t.bind(e);return(e,t)=>n(e,t)>=r.v}_bindLitCol(e,t,r){const n=r.bind(e);return(e,r)=>t.v>=n(e,r)}}class eu extends jc{constructor(e){super(),this.child=e}bind(e){const t=this.child.bind(e);return(e,r)=>!t(e,r)}}Tc.prototype.countBy=function(e){return new tu(this.chunks).countBy(e)},Tc.prototype.scan=function(e,t){return new tu(this.chunks).scan(e,t)},Tc.prototype.scanReverse=function(e,t){return new tu(this.chunks).scanReverse(e,t)},Tc.prototype.filter=function(e){return new tu(this.chunks).filter(e)};class tu extends Tc{filter(e){return new nu(this.chunks,e)}scan(e,t){const r=this.chunks,n=r.length;for(let i=-1;++i<n;){const n=r[i];t&&t(n);for(let t=-1,r=n.length;++t<r;)e(t,n)}}scanReverse(e,t){const r=this.chunks;for(let n=r.length;--n>=0;){const i=r[n];t&&t(i);for(let t=i.length;--t>=0;)e(t,i)}}countBy(e){const t=this.chunks,r=t.length,n="string"==typeof e?new Gc(e):e;n.bind(t[r-1]);const i=n.vector;if(!zt.isDictionary(i.type))throw new Error("countBy currently only supports dictionary-encoded columns");const o=Math.ceil(Math.log(i.length)/Math.log(256)),s=new(4==o?Uint32Array:o>=2?Uint16Array:Uint8Array)(i.dictionary.length);for(let e=-1;++e<r;){const r=t[e];n.bind(r);const i=n.vector.indices;for(let e=-1,t=r.length;++e<t;){let t=i.get(e);null!==t&&s[t]++}}return new ru(i.dictionary,sa.from(s))}}class ru extends Tc{constructor(e,t){const r=new pi([new fi("values",e.type),new fi("counts",t.type)]);super(new Ic(r,t.length,[e,t]))}toJSON(){const e=this.getColumnAt(0),t=this.getColumnAt(1),r={};for(let n=-1;++n<this.length;)r[e.get(n)]=t.get(n);return r}}class nu extends tu{constructor(e,t){super(e),this._predicate=t}scan(e,t){const r=this._chunks,n=r.length;for(let i=-1;++i<n;){const n=r[i],o=this._predicate.bind(n);let s=!1;for(let r=-1,i=n.length;++r<i;)o(r,n)&&(t&&!s&&(t(n),s=!0),e(r,n))}}scanReverse(e,t){const r=this._chunks;for(let n=r.length;--n>=0;){const i=r[n],o=this._predicate.bind(i);let s=!1;for(let r=i.length;--r>=0;)o(r,i)&&(t&&!s&&(t(i),s=!0),e(r,i))}}count(){let e=0;const t=this._chunks,r=t.length;for(let n=-1;++n<r;){const r=t[n],i=this._predicate.bind(r);for(let t=-1,n=r.length;++t<n;)i(t,r)&&++e}return e}*[Symbol.iterator](){const e=this._chunks,t=e.length;for(let r=-1;++r<t;){const t=e[r],n=this._predicate.bind(t);for(let e=-1,r=t.length;++e<r;)n(e,t)&&(yield t.get(e))}}filter(e){return new nu(this._chunks,this._predicate.and(e))}countBy(e){const t=this._chunks,r=t.length,n="string"==typeof e?new Gc(e):e;n.bind(t[r-1]);const i=n.vector;if(!zt.isDictionary(i.type))throw new Error("countBy currently only supports dictionary-encoded columns");const o=Math.ceil(Math.log(i.length)/Math.log(256)),s=new(4==o?Uint32Array:o>=2?Uint16Array:Uint8Array)(i.dictionary.length);for(let e=-1;++e<r;){const r=t[e],i=this._predicate.bind(r);n.bind(r);const o=n.vector.indices;for(let e=-1,t=r.length;++e<t;){let t=o.get(e);null!==t&&i(e,r)&&s[t]++}}return new ru(i.dictionary,sa.from(s))}}ot.toDOMStream=function(e,t){if(Ue(e))return function(e,t){let r=null;const n=t&&"bytes"===t.type||!1,i=t&&t.highWaterMark||2**24;return new ReadableStream({...t,async start(t){await o(t,r||(r=e[Symbol.asyncIterator]()))},async pull(e){r?await o(e,r):e.close()},async cancel(){r&&r.return&&await r.return(),r=null}},{highWaterMark:n?i:void 0,...t});async function o(e,t){let r,i=null,o=e.desiredSize||null;for(;!(i=await t.next(n?o:null)).done;)if(ArrayBuffer.isView(i.value)&&(r=$e(i.value))&&(null!=o&&n&&(o=o-r.byteLength+1),i.value=r),e.enqueue(i.value),null!=o&&--o<=0)return;e.close()}}(e,t);if(De(e))return function(e,t){let r=null;const n=t&&"bytes"===t.type||!1,i=t&&t.highWaterMark||2**24;return new ReadableStream({...t,start(t){o(t,r||(r=e[Symbol.iterator]()))},pull(e){r?o(e,r):e.close()},cancel(){r&&r.return&&r.return(),r=null}},{highWaterMark:n?i:void 0,...t});function o(e,t){let r,i=null,o=e.desiredSize||null;for(;!(i=t.next(n?o:null)).done;)if(ArrayBuffer.isView(i.value)&&(r=$e(i.value))&&(null!=o&&n&&(o=o-r.byteLength+1),i.value=r),e.enqueue(i.value),null!=o&&--o<=0)return;e.close()}}(e,t);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")},Br.throughDOM=function(e){return new qc(e)},Sc.throughDOM=function(e,t){const r=new to;let n=null;const i=new ReadableStream({async cancel(){await r.close()},async start(e){await o(e,n||(n=await async function(){return await(await Sc.from(r)).open(t)}()))},async pull(e){n?await o(e,n):e.close()}});return{writable:new WritableStream(r,{highWaterMark:16384,...e}),readable:i};async function o(e,t){let r=e.desiredSize,n=null;for(;!(n=await t.next()).done;)if(e.enqueue(n.value),null!=r&&--r<=0)return;e.close()}},Os.throughDOM=function(e,t){const r=new this(e),n=new no(r),i=new ReadableStream({type:"bytes",async cancel(){await n.cancel()},async pull(e){await o(e)},async start(e){await o(e)}},{highWaterMark:16384,...t});return{writable:new WritableStream(r,e),readable:i};async function o(e){let t=null,r=e.desiredSize;for(;t=await n.read(r||null);)if(e.enqueue(t),null!=r&&(r-=t.byteLength)<=0)return;e.close()}};
/**
     * @license
     * Copyright 2018-2019 Streamlit Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *    http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class iu{dataTable;indexTable;columnsTable;styler;constructor(e,t,r,n){this.dataTable=Tc.from(e),this.indexTable=Tc.from(t),this.columnsTable=Tc.from(r),this.styler=n?{caption:n.get("caption"),displayValuesTable:Tc.from(n.get("displayValues")),styles:n.get("styles"),uuid:n.get("uuid")}:void 0}get rows(){return this.indexTable.length+this.columnsTable.numCols}get columns(){return this.indexTable.numCols+this.columnsTable.length}get headerRows(){return this.rows-this.dataRows}get headerColumns(){return this.columns-this.dataColumns}get dataRows(){return this.dataTable.length}get dataColumns(){return this.dataTable.numCols}get uuid(){return this.styler&&this.styler.uuid}get caption(){return this.styler&&this.styler.caption}get styles(){return this.styler&&this.styler.styles}get table(){return this.dataTable}get index(){return this.indexTable}get columnTable(){return this.columnsTable}getCell=(e,t)=>{const r=e<this.headerRows&&t<this.headerColumns,n=e>=this.headerRows&&t<this.headerColumns,i=e<this.headerRows&&t>=this.headerColumns;if(r){const r=["blank"];return t>0&&r.push("level"+e),{type:"blank",classNames:r.join(" "),content:""}}if(i){const r=t-this.headerColumns;return{type:"columns",classNames:["col_heading","level"+e,"col"+r].join(" "),content:this.getContent(this.columnsTable,r,e)}}if(n){const r=e-this.headerRows,n=["row_heading","level"+t,"row"+r];return{type:"index",id:`T_${this.uuid}level${t}_row${r}`,classNames:n.join(" "),content:this.getContent(this.indexTable,r,t)}}{const r=e-this.headerRows,n=t-this.headerColumns,i=["data","row"+r,"col"+n],o=this.styler?this.getContent(this.styler.displayValuesTable,r,n):this.getContent(this.dataTable,r,n);return{type:"data",id:`T_${this.uuid}row${r}_col${n}`,classNames:i.join(" "),content:o}}};getContent=(e,t,r)=>{const n=e.getColumnAt(r);if(null===n)return"";switch(this.getColumnTypeId(e,r)){case dt.Timestamp:return this.nanosToDate(n.get(t));default:return n.get(t)}};getColumnTypeId(e,t){return e.schema.fields[t].type.typeId}nanosToDate(e){return new Date(e/1e6)}}
/**
     * @license
     * Copyright 2018-2020 Streamlit Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *    http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ou;!function(e){e.COMPONENT_READY="streamlit:componentReady",e.SET_COMPONENT_VALUE="streamlit:setComponentValue",e.SET_FRAME_HEIGHT="streamlit:setFrameHeight"}(ou||(ou={}));class su{static API_VERSION=1;static RENDER_EVENT="streamlit:render";static events=new ae;static registeredMessageListener=!1;static lastFrameHeight;static setComponentReady=()=>{su.registeredMessageListener||(window.addEventListener("message",su.onMessageEvent),su.registeredMessageListener=!0),su.sendBackMsg(ou.COMPONENT_READY,{apiVersion:su.API_VERSION})};static setFrameHeight=e=>{void 0===e&&(e=document.body.scrollHeight),e!==su.lastFrameHeight&&(su.lastFrameHeight=e,su.sendBackMsg(ou.SET_FRAME_HEIGHT,{height:e}))};static setComponentValue=e=>{su.sendBackMsg(ou.SET_COMPONENT_VALUE,{value:e})};static onMessageEvent=e=>{switch(e.data.type){case su.RENDER_EVENT:su.onRenderMessage(e.data)}};static onRenderMessage=e=>{let t=e.args;null==t&&(console.error("Got null args in onRenderMessage. This should never happen"),t={});const r=e.dfs&&e.dfs.length>0?su.argsDataframeToObject(e.dfs):{};t={...t,...r};const n={disabled:Boolean(e.disabled),args:t},i=new CustomEvent(su.RENDER_EVENT,{detail:n});su.events.dispatchEvent(i)};static argsDataframeToObject=e=>{const t=e.map(({key:e,value:t})=>[e,su.toArrowTable(t)]);return Object.fromEntries(t)};static toArrowTable=e=>{const{data:t,index:r,columns:n}=e.data;return new iu(t,r,n)};static sendBackMsg=(e,t)=>{window.parent.postMessage({isStreamlitMessage:!0,type:e,...t},"*")}}function au(e){let t,r,n,i;const o=[uu,cu],s=[];function a(e,t){return e[1]?0:1}return t=a(e),r=s[t]=o[t](e),{c(){r.c(),n=p()},m(e,r){s[t].m(e,r),c(e,n,r),i=!0},p(e,i){let c=t;t=a(e),t===c?s[t].p(e,i):(U(),F(s[c],1,1,()=>{s[c]=null}),L(),r=s[t],r?r.p(e,i):(r=s[t]=o[t](e),r.c()),x(r,1),r.m(n.parentNode,n))},i(e){i||(x(r),i=!0)},o(e){F(r),i=!1},d(e){s[t].d(e),e&&u(n)}}}function cu(e){let t,r,n;var i=e[0];function o(e){return{props:{args:e[3],disabled:e[5],width:e[4]}}}return i&&(t=b(i,o(e))),{c(){t&&q(t.$$.fragment),r=p()},m(e,i){t&&H(t,e,i),c(e,r,i),n=!0},p(e,n){const s={};if(8&n&&(s.args=e[3]),32&n&&(s.disabled=e[5]),16&n&&(s.width=e[4]),1&n&&i!==(i=e[0])){if(t){U();const e=t;F(e.$$.fragment,1,0,()=>{K(e,1)}),L()}i?(t=b(i,o(e)),q(t.$$.fragment),x(t.$$.fragment,1),H(t,r.parentNode,r)):t=null}else i&&t.$set(s)},i(e){n||(t&&x(t.$$.fragment,e),n=!0)},o(e){t&&F(t.$$.fragment,e),n=!1},d(e){e&&u(r),t&&K(t,e)}}}function uu(e){let r,n,i;const o=[e[3],{disabled:e[5]},{width:e[4]}];var s=e[0];function a(e){let r={};for(let e=0;e<o.length;e+=1)r=t(r,o[e]);return{props:r}}return s&&(r=b(s,a())),{c(){r&&q(r.$$.fragment),n=p()},m(e,t){r&&H(r,e,t),c(e,n,t),i=!0},p(e,t){const i=56&t?function(e,t){const r={},n={},i={$$scope:1};let o=e.length;for(;o--;){const s=e[o],a=t[o];if(a){for(const e in s)e in a||(n[e]=1);for(const e in a)i[e]||(r[e]=a[e],i[e]=1);e[o]=a}else for(const e in s)i[e]=1}for(const e in n)e in r||(r[e]=void 0);return r}(o,[8&t&&(c=e[3],"object"==typeof c&&null!==c?c:{}),32&t&&{disabled:e[5]},16&t&&{width:e[4]}]):{};var c;if(1&t&&s!==(s=e[0])){if(r){U();const e=r;F(e.$$.fragment,1,0,()=>{K(e,1)}),L()}s?(r=b(s,a()),q(r.$$.fragment),x(r.$$.fragment,1),H(r,n.parentNode,n)):r=null}else s&&r.$set(i)},i(e){i||(r&&x(r.$$.fragment,e),i=!0)},o(e){r&&F(r.$$.fragment,e),i=!1},d(e){e&&u(n),r&&K(r,e)}}}function lu(e){let t,r,n,i;R(e[6]);let o=e[2]&&au(e);return{c(){o&&o.c(),t=p()},m(s,a){o&&o.m(s,a),c(s,t,a),r=!0,n||(i=f(window,"resize",e[6]),n=!0)},p(e,[r]){e[2]?o?(o.p(e,r),4&r&&x(o,1)):(o=au(e),o.c(),x(o,1),o.m(t.parentNode,t)):o&&(U(),F(o,1,1,()=>{o=null}),L())},i(e){r||(x(o),r=!0)},o(e){F(o),r=!1},d(e){o&&o.d(e),e&&u(t),n=!1,i()}}}function hu(e,t,r){let n,i,o,s,{component:a}=t,{spreadArgs:c=!0}=t;const u=e=>{r(2,n=e.detail),r(3,i=n.args),r(5,s=n.disabled)};var l;return T(()=>{su.events.addEventListener(su.RENDER_EVENT,u),su.setComponentReady()}),l=()=>{su.events.removeEventListener(su.RENDER_EVENT,u)},w().$$.on_destroy.push(l),e.$$set=e=>{"component"in e&&r(0,a=e.component),"spreadArgs"in e&&r(1,c=e.spreadArgs)},[a,c,n,i,o,s,function(){r(4,o=window.innerWidth)}]}const du={labelButtonIn:"Login",labelLogin:"Entre com a sua conta RBR.",labelButtonOut:"Logout",labelLogout:"Olá ",labelLoading:"Carregando...",errorFatal:"Um erro ocorreu. Entre em contato com o suporte."};
/*! @azure/msal-browser v2.37.1 2023-06-07 */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var pu=function(e,t){return(pu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function fu(e,t){function r(){this.constructor=e}pu(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var gu=function(){return(gu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function yu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function mu(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function vu(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function bu(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function _u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(bu(arguments[t]));return e}
/*! @azure/msal-common v13.1.0 2023-06-07 */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var wu=function(e,t){return(wu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function Tu(e,t){function r(){this.constructor=e}wu(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Iu=function(){return(Iu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Cu(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function Eu(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function Su(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}
/*! @azure/msal-common v13.1.0 2023-06-07 */var Au,ku,Ru,Nu,Ou,Mu={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Pu=[Mu.OPENID_SCOPE,Mu.PROFILE_SCOPE,Mu.OFFLINE_ACCESS_SCOPE],Bu=Su(Pu,[Mu.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info",e.X_MS_REQUEST_ID="x-ms-request-id",e.X_MS_HTTP_VERSION="x-ms-httpver"}(Au||(Au={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account",e.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(ku||(ku={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(Ru||(Ru={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"}(Nu||(Nu={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(Ou||(Ou={}));var Du,Uu={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(Du||(Du={}));var Lu,xu,Fu,qu,Hu,Ku,zu={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(Lu||(Lu={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(xu||(xu={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(Fu||(Fu={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(qu||(qu={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(Hu||(Hu={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(Ku||(Ku={}));var Vu,Gu="authority-metadata",ju=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network",e.HARDCODED_VALUES="hardcoded_values"}(Vu||(Vu={}));var Yu,Qu={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"}(Yu||(Yu={}));var Wu,$u,Ju,Xu,Zu,el,tl=60,rl=3600,nl="throttling",il="retry-after, h429",ol="invalid_grant",sl="client_mismatch";!function(e){e.username="username",e.password="password"}(Wu||(Wu={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}($u||($u={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(Ju||(Ju={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(Xu||(Xu={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(Zu||(Zu={})),function(e){e.Jwt="JWT",e.Jwk="JWK",e.Pop="pop"}(el||(el={}));
/*! @azure/msal-common v13.1.0 2023-06-07 */
var al,cl={code:"unexpected_error",desc:"Unexpected error in authentication."},ul={code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},ll=function(e){function t(r,n,i){var o=this,s=n?r+": "+n:r;return o=e.call(this,s)||this,Object.setPrototypeOf(o,t.prototype),o.errorCode=r||Mu.EMPTY_STRING,o.errorMessage=n||Mu.EMPTY_STRING,o.subError=i||Mu.EMPTY_STRING,o.name="AuthError",o}return Tu(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(cl.code,cl.desc+": "+e)},t.createPostRequestFailed=function(e){return new t(ul.code,ul.desc+": "+e)},t}(Error),hl={createNewGuid:function(){throw ll.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw ll.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw ll.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",ll.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",ll.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",ll.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",ll.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",ll.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(e){throw"Crypto interface - hashString() has not been implemented",ll.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},dl={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},pl={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},fl={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},gl={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},yl={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},ml={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},vl={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},bl={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},_l={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},wl={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},Tl={code:"state_not_found",desc:"State not found"},Il={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},Cl={code:"nonce_not_found",desc:"nonce not found"},El={code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},Sl={code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},Al={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},kl={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},Rl={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},Nl={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},Ol={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},Ml={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},Pl={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},Bl={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},Dl={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},Ul={code:"device_code_expired",desc:"Device code is expired."},Ll={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},xl={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},Fl={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},ql={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},Hl={code:"no_account_found",desc:"No account found in cache for given key."},Kl={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},zl={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},Vl={code:"invalid_cache_type",desc:"Invalid cache type"},Gl={code:"unexpected_account_type",desc:"Unexpected account type."},jl={code:"unexpected_credential_type",desc:"Unexpected credential type."},Yl={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},Ql={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},Wl={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},$l={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},Jl={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},Xl={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},Zl={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},eh={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},th={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},rh={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},nh={code:"user_canceled",desc:"User canceled the flow."},ih=function(e){function t(r,n){var i=e.call(this,r,n)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,t.prototype),i}return Tu(t,e),t.createClientInfoDecodingError=function(e){return new t(dl.code,dl.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(pl.code,""+pl.desc)},t.createTokenParsingError=function(e){return new t(fl.code,fl.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(gl.code,gl.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(yl.code,yl.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(ml.code,ml.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(vl.code,vl.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(bl.code,bl.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(_l.code,_l.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(wl.code,wl.desc)},t.createStateNotFoundError=function(e){return new t(Tl.code,Tl.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(Il.code,Il.desc)},t.createAuthTimeNotFoundError=function(){return new t(El.code,El.desc)},t.createMaxAgeTranspiredError=function(){return new t(Sl.code,Sl.desc)},t.createNonceNotFoundError=function(e){return new t(Cl.code,Cl.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(Al.code,Al.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(kl.code,kl.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(Rl.code,Rl.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(Nl.code,Nl.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(Ol.code,Ol.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(Ml.code,Ml.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(Pl.code,Pl.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(Bl.code,""+Bl.desc)},t.createDeviceCodeCancelledError=function(){return new t(Dl.code,""+Dl.desc)},t.createDeviceCodeExpiredError=function(){return new t(Ul.code,""+Ul.desc)},t.createDeviceCodeUnknownError=function(){return new t(Ll.code,""+Ll.desc)},t.createNoAccountInSilentRequestError=function(){return new t(xl.code,""+xl.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(Fl.code,Fl.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(ql.code,ql.desc)},t.createNoAccountFoundError=function(){return new t(Hl.code,Hl.desc)},t.createCachePluginError=function(){return new t(Kl.code,""+Kl.desc)},t.createNoCryptoObjectError=function(e){return new t(zl.code,""+zl.desc+e)},t.createInvalidCacheTypeError=function(){return new t(Vl.code,""+Vl.desc)},t.createUnexpectedAccountTypeError=function(){return new t(Gl.code,""+Gl.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(jl.code,""+jl.desc)},t.createInvalidAssertionError=function(){return new t(Yl.code,""+Yl.desc)},t.createInvalidCredentialError=function(){return new t(Ql.code,""+Ql.desc)},t.createRefreshRequiredError=function(){return new t(Wl.code,Wl.desc)},t.createUserTimeoutReachedError=function(){return new t($l.code,$l.desc)},t.createTokenClaimsRequiredError=function(){return new t(Jl.code,Jl.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(Xl.code,Xl.desc)},t.createBindingKeyNotRemovedError=function(){return new t(Zl.code,Zl.desc)},t.createLogoutNotSupportedError=function(){return new t(eh.code,eh.desc)},t.createKeyIdMissingError=function(){return new t(th.code,th.desc)},t.createNoNetworkConnectivityError=function(){return new t(rh.code,rh.desc)},t.createUserCanceledError=function(){return new t(nh.code,nh.desc)},t}(ll),oh=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw ih.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw ih.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(e){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},r=e.split("&"),n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),i=r[0],o=r[1];i&&o&&(t[n(i)]=n(o))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(al||(al={}));var sh,ah=function(){function e(t,r,n){this.level=al.Info;var i=t||e.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||function(){},this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level="number"==typeof i.logLevel?i.logLevel:al.Info,this.correlationId=i.correlationId||Mu.EMPTY_STRING,this.packageName=r||Mu.EMPTY_STRING,this.packageVersion=n||Mu.EMPTY_STRING}return e.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:al.Info}},e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(oh.isEmpty(t.correlationId)?oh.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+al[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:al.Error,containsPii:!1,correlationId:t||Mu.EMPTY_STRING})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:al.Error,containsPii:!0,correlationId:t||Mu.EMPTY_STRING})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:al.Warning,containsPii:!1,correlationId:t||Mu.EMPTY_STRING})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:al.Warning,containsPii:!0,correlationId:t||Mu.EMPTY_STRING})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:al.Info,containsPii:!1,correlationId:t||Mu.EMPTY_STRING})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:al.Info,containsPii:!0,correlationId:t||Mu.EMPTY_STRING})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:al.Verbose,containsPii:!1,correlationId:t||Mu.EMPTY_STRING})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:al.Verbose,containsPii:!0,correlationId:t||Mu.EMPTY_STRING})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:al.Trace,containsPii:!1,correlationId:t||Mu.EMPTY_STRING})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:al.Trace,containsPii:!0,correlationId:t||Mu.EMPTY_STRING})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}();
/*! @azure/msal-common v13.1.0 2023-06-07 */!function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"}(sh||(sh={}));
/*! @azure/msal-common v13.1.0 2023-06-07 */
var ch,uh={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},lh={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},hh={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},dh={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},ph={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},fh={code:"empty_url_error",desc:"URL was empty or null."},gh={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},yh={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},mh={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},vh={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},bh={code:"token_request_empty",desc:"Token request was empty and not found in cache."},_h={code:"logout_request_empty",desc:"The logout request was null or undefined."},wh={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},Th={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},Ih={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},Ch={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},Eh={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},Sh={code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},Ah={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},kh={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},Rh={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},Nh={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},Oh={code:"authority_mismatch",desc:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},Mh=function(e){function t(r,n){var i=e.call(this,r,n)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,t.prototype),i}return Tu(t,e),t.createRedirectUriEmptyError=function(){return new t(uh.code,uh.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(lh.code,lh.desc)},t.createClaimsRequestParsingError=function(e){return new t(hh.code,hh.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(dh.code,dh.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(ph.code,ph.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(fh.code,fh.desc)},t.createEmptyScopesArrayError=function(){return new t(gh.code,""+gh.desc)},t.createClientIdSingleScopeError=function(e){return new t(yh.code,yh.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(mh.code,mh.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(vh.code,vh.desc)},t.createEmptyLogoutRequestError=function(){return new t(_h.code,_h.desc)},t.createEmptyTokenRequestError=function(){return new t(bh.code,bh.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(wh.code,wh.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(Th.code,Th.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(Ih.code,Ih.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(Ch.code,Ch.desc)},t.createUntrustedAuthorityError=function(){return new t(Eh.code,Eh.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(Sh.code,Sh.desc)},t.createMissingSshJwkError=function(){return new t(Ah.code,Ah.desc)},t.createMissingSshKidError=function(){return new t(kh.code,kh.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(Rh.code,Rh.desc)},t.createInvalidAuthenticationHeaderError=function(e,r){return new t(Nh.code,Nh.desc+". Invalid header: "+e+". Details: "+r)},t.createAuthorityMismatchError=function(){return new t(Oh.code,Oh.desc)},t}(ih),Ph=function(){function e(e){var t=this,r=e?oh.trimArrayEntries(Su(e)):[],n=r?oh.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||Mu.EMPTY_STRING).split(" "))},e.createSearchScopes=function(t){var r=new e(t);return r.containsOnlyOIDCScopes()?r.removeScope(Mu.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Mh.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!oh.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return Bu.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){oh.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw ih.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(oh.isEmpty(e))throw ih.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;Bu.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw ih.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw ih.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):Mu.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();
/*! @azure/msal-common v13.1.0 2023-06-07 */
function Bh(e,t){if(oh.isEmpty(e))throw ih.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw ih.createClientInfoDecodingError(e.message)}}function Dh(e){if(oh.isEmpty(e))throw ih.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(qu.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?Mu.EMPTY_STRING:t[1]}}
/*! @azure/msal-common v13.1.0 2023-06-07 */!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs",e[e.Dsts=2]="Dsts",e[e.Ciam=3]="Ciam"}(ch||(ch={}));
/*! @azure/msal-common v13.1.0 2023-06-07 */
var Uh=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(qu.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case Fu.ADFS_ACCOUNT_TYPE:return Ku.ADFS;case Fu.MSAV1_ACCOUNT_TYPE:return Ku.MSA;case Fu.MSSTS_ACCOUNT_TYPE:return Ku.MSSTS;case Fu.GENERIC_ACCOUNT_TYPE:return Ku.GENERIC;default:throw ih.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||Mu.EMPTY_STRING,e.tenantId||Mu.EMPTY_STRING].join(qu.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,i,o,s,a,c){var u,l,h,d,p,f,g=new e;g.authorityType=Fu.MSSTS_ACCOUNT_TYPE,g.clientInfo=t,g.homeAccountId=r,g.nativeAccountId=c;var y=a||i&&i.getPreferredCache();if(!y)throw ih.createInvalidCacheEnvironmentError();if(g.environment=y,g.realm=(null===(u=null==n?void 0:n.claims)||void 0===u?void 0:u.tid)||Mu.EMPTY_STRING,n){g.idTokenClaims=n.claims,g.localAccountId=(null===(l=null==n?void 0:n.claims)||void 0===l?void 0:l.oid)||(null===(h=null==n?void 0:n.claims)||void 0===h?void 0:h.sub)||Mu.EMPTY_STRING;var m=null===(d=null==n?void 0:n.claims)||void 0===d?void 0:d.preferred_username,v=(null===(p=null==n?void 0:n.claims)||void 0===p?void 0:p.emails)?n.claims.emails[0]:null;g.username=m||v||Mu.EMPTY_STRING,g.name=null===(f=null==n?void 0:n.claims)||void 0===f?void 0:f.name}return g.cloudGraphHostName=o,g.msGraphHost=s,g},e.createGenericAccount=function(t,r,n,i,o,s){var a,c,u,l,h=new e;h.authorityType=n&&n.authorityType===ch.Adfs?Fu.ADFS_ACCOUNT_TYPE:Fu.GENERIC_ACCOUNT_TYPE,h.homeAccountId=t,h.realm=Mu.EMPTY_STRING;var d=s||n&&n.getPreferredCache();if(!d)throw ih.createInvalidCacheEnvironmentError();return r&&(h.localAccountId=(null===(a=null==r?void 0:r.claims)||void 0===a?void 0:a.oid)||(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.sub)||Mu.EMPTY_STRING,h.username=(null===(u=null==r?void 0:r.claims)||void 0===u?void 0:u.upn)||Mu.EMPTY_STRING,h.name=(null===(l=null==r?void 0:r.claims)||void 0===l?void 0:l.name)||Mu.EMPTY_STRING,h.idTokenClaims=null==r?void 0:r.claims),h.environment=d,h.cloudGraphHostName=i,h.msGraphHost=o,h},e.generateHomeAccountId=function(e,t,r,n,i){var o,s=(null===(o=null==i?void 0:i.claims)||void 0===o?void 0:o.sub)?i.claims.sub:Mu.EMPTY_STRING;if(t===ch.Adfs||t===ch.Dsts)return s;if(e)try{var a=Bh(e,n);if(!oh.isEmpty(a.uid)&&!oh.isEmpty(a.utid))return""+a.uid+qu.CLIENT_INFO_SEPARATOR+a.utid}catch(e){}return r.verbose("No client info in response"),s},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var i=e.idTokenClaims||{},o=t.idTokenClaims||{};n=i.iat===o.iat&&i.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n},e}(),Lh=function(){function e(t,r){if(oh.isEmpty(t))throw ih.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=oh.decodeAuthToken(e);try{var n=r.JWSPayload,i=t.base64Decode(n);return JSON.parse(i)}catch(e){throw ih.createTokenParsingError(e)}},e.checkMaxAge=function(e,t){if(0===t||Date.now()-3e5>e+t)throw ih.createMaxAgeTranspiredError()},e}(),xh=function(){function e(e,t,r){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone("@azure/msal-common","13.1.0")}return e.prototype.getAllAccounts=function(){var e=this,t=this.getAccountKeys();if(t.length<1)return[];var r=t.reduce((function(t,r){var n=e.getAccount(r);return n?(t.push(n),t):t}),[]);return r.length<1?[]:r.map((function(t){return e.getAccountInfoFromEntity(t)}))},e.prototype.getAccountInfoFilteredBy=function(e){var t=this.getAccountsFilteredBy(e);return t.length>0?this.getAccountInfoFromEntity(t[0]):null},e.prototype.getAccountInfoFromEntity=function(e){var t=e.getAccountInfo(),r=this.getIdToken(t);return r&&(t.idToken=r.secret,t.idTokenClaims=new Lh(r.secret,this.cryptoImpl).claims),t},e.prototype.saveCacheRecord=function(e){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(t){switch(t.label){case 0:if(!e)throw ih.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return Cu(this,void 0,void 0,(function(){var t,r,n,i,o=this;return Eu(this,(function(s){switch(s.label){case 0:return t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),n=Ph.fromString(e.target),i=[],r.accessToken.forEach((function(e){if(o.accessTokenKeyMatchesFilter(e,t,!1)){var r=o.getAccessTokenCredential(e);if(r&&o.credentialMatchesFilter(r,t))Ph.fromString(r.target).intersectingScopeSets(n)&&i.push(o.removeAccessToken(e))}})),[4,Promise.all(i)];case 1:return s.sent(),this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){var t=this,r=this.getAccountKeys(),n=[];return r.forEach((function(r){if(t.isAccountKey(r,e.homeAccountId,e.realm)){var i=t.getAccount(r);i&&(e.homeAccountId&&!t.matchHomeAccountId(i,e.homeAccountId)||e.localAccountId&&!t.matchLocalAccountId(i,e.localAccountId)||e.username&&!t.matchUsername(i,e.username)||e.environment&&!t.matchEnvironment(i,e.environment)||e.realm&&!t.matchRealm(i,e.realm)||e.nativeAccountId&&!t.matchNativeAccountId(i,e.nativeAccountId)||n.push(i))}})),n},e.prototype.isAccountKey=function(e,t,r){return!(e.split(qu.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(r&&!e.toLowerCase().includes(r.toLowerCase())))},e.prototype.isCredentialKey=function(e){if(e.split(qu.CACHE_KEY_SEPARATOR).length<6)return!1;var t=e.toLowerCase();if(-1===t.indexOf(Hu.ID_TOKEN.toLowerCase())&&-1===t.indexOf(Hu.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(Hu.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(Hu.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(Hu.REFRESH_TOKEN.toLowerCase())>-1){var r=""+Hu.REFRESH_TOKEN+qu.CACHE_KEY_SEPARATOR+this.clientId+qu.CACHE_KEY_SEPARATOR,n=""+Hu.REFRESH_TOKEN+qu.CACHE_KEY_SEPARATOR+"1"+qu.CACHE_KEY_SEPARATOR;if(-1===t.indexOf(r.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0},e.prototype.credentialMatchesFilter=function(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===Hu.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===Yu.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),i={};return n.forEach((function(n){if(r.isAppMetadata(n)){var o=r.getAppMetadata(n);o&&(e&&!r.matchEnvironment(o,e)||t&&!r.matchClientId(o,t)||(i[n]=o))}})),i},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var i=t.getAuthorityMetadata(r);i&&-1!==i.aliases.indexOf(e)&&(n=i)}})),n},e.prototype.removeAllAccounts=function(){return Cu(this,void 0,void 0,(function(){var e,t,r=this;return Eu(this,(function(n){switch(n.label){case 0:return e=this.getAccountKeys(),t=[],e.forEach((function(e){t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.removeAccount=function(e){return Cu(this,void 0,void 0,(function(){var t;return Eu(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw ih.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return r.sent(),this.removeItem(e),[2]}}))}))},e.prototype.removeAccountContext=function(e){return Cu(this,void 0,void 0,(function(){var t,r,n,i=this;return Eu(this,(function(o){switch(o.label){case 0:return t=this.getTokenKeys(),r=e.generateAccountId(),n=[],t.idToken.forEach((function(e){0===e.indexOf(r)&&i.removeIdToken(e)})),t.accessToken.forEach((function(e){0===e.indexOf(r)&&n.push(i.removeAccessToken(e))})),t.refreshToken.forEach((function(e){0===e.indexOf(r)&&i.removeRefreshToken(e)})),[4,Promise.all(n)];case 1:return o.sent(),[2]}}))}))},e.prototype.removeAccessToken=function(e){return Cu(this,void 0,void 0,(function(){var t,r;return Eu(this,(function(n){switch(n.label){case 0:if(!(t=this.getAccessTokenCredential(e)))return[2];if(t.credentialType.toLowerCase()!==Hu.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==Yu.POP)return[3,4];if(!(r=t.keyId))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),ih.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(e)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t)})),!0},e.prototype.readCacheRecord=function(e,t,r){var n=this.getTokenKeys(),i=this.readAccountFromCache(e),o=this.getIdToken(e,n),s=this.getAccessToken(e,t,n),a=this.getRefreshToken(e,!1,n),c=this.readAppMetadataFromCache(r);return i&&o&&(i.idTokenClaims=new Lh(o.secret,this.cryptoImpl).claims),{account:i,idToken:o,accessToken:s,refreshToken:a,appMetadata:c}},e.prototype.readAccountFromCache=function(e){var t=Uh.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.getIdToken=function(e,t){this.commonLogger.trace("CacheManager - getIdToken called");var r={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Hu.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},n=this.getIdTokensByFilter(r,t),i=n.length;if(i<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(i>1)throw ih.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getIdToken - Returning id token"),n[0]},e.prototype.getIdTokensByFilter=function(e,t){var r=this,n=t&&t.idToken||this.getTokenKeys().idToken,i=[];return n.forEach((function(t){if(r.idTokenKeyMatchesFilter(t,Iu({clientId:r.clientId},e))){var n=r.getIdTokenCredential(t);n&&r.credentialMatchesFilter(n,e)&&i.push(n)}})),i},e.prototype.idTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))},e.prototype.removeIdToken=function(e){this.removeItem(e)},e.prototype.removeRefreshToken=function(e){this.removeItem(e)},e.prototype.getAccessToken=function(e,t,r){var n=this;this.commonLogger.trace("CacheManager - getAccessToken called");var i=Ph.createSearchScopes(t.scopes),o=t.authenticationScheme||Yu.BEARER,s=o&&o.toLowerCase()!==Yu.BEARER.toLowerCase()?Hu.ACCESS_TOKEN_WITH_AUTH_SCHEME:Hu.ACCESS_TOKEN,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:s,clientId:this.clientId,realm:e.tenantId,target:i,tokenType:o,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},c=r&&r.accessToken||this.getTokenKeys().accessToken,u=[];c.forEach((function(e){if(n.accessTokenKeyMatchesFilter(e,a,!0)){var t=n.getAccessTokenCredential(e);t&&n.credentialMatchesFilter(t,a)&&u.push(t)}}));var l=u.length;if(l<1)return this.commonLogger.info("CacheManager:getAccessToken - No token found"),null;if(l>1)throw ih.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),u[0]},e.prototype.accessTokenKeyMatchesFilter=function(e,t,r){var n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target)for(var i=t.target.asArray(),o=0;o<i.length;o++){if(r&&!n.includes(i[o].toLowerCase()))return!1;if(!r&&n.includes(i[o].toLowerCase()))return!0}return!0},e.prototype.getAccessTokensByFilter=function(e){var t=this,r=this.getTokenKeys(),n=[];return r.accessToken.forEach((function(r){if(t.accessTokenKeyMatchesFilter(r,e,!0)){var i=t.getAccessTokenCredential(r);i&&t.credentialMatchesFilter(i,e)&&n.push(i)}})),n},e.prototype.getRefreshToken=function(e,t,r){var n=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var i=t?"1":void 0,o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Hu.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,a=[];return s.forEach((function(e){if(n.refreshTokenKeyMatchesFilter(e,o)){var t=n.getRefreshTokenCredential(e);t&&n.credentialMatchesFilter(t,o)&&a.push(t)}})),a.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),a[0])},e.prototype.refreshTokenKeyMatchesFilter=function(e,t){var r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase())))},e.prototype.readAppMetadataFromCache=function(e){var t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((function(e){return r[e]})),i=n.length;if(i<1)return null;if(i>1)throw ih.createMultipleMatchingAppMetadataInCacheError();return n[0]},e.prototype.isAppMetadataFOCI=function(e){var t=this.readAppMetadataFromCache(e);return!(!t||"1"!==t.familyId)},e.prototype.matchHomeAccountId=function(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchLocalAccountId=function(e,t){return!("string"!=typeof e.localAccountId||t!==e.localAccountId)},e.prototype.matchUsername=function(e,t){return!("string"!=typeof e.username||t.toLowerCase()!==e.username.toLowerCase())},e.prototype.matchUserAssertionHash=function(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchNativeAccountId=function(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)},e.prototype.matchTarget=function(e,t){return!(e.credentialType!==Hu.ACCESS_TOKEN&&e.credentialType!==Hu.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&Ph.fromString(e.target).containsScopeSet(t)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf("appmetadata")},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(Gu)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return Gu+"-"+this.clientId+"-"+e},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),Fh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tu(t,e),t.prototype.setAccount=function(){throw ll.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw ll.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw ll.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw ll.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw ll.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw ll.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw ll.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw ll.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw ll.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw ll.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw ll.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw ll.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw ll.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw ll.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw ll.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw ll.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw ll.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw ll.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw ll.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw ll.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getAccountKeys=function(){throw ll.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},t.prototype.getTokenKeys=function(){throw ll.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",ll.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t.prototype.updateCredentialCacheKey=function(){throw ll.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},t}(xh),qh={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Hh={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:al.Info,correlationId:Mu.EMPTY_STRING},Kh={sendGetRequestAsync:function(){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",ll.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",ll.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},zh={sku:Mu.SKU,version:"13.1.0",cpu:Mu.EMPTY_STRING,os:Mu.EMPTY_STRING},Vh={clientSecret:Mu.EMPTY_STRING,clientAssertion:void 0},Gh={azureCloudInstance:sh.None,tenant:""+Mu.DEFAULT_COMMON_TENANT},jh={application:{appName:"",appVersion:""}};
/*! @azure/msal-common v13.1.0 2023-06-07 */
/*! @azure/msal-common v13.1.0 2023-06-07 */
var Yh,Qh=function(e){function t(r,n,i){var o=e.call(this,r,n,i)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return Tu(t,e),t}(ll),Wh=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return nl+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,i=e.generateThrottlingStorageKey(r),o=t.getThrottlingCache(i);if(o){if(o.throttleTime<Date.now())return void t.removeItem(i);throw new Qh((null===(n=o.errorCodes)||void 0===n?void 0:n.join(" "))||Mu.EMPTY_STRING,o.errorMessage,o.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var i={throttleTime:e.calculateThrottleTime(parseInt(n.headers[Au.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),i)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(Au.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||tl),r+rl))},e.removeThrottle=function(e,t,r,n){var i={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},o=this.generateThrottlingStorageKey(i);e.removeItem(o)},e}(),$h=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return Cu(this,void 0,void 0,(function(){var n,i;return Eu(this,(function(o){switch(o.label){case 0:Wh.preProcess(this.cacheManager,e),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=o.sent(),[3,4];case 3:throw(i=o.sent())instanceof ll?i:ih.createNetworkError(t,i);case 4:return Wh.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}();
/*! @azure/msal-common v13.1.0 2023-06-07 */!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(Yh||(Yh={}));
/*! @azure/msal-common v13.1.0 2023-06-07 */
var Jh,Xh,Zh=function(){function e(){}return e.validateRedirectUri=function(e){if(oh.isEmpty(e))throw Mh.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in Uu)t.push(Uu[r]);if(t.indexOf(e)<0)throw Mh.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw Mh.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(oh.isEmpty(e)||oh.isEmpty(t))throw Mh.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([zu.PLAIN,zu.S256].indexOf(e)<0)throw Mh.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),Object.fromEntries(Object.entries(e).filter((function(e){return""!==e[1]})))):{}},e}(),ed=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(Nu.RESPONSE_TYPE,encodeURIComponent(Mu.CODE_RESPONSE_TYPE))},e.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(Nu.RESPONSE_TYPE,encodeURIComponent(Mu.TOKEN_RESPONSE_TYPE+" "+Mu.ID_TOKEN_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(Nu.RESPONSE_MODE,encodeURIComponent(e||Lu.QUERY))},e.prototype.addNativeBroker=function(){this.parameters.set(Nu.NATIVE_BROKER,encodeURIComponent("1"))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?Su(e||[],Pu):e||[],n=new Ph(r);this.parameters.set(Nu.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(Nu.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){Zh.validateRedirectUri(e),this.parameters.set(Nu.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){Zh.validateRedirectUri(e),this.parameters.set(Nu.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(Nu.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(Du.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(Du.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(Au.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(Au.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(Du.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Zh.validateClaims(r),this.parameters.set(Nu.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(Nu.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(Nu.X_CLIENT_SKU,e.sku),this.parameters.set(Nu.X_CLIENT_VER,e.version),e.os&&this.parameters.set(Nu.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(Nu.X_CLIENT_CPU,e.cpu)},e.prototype.addApplicationTelemetry=function(e){(null==e?void 0:e.appName)&&this.parameters.set(Nu.X_APP_NAME,e.appName),(null==e?void 0:e.appVersion)&&this.parameters.set(Nu.X_APP_VER,e.appVersion)},e.prototype.addPrompt=function(e){Zh.validatePrompt(e),this.parameters.set(""+Nu.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){oh.isEmpty(e)||this.parameters.set(Nu.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(Nu.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(Zh.validateCodeChallengeParams(e,t),!e||!t)throw Mh.createInvalidCodeChallengeParamsError();this.parameters.set(Nu.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(Nu.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(Nu.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(Nu.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(Nu.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(Nu.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(Nu.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){oh.isEmpty(e)||this.parameters.set(Nu.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){oh.isEmpty(e)||this.parameters.set(Nu.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(Nu.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(Nu.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(Nu.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this,r=Zh.sanitizeEQParams(e,this.parameters);Object.keys(r).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw Mh.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(Ou.ACCESS_TOKEN)||(r[Ou.ACCESS_TOKEN]={}),r[Ou.ACCESS_TOKEN][Ou.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(Wu.username,encodeURIComponent(e))},e.prototype.addPassword=function(e){this.parameters.set(Wu.password,encodeURIComponent(e))},e.prototype.addPopToken=function(e){oh.isEmpty(e)||(this.parameters.set(Nu.TOKEN_TYPE,Yu.POP),this.parameters.set(Nu.REQ_CNF,encodeURIComponent(e)))},e.prototype.addSshJwk=function(e){oh.isEmpty(e)||(this.parameters.set(Nu.TOKEN_TYPE,Yu.SSH),this.parameters.set(Nu.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(Nu.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(Nu.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(Nu.X_MS_LIB_CAPABILITY,il)},e.prototype.addLogoutHint=function(e){this.parameters.set(Nu.LOGOUT_HINT,encodeURIComponent(e))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),td=function(){function e(e,t){var r,n,i,o,s,a,c,u,l,h,d,p,f,g,y;this.config=(i=(r=e).authOptions,o=r.systemOptions,s=r.loggerOptions,a=r.storageInterface,c=r.networkInterface,u=r.cryptoInterface,l=r.clientCredentials,h=r.libraryInfo,d=r.telemetry,p=r.serverTelemetryManager,f=r.persistencePlugin,g=r.serializableCache,y=Iu(Iu({},Hh),s),{authOptions:(n=i,Iu({clientCapabilities:[],azureCloudOptions:Gh,skipAuthorityMetadataCache:!1},n)),systemOptions:Iu(Iu({},qh),o),loggerOptions:y,storageInterface:a||new Fh(i.clientId,hl,new ah(y)),networkInterface:c||Kh,cryptoInterface:u||hl,clientCredentials:l||Vh,libraryInfo:Iu(Iu({},zh),h),telemetry:Iu(Iu({},jh),d),serverTelemetryManager:p||null,persistencePlugin:f||null,serializableCache:g||null}),this.logger=new ah(this.config.loggerOptions,"@azure/msal-common","13.1.0"),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new $h(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[Au.CONTENT_TYPE]=Mu.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Yh.HOME_ACCOUNT_ID:try{var r=Dh(e.credential);t[Au.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Yh.UPN:t[Au.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return Cu(this,void 0,void 0,(function(){var i;return Eu(this,(function(o){switch(o.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return i=o.sent(),this.config.serverTelemetryManager&&i.status<500&&429!==i.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,i]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw ih.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e.prototype.createTokenQueryParameters=function(e){var t=new ed;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},e}(),rd=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case Hu.ID_TOKEN:return Ku.ID_TOKEN;case Hu.ACCESS_TOKEN:case Hu.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Ku.ACCESS_TOKEN;case Hu.REFRESH_TOKEN:return Ku.REFRESH_TOKEN;default:throw ih.createUnexpectedCredentialTypeError()}},e.generateCredentialCacheKey=function(e,t,r,n,i,o,s,a,c){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,i,s),this.generateTargetForCacheKey(o),this.generateClaimsHashForCacheKey(c),this.generateSchemeForCacheKey(a)].join(qu.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(qu.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===Hu.REFRESH_TOKEN&&n||t,r||Mu.EMPTY_STRING].join(qu.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||Mu.EMPTY_STRING).toLowerCase()},e.generateClaimsHashForCacheKey=function(e){return(e||Mu.EMPTY_STRING).toLowerCase()},e.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==Yu.BEARER.toLowerCase()?e.toLowerCase():Mu.EMPTY_STRING},e}(),nd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tu(t,e),t.createIdTokenEntity=function(e,r,n,i,o){var s=new t;return s.credentialType=Hu.ID_TOKEN,s.homeAccountId=e,s.environment=r,s.clientId=i,s.secret=n,s.realm=o,s},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Hu.ID_TOKEN)},t}(rd),id=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),od=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tu(t,e),t.createAccessTokenEntity=function(e,r,n,i,o,s,a,c,u,l,h,d,p,f,g){var y,m,v=new t;v.homeAccountId=e,v.credentialType=Hu.ACCESS_TOKEN,v.secret=n;var b=id.nowSeconds();if(v.cachedAt=b.toString(),v.expiresOn=a.toString(),v.extendedExpiresOn=c.toString(),l&&(v.refreshOn=l.toString()),v.environment=r,v.clientId=i,v.realm=o,v.target=s,v.userAssertionHash=d,v.tokenType=oh.isEmpty(h)?Yu.BEARER:h,f&&(v.requestedClaims=f,v.requestedClaimsHash=g),(null===(y=v.tokenType)||void 0===y?void 0:y.toLowerCase())!==Yu.BEARER.toLowerCase())switch(v.credentialType=Hu.ACCESS_TOKEN_WITH_AUTH_SCHEME,v.tokenType){case Yu.POP:var _=Lh.extractTokenClaims(n,u);if(!(null===(m=null==_?void 0:_.cnf)||void 0===m?void 0:m.kid))throw ih.createTokenClaimsRequiredError();v.keyId=_.cnf.kid;break;case Yu.SSH:v.keyId=p}return v},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===Hu.ACCESS_TOKEN||e.credentialType===Hu.ACCESS_TOKEN_WITH_AUTH_SCHEME))},t}(rd),sd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tu(t,e),t.createRefreshTokenEntity=function(e,r,n,i,o,s){var a=new t;return a.clientId=i,a.credentialType=Hu.REFRESH_TOKEN,a.environment=r,a.homeAccountId=e,a.secret=n,a.userAssertionHash=s,o&&(a.familyId=o),a},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Hu.REFRESH_TOKEN)},t}(rd),ad=["interaction_required","consent_required","login_required"],cd=["message_only","additional_action","basic_action","user_password_expired","consent_required"],ud={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},ld={code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."},hd=function(e){function t(r,n,i,o,s,a,c){var u=e.call(this,r,n,i)||this;return Object.setPrototypeOf(u,t.prototype),u.timestamp=o||Mu.EMPTY_STRING,u.traceId=s||Mu.EMPTY_STRING,u.correlationId=a||Mu.EMPTY_STRING,u.claims=c||Mu.EMPTY_STRING,u.name="InteractionRequiredAuthError",u}return Tu(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&ad.indexOf(e)>-1,i=!!r&&cd.indexOf(r)>-1,o=!!t&&ad.some((function(e){return t.indexOf(e)>-1}));return n||o||i},t.createNoTokensFoundError=function(){return new t(ud.code,ud.desc)},t.createNativeAccountUnavailableError=function(){return new t(ld.code,ld.desc)},t}(ll),dd=function(e,t,r,n,i){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=i||null},pd=function(){function e(){}return e.setRequestState=function(t,r,n){var i=e.generateLibraryState(t,n);return oh.isEmpty(r)?i:""+i+Mu.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw ih.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw ih.createNoCryptoObjectError("parseRequestState");if(oh.isEmpty(t))throw ih.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(Mu.RESOURCE_DELIM),n=r[0],i=r.length>1?r.slice(1).join(Mu.RESOURCE_DELIM):Mu.EMPTY_STRING,o=e.base64Decode(n),s=JSON.parse(o);return{userRequestState:oh.isEmpty(i)?Mu.EMPTY_STRING:i,libraryState:s}}catch(e){throw ih.createInvalidStateError(t,e)}},e}(),fd=function(){function e(t){if(this._urlString=t,oh.isEmpty(this._urlString))throw Mh.createUrlEmptyError();oh.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return oh.endsWith(t,"?")?t=t.slice(0,-1):oh.endsWith(t,"?/")&&(t=t.slice(0,-2)),oh.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw Mh.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw Mh.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Mh.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return oh.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==Ru.COMMON&&n[0]!==Ru.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Mh.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!oh.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Mh.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===Mu.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):Mu.EMPTY_STRING},e.parseQueryString=function(e){var t=e.indexOf("?"),r=e.indexOf("/?");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):Mu.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(oh.isEmpty(t))return{};var r=e.parseHash(t),n=oh.queryStringToObject(oh.isEmpty(r)?t:r);if(!n)throw ih.createHashNotDeserializedError(JSON.stringify(n));return n},e.getDeserializedQueryString=function(t){if(oh.isEmpty(t))return{};var r=e.parseQueryString(t),n=oh.queryStringToObject(oh.isEmpty(r)?t:r);if(!n)throw ih.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(oh.isEmpty(t)||t.indexOf("=")<0)return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}();
/*! @azure/msal-common v13.1.0 2023-06-07 */!function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",e.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",e.BrokerHandhshake="brokerHandshake",e.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",e.AcquireTokenByBroker="acquireTokenByBroker",e.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",e.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",e.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",e.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",e.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",e.AcquireTokenFromCache="acquireTokenFromCache",e.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",e.InitializeBaseRequest="initializeBaseRequest",e.InitializeSilentRequest="initializeSilentRequest",e.InitializeClientApplication="initializeClientApplication",e.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",e.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",e.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",e.SilentHandlerLoadFrame="silentHandlerLoadFrame",e.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",e.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",e.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",e.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",e.GetAuthCodeUrl="getAuthCodeUrl",e.HandleCodeResponseFromServer="handleCodeResponseFromServer",e.HandleCodeResponseFromHash="handleCodeResponseFromHash",e.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",e.AuthClientAcquireToken="authClientAcquireToken",e.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",e.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",e.AuthClientCreateQueryString="authClientCreateQueryString",e.PopTokenGenerateCnf="popTokenGenerateCnf",e.PopTokenGenerateKid="popTokenGenerateKid",e.HandleServerTokenResponse="handleServerTokenResponse",e.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",e.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",e.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",e.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",e.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",e.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",e.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",e.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",e.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",e.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",e.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",e.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",e.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",e.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",e.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",e.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",e.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake"}(Jh||(Jh={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"}(Xh||(Xh={}));var gd,yd=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);
/*! @azure/msal-common v13.1.0 2023-06-07 */!function(e){e.SW="sw",e.UHW="uhw"}(gd||(gd={}));var md=function(){function e(e,t){this.cryptoUtils=e,this.performanceClient=t}return e.prototype.generateCnf=function(e){var t,r;return Cu(this,void 0,void 0,(function(){var n,i,o;return Eu(this,(function(s){switch(s.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.PopTokenGenerateCnf,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Jh.PopTokenGenerateKid,e.correlationId),[4,this.generateKid(e)];case 1:return n=s.sent(),i=this.cryptoUtils.base64Encode(JSON.stringify(n)),o={kid:n.kid,reqCnfString:i},[4,this.cryptoUtils.hashString(i)];case 2:return[2,(o.reqCnfHash=s.sent(),o)]}}))}))},e.prototype.generateKid=function(e){var t;return Cu(this,void 0,void 0,(function(){return Eu(this,(function(r){switch(r.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.PopTokenGenerateKid,e.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:r.sent(),xms_ksl:gd.SW}]}}))}))},e.prototype.signPopToken=function(e,t,r){return Cu(this,void 0,void 0,(function(){return Eu(this,(function(n){return[2,this.signPayload(e,t,r)]}))}))},e.prototype.signPayload=function(e,t,r,n){return Cu(this,void 0,void 0,(function(){var i,o,s,a,c,u;return Eu(this,(function(l){switch(l.label){case 0:return i=r.resourceRequestMethod,o=r.resourceRequestUri,s=r.shrClaims,a=r.shrNonce,c=o?new fd(o):void 0,u=null==c?void 0:c.getUrlComponents(),[4,this.cryptoUtils.signJwt(Iu({at:e,ts:id.nowSeconds(),m:null==i?void 0:i.toUpperCase(),u:null==u?void 0:u.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:null==u?void 0:u.AbsolutePath,q:(null==u?void 0:u.QueryString)?[[],u.QueryString]:void 0,client_claims:s||void 0},n),t,r.correlationId)];case 1:return[2,l.sent()]}}))}))},e}(),vd=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return["appmetadata",e,t].join(qu.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var i=new e;return i.clientId=t,i.environment=r,n&&(i.familyId=n),i},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf("appmetadata")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),bd=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),_d=function(){function e(e,t,r,n,i,o,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=i,this.persistencePlugin=o,this.performanceClient=s}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?ih.createStateNotFoundError("Cached State"):ih.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw ih.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(hd.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new hd(e.error||Mu.EMPTY_STRING,e.error_description,e.suberror,e.timestamp||Mu.EMPTY_STRING,e.trace_id||Mu.EMPTY_STRING,e.correlation_id||Mu.EMPTY_STRING,e.claims||Mu.EMPTY_STRING);throw new Qh(e.error||Mu.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Bh(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(hd.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new hd(e.error,e.error_description,e.suberror,e.timestamp||Mu.EMPTY_STRING,e.trace_id||Mu.EMPTY_STRING,e.correlation_id||Mu.EMPTY_STRING,e.claims||Mu.EMPTY_STRING);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Qh(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,i,o,s,a,c,u){var l;return Cu(this,void 0,void 0,(function(){var h,d,p,f,g,y;return Eu(this,(function(m){switch(m.label){case 0:if(null===(l=this.performanceClient)||void 0===l||l.addQueueMeasurement(Jh.HandleServerTokenResponse,t.correlation_id),t.id_token){if(h=new Lh(t.id_token||Mu.EMPTY_STRING,this.cryptoObj),o&&!oh.isEmpty(o.nonce)&&h.claims.nonce!==o.nonce)throw ih.createNonceMismatchError();if(i.maxAge||0===i.maxAge){if(!(d=h.claims.auth_time))throw ih.createAuthTimeNotFoundError();Lh.checkMaxAge(d,i.maxAge)}}this.homeAccountIdentifier=Uh.generateHomeAccountId(t.client_info||Mu.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,h),o&&o.state&&(p=pd.parseRequestState(this.cryptoObj,o.state)),t.key_id=t.key_id||i.sshKid||void 0,f=this.generateCacheRecord(t,r,n,i,h,s,o),m.label=1;case 1:return m.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new bd(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(g)]):[3,3];case 2:m.sent(),m.label=3;case 3:return!a||c||!f.account||(y=f.account.generateAccountKey(),this.cacheStorage.getAccount(y))?[4,this.cacheStorage.saveCacheRecord(f)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,f,!1,i,h,p,void 0,u)]);case 4:return m.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&g?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(g)]):[3,7];case 6:m.sent(),m.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,f,!1,i,h,p,t,u)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,i,o,s){var a,c,u=t.getPreferredCache();if(oh.isEmpty(u))throw ih.createInvalidCacheEnvironmentError();!oh.isEmpty(e.id_token)&&i&&(a=nd.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||Mu.EMPTY_STRING,this.clientId,i.claims.tid||Mu.EMPTY_STRING),c=this.generateAccountEntity(e,i,t,s));var l=null;if(!oh.isEmpty(e.access_token)){var h=e.scope?Ph.fromString(e.scope):new Ph(n.scopes||[]),d=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,p=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,f=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,g=r+d,y=g+p,m=f&&f>0?r+f:void 0;l=od.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||Mu.EMPTY_STRING,this.clientId,i?i.claims.tid||Mu.EMPTY_STRING:t.tenant,h.printScopes(),g,y,this.cryptoObj,m,e.token_type,o,e.key_id,n.claims,n.requestedClaimsHash)}var v=null;oh.isEmpty(e.refresh_token)||(v=sd.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||Mu.EMPTY_STRING,this.clientId,e.foci,o));var b=null;return oh.isEmpty(e.foci)||(b=vd.createAppMetadataEntity(this.clientId,u,e.foci)),new dd(c,a,l,v,b)},e.prototype.generateAccountEntity=function(e,t,r,n){var i=r.authorityType,o=n?n.cloud_graph_host_name:Mu.EMPTY_STRING,s=n?n.msgraph_host:Mu.EMPTY_STRING;if(i===ch.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Uh.createGenericAccount(this.homeAccountIdentifier,t,r,o,s);if(oh.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw ih.createClientInfoEmptyError();return e.client_info?Uh.createAccount(e.client_info,this.homeAccountIdentifier,t,r,o,s):Uh.createGenericAccount(this.homeAccountIdentifier,t,r,o,s)},e.generateAuthenticationResult=function(e,t,r,n,i,o,s,a,c){var u,l,h;return Cu(this,void 0,void 0,(function(){var d,p,f,g,y,m,v,b,_,w,T;return Eu(this,(function(I){switch(I.label){case 0:if(d=Mu.EMPTY_STRING,p=[],f=null,y=Mu.EMPTY_STRING,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==Yu.POP)return[3,2];if(m=new md(e),v=r.accessToken,b=v.secret,!(_=v.keyId))throw ih.createKeyIdMissingError();return[4,m.signPopToken(b,_,i)];case 1:return d=I.sent(),[3,3];case 2:d=r.accessToken.secret,I.label=3;case 3:p=Ph.fromString(r.accessToken.target).asArray(),f=new Date(1e3*Number(r.accessToken.expiresOn)),g=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),I.label=4;case 4:return r.appMetadata&&(y="1"===r.appMetadata.familyId?"1":Mu.EMPTY_STRING),w=(null==o?void 0:o.claims.oid)||(null==o?void 0:o.claims.sub)||Mu.EMPTY_STRING,T=(null==o?void 0:o.claims.tid)||Mu.EMPTY_STRING,(null==a?void 0:a.spa_accountid)&&r.account&&(r.account.nativeAccountId=null==a?void 0:a.spa_accountid),[2,{authority:t.canonicalAuthority,uniqueId:w,tenantId:T,scopes:p,account:r.account?r.account.getAccountInfo():null,idToken:o?o.rawToken:Mu.EMPTY_STRING,idTokenClaims:o?o.claims:{},accessToken:d,fromCache:n,expiresOn:f,correlationId:i.correlationId,requestId:c||Mu.EMPTY_STRING,extExpiresOn:g,familyId:y,tokenType:(null===(u=r.accessToken)||void 0===u?void 0:u.tokenType)||Mu.EMPTY_STRING,state:s?s.userRequestState:Mu.EMPTY_STRING,cloudGraphHostName:(null===(l=r.account)||void 0===l?void 0:l.cloudGraphHostName)||Mu.EMPTY_STRING,msGraphHost:(null===(h=r.account)||void 0===h?void 0:h.msGraphHost)||Mu.EMPTY_STRING,code:null==a?void 0:a.spa_code,fromNativeBroker:!1}]}}))}))},e}(),wd=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.includeRedirectUri=!0,n}return Tu(t,e),t.prototype.getAuthCodeUrl=function(e){var t,r;return Cu(this,void 0,void 0,(function(){var n;return Eu(this,(function(i){switch(i.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.GetAuthCodeUrl,e.correlationId),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Jh.AuthClientCreateQueryString,e.correlationId),[4,this.createAuthCodeUrlQueryString(e)];case 1:return n=i.sent(),[2,fd.appendQueryString(this.authority.authorizationEndpoint,n)]}}))}))},t.prototype.acquireToken=function(e,t){var r,n,i,o,s,a;return Cu(this,void 0,void 0,(function(){var c,u,l,h,d,p,f=this;return Eu(this,(function(g){switch(g.label){case 0:if(!e||!e.code)throw ih.createTokenRequestCannotBeMadeError();return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Jh.AuthClientAcquireToken,e.correlationId),c=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement("AuthCodeClientAcquireToken",e.correlationId),this.logger.info("in acquireToken call in auth-code client"),u=id.nowSeconds(),null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(Jh.AuthClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(this.authority,e)];case 1:return l=g.sent(),h=null===(o=l.headers)||void 0===o?void 0:o[Au.X_MS_REQUEST_ID],(d=null===(s=l.headers)||void 0===s?void 0:s[Au.X_MS_HTTP_VERSION])&&(null==c||c.addStaticFields({httpVerAuthority:d})),(p=new _d(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(l.body),null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(Jh.HandleServerTokenResponse,e.correlationId),[2,p.handleServerTokenResponse(l.body,this.authority,u,e,t,void 0,void 0,void 0,h).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw f.logger.verbose("Error in fetching token in ACC",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new _d(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new fd(e),i=fd.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(i,t,this.cryptoUtils),!i.code)throw ih.createNoAuthCodeInServerResponseError();return Iu(Iu({},i),{code:i.code})},t.prototype.getLogoutUri=function(e){if(!e)throw Mh.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return fd.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){var r,n;return Cu(this,void 0,void 0,(function(){var i,o,s,a,c,u,l;return Eu(this,(function(h){switch(h.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Jh.AuthClientExecuteTokenRequest,t.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Jh.AuthClientCreateTokenRequestBody,t.correlationId),i=this.createTokenQueryParameters(t),o=fd.appendQueryString(e.tokenEndpoint,i),[4,this.createTokenRequestBody(t)];case 1:if(s=h.sent(),a=void 0,t.clientInfo)try{c=Bh(t.clientInfo,this.cryptoUtils),a={credential:""+c.uid+qu.CLIENT_INFO_SEPARATOR+c.utid,type:Yh.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return u=this.createTokenRequestHeaders(a||t.ccsCredential),l={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(o,s,u,l)]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r;return Cu(this,void 0,void 0,(function(){var n,i,o,s,a,c,u,l;return Eu(this,(function(h){switch(h.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.AuthClientCreateTokenRequestBody,e.correlationId),(n=new ed).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):Zh.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(i=this.config.clientCredentials.clientAssertion,n.addClientAssertion(i.assertion),n.addClientAssertionType(i.assertionType)),n.addGrantType(xu.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme!==Yu.POP?[3,2]:(o=new md(this.cryptoUtils,this.performanceClient),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Jh.PopTokenGenerateCnf,e.correlationId),[4,o.generateCnf(e)]);case 1:return s=h.sent(),n.addPopToken(s.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Yu.SSH){if(!e.sshJwk)throw Mh.createMissingSshJwkError();n.addSshJwk(e.sshJwk)}h.label=3;case 3:if(a=e.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(a),(!oh.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),c=void 0,e.clientInfo)try{u=Bh(e.clientInfo,this.cryptoUtils),c={credential:""+u.uid+qu.CLIENT_INFO_SEPARATOR+u.utid,type:Yh.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else c=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case Yh.HOME_ACCOUNT_ID:try{u=Dh(c.credential),n.addCcsOid(u)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Yh.UPN:n.addCcsUpn(c.credential)}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Nu.RETURN_SPA_CODE]||n.addExtraQueryParameters(((l={})[Nu.RETURN_SPA_CODE]="1",l)),[2,n.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t;return Cu(this,void 0,void 0,(function(){var r,n,i,o,s,a,c;return Eu(this,(function(u){switch(u.label){case 0:if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.AuthClientCreateQueryString,e.correlationId),(r=new ed).addClientId(this.config.authOptions.clientId),n=Su(e.scopes||[],e.extraScopesToConsent||[]),r.addScopes(n),r.addRedirectUri(e.redirectUri),i=e.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(i),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==Uu.SELECT_ACCOUNT)if(e.sid&&e.prompt===Uu.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){if(o=this.extractAccountSid(e.account),s=this.extractLoginHint(e.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(s);try{a=Dh(e.account.homeAccountId),r.addCcsOid(a)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(o&&e.prompt===Uu.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(o);try{a=Dh(e.account.homeAccountId),r.addCcsOid(a)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{a=Dh(e.account.homeAccountId),r.addCcsOid(a)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(!oh.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&r.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker?(r.addNativeBroker(),e.authenticationScheme!==Yu.POP?[3,2]:[4,new md(this.cryptoUtils).generateCnf(e)]):[3,2];case 1:c=u.sent(),r.addPopToken(c.reqCnfString),u.label=2;case 2:return[2,r.createQueryString()]}}))}))},t.prototype.createLogoutUrlQueryString=function(e){var t=new ed;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null},t.prototype.extractLoginHint=function(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null},t}(td),Td=function(e){function t(t,r){return e.call(this,t,r)||this}return Tu(t,e),t.prototype.acquireToken=function(e){var t,r,n,i,o,s,a;return Cu(this,void 0,void 0,(function(){var c,u,l,h,d,p,f=this;return Eu(this,(function(g){switch(g.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.RefreshTokenClientAcquireToken,e.correlationId),c=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(Jh.RefreshTokenClientAcquireToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",e.correlationId),u=id.nowSeconds(),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Jh.RefreshTokenClientExecuteTokenRequest,e.correlationId),[4,this.executeTokenRequest(e,this.authority)];case 1:return l=g.sent(),h=null===(i=l.headers)||void 0===i?void 0:i[Au.X_MS_HTTP_VERSION],null==c||c.addStaticFields({refreshTokenSize:(null===(o=l.body.refresh_token)||void 0===o?void 0:o.length)||0}),h&&(null==c||c.addStaticFields({httpVerToken:h})),d=null===(s=l.headers)||void 0===s?void 0:s[Au.X_MS_REQUEST_ID],(p=new _d(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(l.body),null===(a=this.performanceClient)||void 0===a||a.setPreQueueTime(Jh.HandleServerTokenResponse,e.correlationId),[2,p.handleServerTokenResponse(l.body,this.authority,u,e,void 0,void 0,!0,e.forceCache,d).then((function(e){return null==c||c.endMeasurement({success:!0}),e})).catch((function(t){throw f.logger.verbose("Error in fetching refresh token",e.correlationId),null==c||c.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){var t,r,n,i;return Cu(this,void 0,void 0,(function(){var o,s;return Eu(this,(function(a){if(!e)throw Mh.createEmptyTokenRequestError();if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw ih.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Jh.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(t){if(o=t instanceof hd&&t.errorCode===ud.code,s=t instanceof Qh&&t.errorCode===ol&&t.subError===sl,o||s)return null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Jh.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw t}return null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(Jh.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){var r,n,i;return Cu(this,void 0,void 0,(function(){var o,s,a;return Eu(this,(function(c){if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Jh.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),o=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(Jh.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",e.correlationId),!(s=this.cacheManager.getRefreshToken(e.account,t)))throw null==o||o.discardMeasurement(),hd.createNoTokensFoundError();return null==o||o.endMeasurement({success:!0}),a=Iu(Iu({},e),{refreshToken:s.secret,authenticationScheme:e.authenticationScheme||Yu.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Yh.HOME_ACCOUNT_ID}}),null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(Jh.RefreshTokenClientAcquireToken,e.correlationId),[2,this.acquireToken(a)]}))}))},t.prototype.executeTokenRequest=function(e,t){var r,n,i;return Cu(this,void 0,void 0,(function(){var o,s,a,c,u,l;return Eu(this,(function(h){switch(h.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Jh.RefreshTokenClientExecuteTokenRequest,e.correlationId),o=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(Jh.RefreshTokenClientExecuteTokenRequest,e.correlationId),null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(Jh.RefreshTokenClientCreateTokenRequestBody,e.correlationId),s=this.createTokenQueryParameters(e),a=fd.appendQueryString(t.tokenEndpoint,s),[4,this.createTokenRequestBody(e)];case 1:return c=h.sent(),u=this.createTokenRequestHeaders(e.ccsCredential),l={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},[2,this.executePostToTokenEndpoint(a,c,u,l).then((function(e){return null==o||o.endMeasurement({success:!0}),e})).catch((function(e){throw null==o||o.endMeasurement({success:!1}),e}))]}}))}))},t.prototype.createTokenRequestBody=function(e){var t,r,n;return Cu(this,void 0,void 0,(function(){var i,o,s,a,c,u,l;return Eu(this,(function(h){switch(h.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.RefreshTokenClientCreateTokenRequestBody,e.correlationId),i=e.correlationId,o=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(Jh.BaseClientCreateTokenRequestHeaders,i),(s=new ed).addClientId(this.config.authOptions.clientId),s.addScopes(e.scopes),s.addGrantType(xu.REFRESH_TOKEN_GRANT),s.addClientInfo(),s.addLibraryInfo(this.config.libraryInfo),s.addApplicationTelemetry(this.config.telemetry.application),s.addThrottling(),this.serverTelemetryManager&&s.addServerTelemetry(this.serverTelemetryManager),s.addCorrelationId(i),s.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&s.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(a=this.config.clientCredentials.clientAssertion,s.addClientAssertion(a.assertion),s.addClientAssertionType(a.assertionType)),e.authenticationScheme!==Yu.POP?[3,2]:(c=new md(this.cryptoUtils,this.performanceClient),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Jh.PopTokenGenerateCnf,e.correlationId),[4,c.generateCnf(e)]);case 1:return u=h.sent(),s.addPopToken(u.reqCnfString),[3,3];case 2:if(e.authenticationScheme===Yu.SSH){if(!e.sshJwk)throw null==o||o.endMeasurement({success:!1}),Mh.createMissingSshJwkError();s.addSshJwk(e.sshJwk)}h.label=3;case 3:if((!oh.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Yh.HOME_ACCOUNT_ID:try{l=Dh(e.ccsCredential.credential),s.addCcsOid(l)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Yh.UPN:s.addCcsUpn(e.ccsCredential.credential)}return null==o||o.endMeasurement({success:!0}),[2,s.createQueryString()]}}))}))},t}(td),Id=function(e){function t(t,r){return e.call(this,t,r)||this}return Tu(t,e),t.prototype.acquireToken=function(e){return Cu(this,void 0,void 0,(function(){var t;return Eu(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof ih&&t.errorCode===Wl.code)return[2,new Td(this.config,this.performanceClient).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,n,i;return Cu(this,void 0,void 0,(function(){var o,s;return Eu(this,(function(a){switch(a.label){case 0:if(!e)throw Mh.createEmptyTokenRequestError();if(e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(Zu.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),ih.createRefreshRequiredError();if(!e.account)throw ih.createNoAccountInSilentRequestError();if(o=e.authority||this.authority.getPreferredCache(),!(s=this.cacheManager.readCacheRecord(e.account,e,o)).accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(Zu.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),ih.createRefreshRequiredError();if(id.wasClockTurnedBack(s.accessToken.cachedAt)||id.isTokenExpired(s.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(Zu.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),ih.createRefreshRequiredError();if(s.accessToken.refreshOn&&id.isTokenExpired(s.accessToken.refreshOn,0))throw null===(i=this.serverTelemetryManager)||void 0===i||i.setCacheOutcome(Zu.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),ih.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(s,e)];case 1:return[2,a.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return Cu(this,void 0,void 0,(function(){var r,n;return Eu(this,(function(i){switch(i.label){case 0:if(e.idToken&&(r=new Lh(e.idToken.secret,this.config.cryptoInterface)),t.maxAge||0===t.maxAge){if(!(n=null==r?void 0:r.claims.auth_time))throw ih.createAuthTimeNotFoundError();Lh.checkMaxAge(n,t.maxAge)}return[4,_d.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,i.sent()]}}))}))},t}(td);
/*! @azure/msal-common v13.1.0 2023-06-07 */
/*! @azure/msal-common v13.1.0 2023-06-07 */
function Cd(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}
/*! @azure/msal-common v13.1.0 2023-06-07 */var Ed,Sd={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},Ad={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};!function(e){e.AAD="AAD",e.OIDC="OIDC"}(Ed||(Ed={}));
/*! @azure/msal-common v13.1.0 2023-06-07 */
var kd=function(){function e(){this.expiresAt=id.nowSeconds()+ju}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=id.nowSeconds()+ju},e.prototype.isExpired=function(){return this.expiresAt<=id.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(Gu)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"))},e}();
/*! @azure/msal-common v13.1.0 2023-06-07 */
/*! @azure/msal-common v13.1.0 2023-06-07 */
var Rd,Nd,Od,Md,Pd,Bd,Dd,Ud,Ld,xd=function(){function e(e,t,r){this.networkInterface=e,this.performanceClient=t,this.correlationId=r}return e.prototype.detectRegion=function(t,r){var n,i,o,s;return Cu(this,void 0,void 0,(function(){var a,c,u,l,h;return Eu(this,(function(d){switch(d.label){case 0:if(null===(n=this.performanceClient)||void 0===n||n.addQueueMeasurement(Jh.RegionDiscoveryDetectRegion,this.correlationId),a=t)return[3,8];c=e.IMDS_OPTIONS,d.label=1;case 1:return d.trys.push([1,6,,7]),null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(Jh.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(Mu.IMDS_VERSION,c)];case 2:return(u=d.sent()).status===$u.httpSuccess&&(a=u.body,r.region_source=Ju.IMDS),u.status!==$u.httpBadRequest?[3,5]:(null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(Jh.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(c)]);case 3:return(l=d.sent())?(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(Jh.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(l,c)]):(r.region_source=Ju.FAILED_AUTO_DETECTION,[2,null]);case 4:(h=d.sent()).status===$u.httpSuccess&&(a=h.body,r.region_source=Ju.IMDS),d.label=5;case 5:return[3,7];case 6:return d.sent(),r.region_source=Ju.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:r.region_source=Ju.ENVIRONMENT_VARIABLE,d.label=9;case 9:return a||(r.region_source=Ju.FAILED_AUTO_DETECTION),[2,a||null]}}))}))},e.prototype.getRegionFromIMDS=function(e,t){var r;return Cu(this,void 0,void 0,(function(){return Eu(this,(function(n){return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Jh.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(Mu.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,Mu.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(e){var t;return Cu(this,void 0,void 0,(function(){var r;return Eu(this,(function(n){switch(n.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.RegionDiscoveryGetCurrentVersion,this.correlationId),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(Mu.IMDS_ENDPOINT+"?format=json",e)];case 2:return(r=n.sent()).status===$u.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?[2,r.body["newest-versions"][0]]:[2,null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),Fd=function(){function e(e,t,r,n,i,o,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=o,this.correlationId=s,this.regionDiscovery=new xd(t,this.performanceClient,this.correlationId)}return e.prototype.getAuthorityType=function(e){if(e.HostNameAndPort.endsWith(Mu.CIAM_AUTH_URL))return ch.Ciam;var t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case Mu.ADFS:return ch.Adfs;case Mu.DSTS:return ch.Dsts}return ch.Default},Object.defineProperty(e.prototype,"authorityType",{get:function(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new fd(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw ih.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw ih.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw ih.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ih.createLogoutNotSupportedError();return this.replacePath(this.metadata.end_session_endpoint)}throw ih.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw ih.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwksUri",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw ih.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.canReplaceTenant=function(t){return 1===t.PathSegments.length&&!e.reservedTenantDomains.has(t.PathSegments[0])&&this.getAuthorityType(t)===ch.Default&&this.protocolMode===Ed.AAD},e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=this,r=e,n=new fd(this.metadata.canonical_authority).getUrlComponents(),i=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,o){var s=i[o];if(0===o&&t.canReplaceTenant(n)){var a=new fd(t.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];s!==a&&(t.logger.verbose("Replacing tenant domain name "+s+" with id "+a),s=a)}e!==s&&(r=r.replace("/"+s+"/","/"+e+"/"))})),this.replaceTenant(r)},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===ch.Adfs||this.authorityType===ch.Dsts||this.protocolMode===Ed.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){var e,t,r;return Cu(this,void 0,void 0,(function(){var n,i,o,s;return Eu(this,(function(a){switch(a.label){case 0:return null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Jh.AuthorityResolveEndpointsAsync,this.correlationId),(n=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(n=new kd).updateCanonicalAuthority(this.canonicalAuthority),null===(t=this.performanceClient)||void 0===t||t.setPreQueueTime(Jh.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(n)];case 1:return i=a.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,n.preferred_network),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Jh.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(n)];case 2:return o=a.sent(),i!==Vu.CACHE&&o!==Vu.CACHE&&(n.resetExpiresAt(),n.updateCanonicalAuthority(this.canonicalAuthority)),s=this.cacheManager.generateAuthorityMetadataCacheKey(n.preferred_cache),this.cacheManager.setAuthorityMetadata(s,n),this.metadata=n,[2]}}))}))},e.prototype.updateEndpointMetadata=function(e){var t,r,n,i,o,s;return Cu(this,void 0,void 0,(function(){var a,c;return Eu(this,(function(u){switch(u.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.AuthorityUpdateEndpointMetadata,this.correlationId),(a=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(a,!1),[2,Vu.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,Vu.CACHE]:(null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Jh.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(a=u.sent())?(null===(n=this.authorityOptions.azureRegionConfiguration)||void 0===n?void 0:n.azureRegion)?(null===(i=this.performanceClient)||void 0===i||i.setPreQueueTime(Jh.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(a)]):[3,3]:[3,4];case 2:a=u.sent(),u.label=3;case 3:return e.updateEndpointMetadata(a,!0),[2,Vu.NETWORK];case 4:return!(c=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.azureRegion)?(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(Jh.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(c)]):[3,6];case 5:c=u.sent(),u.label=6;case 6:return e.updateEndpointMetadata(c,!1),[2,Vu.HARDCODED_VALUES];case 7:throw ih.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new fd(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Mh.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){var e;return Cu(this,void 0,void 0,(function(){var t,r;return Eu(this,(function(n){switch(n.label){case 0:null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(Jh.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),t={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return[2,Cd((r=n.sent()).body)?r.body:null];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))},e.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in Sd?Sd[this.canonicalAuthority]:null},e.prototype.updateMetadataWithRegionalInformation=function(t){var r,n,i,o,s,a,c;return Cu(this,void 0,void 0,(function(){var u,l;return Eu(this,(function(h){switch(h.label){case 0:return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(Jh.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),null===(n=this.performanceClient)||void 0===n||n.setPreQueueTime(Jh.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(i=this.authorityOptions.azureRegionConfiguration)||void 0===i?void 0:i.environmentRegion,this.regionDiscoveryMetadata)];case 1:return u=h.sent(),l=(null===(o=this.authorityOptions.azureRegionConfiguration)||void 0===o?void 0:o.azureRegion)===Mu.AZURE_REGION_AUTO_DISCOVER_FLAG?u:null===(s=this.authorityOptions.azureRegionConfiguration)||void 0===s?void 0:s.azureRegion,(null===(a=this.authorityOptions.azureRegionConfiguration)||void 0===a?void 0:a.azureRegion)===Mu.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=u?Xu.AUTO_DETECTION_REQUESTED_SUCCESSFUL:Xu.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=u?(null===(c=this.authorityOptions.azureRegionConfiguration)||void 0===c?void 0:c.azureRegion)===u?Xu.CONFIGURED_MATCHES_DETECTED:Xu.CONFIGURED_NOT_DETECTED:Xu.CONFIGURED_NO_AUTO_DETECTION,l?(this.regionDiscoveryMetadata.region_used=l,[2,e.replaceWithRegionalInformation(t,l)]):[2,t]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){var t,r;return Cu(this,void 0,void 0,(function(){var n,i,o;return Eu(this,(function(s){switch(s.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||Mu.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||Mu.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(e.canonical_authority||Mu.NOT_APPLICABLE)),(n=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),e.updateCloudDiscoveryMetadata(n,!1),[2,Vu.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),i=e.isExpired(),this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!i?(this.logger.verbose("Found metadata in the cache."),[2,Vu.CACHE]):(i&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(r=this.performanceClient)||void 0===r||r.setPreQueueTime(Jh.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(n=s.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),e.updateCloudDiscoveryMetadata(n,!0),[2,Vu.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(o=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(o,!1),[2,Vu.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),Mh.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===ch.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Mh.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return Cu(this,void 0,void 0,(function(){var r,n,i,o,s,a,c,u;return Eu(this,(function(l){switch(l.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(Jh.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),r=""+Mu.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",n={},i=null,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(r,n)];case 2:if(o=l.sent(),s=void 0,a=void 0,function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}
/*! @azure/msal-common v13.1.0 2023-06-07 */(o.body))s=o.body,a=s.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+s.tenant_discovery_endpoint);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(o.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+o.status),(s=o.body).error===Mu.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+s.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+s.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),i=e.getCloudDiscoveryMetadataFromNetworkResponse(a,this.hostnameAndPort),[3,4];case 3:return(c=l.sent())instanceof ll?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+c.errorCode+"\nError Description: "+c.errorMessage):(u=c,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+u.name+"\nError Description: "+u.message)),[2,null];case 4:return i||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),i=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,i]}}))}))},e.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in Ad?Ad[this.canonicalAuthority]:null},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return fd.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.generateAuthority=function(e,t){var r;if(t&&t.azureCloudInstance!==sh.None){var n=t.tenant?t.tenant:Mu.DEFAULT_COMMON_TENANT;r=t.azureCloudInstance+"/"+n+"/"}return r||e},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw ih.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return Mu.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var n=new fd(e);n.validateAsUri();var i=n.getUrlComponents(),o=t+"."+i.HostNameAndPort;this.isPublicCloudAuthority(i.HostNameAndPort)&&(o=t+"."+Mu.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=fd.constructAuthorityUriFromObject(Iu(Iu({},n.getUrlComponents()),{HostNameAndPort:o})).urlString;return r?s+"?"+r:s},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,Mu.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r)),t},e.transformCIAMAuthority=function(e){var t=e.endsWith(Mu.FORWARD_SLASH)?e:""+e+Mu.FORWARD_SLASH,r=new fd(e).getUrlComponents();0===r.PathSegments.length&&r.HostNameAndPort.endsWith(Mu.CIAM_AUTH_URL)&&(t=""+t+r.HostNameAndPort.split(".")[0]+Mu.AAD_TENANT_DOMAIN_SUFFIX);return t},e.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Ru.COMMON,Ru.CONSUMERS,Ru.ORGANIZATIONS]),e}(),qd=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,i,o,s,a){return Cu(this,void 0,void 0,(function(){var c,u,l;return Eu(this,(function(h){switch(h.label){case 0:null==s||s.addQueueMeasurement(Jh.AuthorityFactoryCreateDiscoveredInstance,a),c=Fd.transformCIAMAuthority(t),u=e.createInstance(c,r,n,i,o,s,a),h.label=1;case 1:return h.trys.push([1,3,,4]),null==s||s.setPreQueueTime(Jh.AuthorityResolveEndpointsAsync,a),[4,u.resolveEndpointsAsync()];case 2:return h.sent(),[2,u];case 3:throw l=h.sent(),ih.createEndpointDiscoveryIncompleteError(l);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n,i,o,s){if(oh.isEmpty(e))throw Mh.createUrlEmptyError();return new Fd(e,t,r,n,i,o,s)},e}(),Hd=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(Qu.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),Kd=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(nl));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),zd={sendGetRequestAsync:function(){return Promise.reject(ll.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(ll.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},Vd={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},Gd={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},jd=function(e){function t(r,n){var i=e.call(this,r,n)||this;return i.name="JoseHeaderError",Object.setPrototypeOf(i,t.prototype),i}return Tu(t,e),t.createMissingKidError=function(){return new t(Vd.code,Vd.desc)},t.createMissingAlgError=function(){return new t(Gd.code,Gd.desc)},t}(ll),Yd=function(){function e(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}return e.getShrHeaderString=function(t){if(!t.kid)throw jd.createMissingKidError();if(!t.alg)throw jd.createMissingAlgError();var r=new e({typ:t.typ||el.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(r)},e}(),Qd=function(){function e(e,t){this.cacheOutcome=Zu.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||Mu.EMPTY_STRING,this.wrapperVer=e.wrapperVer||Mu.EMPTY_STRING,this.telemetryCacheKey=Qu.CACHE_KEY+qu.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+Qu.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(Qu.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(Qu.VALUE_SEPARATOR);return[Qu.SCHEMA_VERSION,r,t].join(Qu.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(Qu.VALUE_SEPARATOR),i=t.errors.slice(0,r).join(Qu.VALUE_SEPARATOR),o=t.errors.length,s=[o,r<o?Qu.OVERFLOW_TRUE:Qu.OVERFLOW_FALSE].join(Qu.VALUE_SEPARATOR);return[Qu.SCHEMA_VERSION,t.cacheHits,n,i,s].join(Qu.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=Qu.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),oh.isEmpty(e.subError)?oh.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(Qu.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new Hd;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new Hd;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,i=e.errors.length;for(t=0;t<i;t++){var o=e.failedRequests[2*t]||Mu.EMPTY_STRING,s=e.failedRequests[2*t+1]||Mu.EMPTY_STRING,a=e.errors[t]||Mu.EMPTY_STRING;if(!((n+=o.toString().length+s.toString().length+a.length+3)<Qu.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||Mu.EMPTY_STRING),e.push(this.regionSource||Mu.EMPTY_STRING),e.push(this.regionOutcome||Mu.EMPTY_STRING),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),Wd=function(){function e(e,t,r,n,i,o){this.authority=t,this.libraryName=n,this.libraryVersion=i,this.applicationTelemetry=o,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return e.prototype.startPerformanceMeasurement=function(e,t){return{}},e.prototype.startPerformanceMeasuremeant=function(e,t){return{}},e.prototype.getIntFields=function(){return yd},e.prototype.getPreQueueTime=function(e,t){var r=this.preQueueTimeByCorrelationId.get(t);if(r){if(r.name===e)return r.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+e+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+t+", unable to add queue measurement")},e.prototype.calculateQueuedTime=function(e,t){return e<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+e),0):t<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+t),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e},e.prototype.addQueueMeasurement=function(e,t,r,n){if(t){if(0===r)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+e+" is "+r);else if(!r)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+e);var i={eventName:e,queueTime:r,manuallyCompleted:n},o=this.queueMeasurements.get(t);if(o)o.push(i),this.queueMeasurements.set(t,o);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+t+" to queue measurements");var s=[i];this.queueMeasurements.set(t,s)}this.preQueueTimeByCorrelationId.delete(t)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+e+", cannot add queue measurement")},e.prototype.startMeasurement=function(e,t){var r,n,i=this,o=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",o),this.logger.trace("PerformanceClient: Performance measurement started for "+e,o);var s=this.startPerformanceMeasuremeant(e,o);s.startMeasurement();var a={eventId:this.generateId(),status:Xh.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:o,appName:null===(r=this.applicationTelemetry)||void 0===r?void 0:r.appName,appVersion:null===(n=this.applicationTelemetry)||void 0===n?void 0:n.appVersion};return this.cacheEventByCorrelationId(a),{endMeasurement:function(e){return i.endMeasurement(Iu(Iu({},a),e),s)},discardMeasurement:function(){return i.discardMeasurements(a.correlationId)},addStaticFields:function(e){return i.addStaticFields(e,a.correlationId)},increment:function(e){return i.increment(e,a.correlationId)},measurement:s,event:a}},e.prototype.endMeasurement=function(e,t){var r,n,i=this,o=this.eventsByCorrelationId.get(e.correlationId);if(!o)return this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId),null;var s=e.eventId===o.eventId,a={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};s?(a=this.getQueueInfo(e.correlationId),this.discardCache(o.correlationId)):null===(r=o.incompleteSubMeasurements)||void 0===r||r.delete(e.eventId),null==t||t.endMeasurement();var c=null==t?void 0:t.flushMeasurement();if(!c)return this.logger.trace("PerformanceClient: Performance measurement not taken",o.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+c+" ms",e.correlationId),!s)return o[e.name+"DurationMs"]=Math.floor(c),Iu({},o);var u=Iu(Iu({},o),e),l=0;return null===(n=u.incompleteSubMeasurements)||void 0===n||n.forEach((function(t){i.logger.trace("PerformanceClient: Incomplete submeasurement "+t.name+" found for "+e.name,u.correlationId),l++})),u.incompleteSubMeasurements=void 0,u=Iu(Iu({},u),{durationMs:Math.round(c),queuedTimeMs:a.totalQueueTime,queuedCount:a.totalQueueCount,queuedManuallyCompletedCount:a.manuallyCompletedCount,status:Xh.Completed,incompleteSubsCount:l}),this.truncateIntegralFields(u,this.getIntFields()),this.emitEvents([u],e.correlationId),u},e.prototype.addStaticFields=function(e,t){this.logger.trace("PerformanceClient: Updating static fields");var r=this.eventsByCorrelationId.get(t);r?this.eventsByCorrelationId.set(t,Iu(Iu({},r),e)):this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.increment=function(e,t){this.logger.trace("PerformanceClient: Updating counters");var r=this.eventsByCorrelationId.get(t);if(r)for(var n in e)r.hasOwnProperty(n)||(r[n]=0),r[n]+=e[n];else this.logger.trace("PerformanceClient: Event not found for",t)},e.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,Iu({},e)))},e.prototype.getQueueInfo=function(e){var t=this.queueMeasurements.get(e);t||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+e);var r=0,n=0,i=0;return null==t||t.forEach((function(e){r+=e.queueTime,n++,i+=e.manuallyCompleted?1:0})),{totalQueueTime:r,totalQueueCount:n,manuallyCompletedCount:i}},e.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},e.prototype.discardCache=function(e){this.discardMeasurements(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e)},e.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},e.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return t?this.logger.verbose("PerformanceClient: Performance callback "+e+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+e+" not removed."),t},e.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((function(n,i){r.logger.trace("PerformanceClient: Emitting event to callback "+i,t),n.apply(null,[e])}))},e.prototype.truncateIntegralFields=function(e,t){t.forEach((function(t){t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))}))},e}(),$d=function(){function e(){}return e.prototype.startMeasurement=function(){},e.prototype.endMeasurement=function(){},e.prototype.flushMeasurement=function(){return null},e}(),Jd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tu(t,e),t.prototype.generateId=function(){return"callback-id"},t.prototype.startPerformanceMeasuremeant=function(){return new $d},t.prototype.startPerformanceMeasurement=function(){return new $d},t.prototype.calculateQueuedTime=function(e,t){return 0},t.prototype.addQueueMeasurement=function(e,t,r){},t.prototype.setPreQueueTime=function(e,t){},t}(Wd),Xd={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},Zd={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},ep={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},tp={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},rp={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},np={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},ip={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},op={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},sp={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},ap={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},cp={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},up={code:"empty_window_error",desc:"window.open returned null or undefined window object."},lp={code:"user_cancelled",desc:"User cancelled the flow."},hp={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},dp={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},pp={code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},fp={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},gp={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},yp={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},mp={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},vp={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},bp={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},_p={code:"no_token_request_cache_error",desc:"No token request found in cache."},wp={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},Tp={code:"no_cached_authority_error",desc:"No cached authority found."},Ip={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},Cp={code:"invalid_cache_type",desc:"Invalid cache type"},Ep={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},Sp={code:"database_not_open",desc:"Database is not open!"},Ap={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},kp={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},Rp={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},Np={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},Op={code:"unable_to_load_token",desc:"Error loading token to cache."},Mp={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},Pp={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},Bp={code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},Dp={code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},Up={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},Lp={code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},xp={code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},Fp={code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},qp={code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},Hp={code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},Kp={code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."},zp=function(e){function t(r,n){var i=e.call(this,r,n)||this;return Object.setPrototypeOf(i,t.prototype),i.name="BrowserAuthError",i}return fu(t,e),t.createPkceNotGeneratedError=function(e){return new t(Xd.code,Xd.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(Zd.code,Zd.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(ep.code,ep.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(tp.code,tp.desc)},t.createEmptyHashError=function(e){return new t(rp.code,rp.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(np.code,np.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(ip.code,ip.desc)},t.createUnableToParseStateError=function(){return new t(op.code,op.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(sp.code,sp.desc)},t.createInteractionInProgressError=function(){return new t(ap.code,ap.desc)},t.createPopupWindowError=function(e){var r=cp.desc;return r=oh.isEmpty(e)?r:r+" Details: "+e,new t(cp.code,r)},t.createEmptyWindowCreatedError=function(){return new t(up.code,up.desc)},t.createUserCancelledError=function(){return new t(lp.code,lp.desc)},t.createMonitorPopupTimeoutError=function(){return new t(hp.code,hp.desc)},t.createMonitorIframeTimeoutError=function(){return new t(dp.code,dp.desc)},t.createRedirectInIframeError=function(e){return new t(pp.code,pp.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(fp.code,fp.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(gp.code,gp.desc)},t.createIframeClosedPrematurelyError=function(){return new t(yp.code,yp.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(mp.code,mp.desc)},t.createNoAccountError=function(){return new t(vp.code,vp.desc)},t.createSilentPromptValueError=function(e){return new t(bp.code,bp.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(wp.code,wp.desc)},t.createNoTokenRequestCacheError=function(){return new t(_p.code,_p.desc)},t.createAuthRequestNotSetError=function(){return new t(Ip.code,Ip.desc)},t.createNoCachedAuthorityError=function(){return new t(Tp.code,Tp.desc)},t.createInvalidCacheTypeError=function(){return new t(Cp.code,""+Cp.desc)},t.createNonBrowserEnvironmentError=function(){return new t(Ep.code,Ep.desc)},t.createDatabaseNotOpenError=function(){return new t(Sp.code,Sp.desc)},t.createNoNetworkConnectivityError=function(){return new t(Ap.code,Ap.desc)},t.createPostRequestFailedError=function(e,r){return new t(kp.code,kp.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t(Rp.code,Rp.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(Np.code,Np.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(Op.code,Op.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(Mp.code,Mp.desc+" | No match found for KeyId: "+e)},t.createAuthCodeRequiredError=function(){return new t(Pp.code,Pp.desc)},t.createAuthCodeOrNativeAccountIdRequiredError=function(){return new t(Bp.code,Bp.desc)},t.createSpaCodeAndNativeAccountIdPresentError=function(){return new t(Dp.code,Dp.desc)},t.createDatabaseUnavailableError=function(){return new t(Up.code,Up.desc)},t.createUnableToAcquireTokenFromNativePlatformError=function(){return new t(Lp.code,Lp.desc)},t.createNativeHandshakeTimeoutError=function(){return new t(xp.code,xp.desc)},t.createNativeExtensionNotInstalledError=function(){return new t(Fp.code,Fp.desc)},t.createNativeConnectionNotEstablishedError=function(){return new t(qp.code,qp.desc)},t.createNativeBrokerCalledBeforeInitialize=function(){return new t(Hp.code,Hp.desc)},t.createNativePromptParameterNotSupportedError=function(){return new t(Kp.code,Kp.desc)},t}(ll),Vp="invalid_grant",Gp=483,jp=600,Yp="msal",Qp=30,Wp="msal.js.browser",$p="53ee284d-920a-4b59-9d30-a60315b26836",Jp="ppnbnpeolgkicgegkbkbjmhlideopiji",Xp="MATS";
/*! @azure/msal-common v13.1.0 2023-06-07 */!function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"}(Rd||(Rd={})),function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(Nd||(Nd={})),function(e){e.GET="GET",e.POST="POST"}(Od||(Od={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native",e.REDIRECT_CONTEXT="request.redirect.context"}(Md||(Md={})),function(e){e.ACCOUNT_KEYS="msal.account.keys",e.TOKEN_KEYS="msal.token.keys"}(Pd||(Pd={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(Bd||(Bd={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(Dd||(Dd={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Ud||(Ud={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(Ld||(Ld={}));var Zp,ef={scopes:Pu};!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(Zp||(Zp={}));var tf;!function(e){e[e.Default=0]="Default",e[e.AccessToken=1]="AccessToken",e[e.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",e[e.RefreshToken=3]="RefreshToken",e[e.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",e[e.Skip=5]="Skip"}(tf||(tf={}));
/*! @azure/msal-browser v2.37.1 2023-06-07 */
var rf,nf,of={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},sf={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},af={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},cf={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},uf={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},lf={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},hf={code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."},df=function(e){function t(r,n){var i=e.call(this,r,n)||this;return i.name="BrowserConfigurationAuthError",Object.setPrototypeOf(i,t.prototype),i}return fu(t,e),t.createRedirectUriEmptyError=function(){return new t(of.code,of.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(sf.code,sf.desc)},t.createStorageNotSupportedError=function(e){return new t(af.code,af.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(cf.code,cf.desc)},t.createStubPcaInstanceCalledError=function(){return new t(uf.code,uf.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(lf.code,lf.desc)},t.createEntropyNotProvided=function(){return new t(hf.code,hf.desc)},t}(ll),pf=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==Nd.LocalStorage&&e!==Nd.SessionStorage)throw df.createStorageNotSupportedError(e);if(!!!window[e])throw df.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),ff=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),gf=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(oh.isEmpty(t))return null;try{return pd.parseRequestState(e,t).libraryState.meta}catch(e){throw ih.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new fd(e);return fd.getDeserializedHash(t.getHash())},e}(),yf=function(e){function t(t,r,n,i){var o=e.call(this,t,n,i)||this;return o.COOKIE_LIFE_MULTIPLIER=864e5,o.cacheConfig=r,o.logger=i,o.internalStorage=new ff,o.browserStorage=o.setupBrowserStorage(o.cacheConfig.cacheLocation),o.temporaryCacheStorage=o.setupTemporaryCacheStorage(o.cacheConfig.temporaryCacheLocation,o.cacheConfig.cacheLocation),r.cacheMigrationEnabled&&(o.migrateCacheEntries(),o.createKeyMaps()),o}return fu(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case Nd.LocalStorage:case Nd.SessionStorage:try{return new pf(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=Nd.MemoryStorage,new ff},t.prototype.setupTemporaryCacheStorage=function(e,t){switch(t){case Nd.LocalStorage:case Nd.SessionStorage:try{return new pf(e||Nd.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case Nd.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=Mu.CACHE_PREFIX+"."+ku.ID_TOKEN,r=Mu.CACHE_PREFIX+"."+ku.CLIENT_INFO,n=Mu.CACHE_PREFIX+"."+ku.ERROR,i=Mu.CACHE_PREFIX+"."+ku.ERROR_DESC,o=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(i)];[ku.ID_TOKEN,ku.CLIENT_INFO,ku.ERROR,ku.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,o[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.createKeyMaps=function(){var e=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var t=this.getItem(Pd.ACCOUNT_KEYS),r=this.getItem(Pd.TOKEN_KEYS+"."+this.clientId);t&&r?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(t){var r;if(e.isCredentialKey(t)&&(r=e.getItem(t))){var n=e.validateAndParseJson(r);if(n&&n.hasOwnProperty("credentialType"))switch(n.credentialType){case Hu.ID_TOKEN:if(nd.isIdTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+t+" found, saving key to token key map");var i=xh.toObject(new nd,n),o=e.updateCredentialCacheKey(t,i);return void e.addTokenKey(o,Hu.ID_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+t);break;case Hu.ACCESS_TOKEN:case Hu.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(od.isAccessTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+t+" found, saving key to token key map");var s=xh.toObject(new od,n);o=e.updateCredentialCacheKey(t,s);return void e.addTokenKey(o,Hu.ACCESS_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+t);break;case Hu.REFRESH_TOKEN:if(sd.isRefreshTokenEntity(n)){e.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+t+" found, saving key to token key map");var a=xh.toObject(new sd,n);o=e.updateCredentialCacheKey(t,a);return void e.addTokenKey(o,Hu.REFRESH_TOKEN)}e.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),e.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+t)}}if(e.isAccountKey(t)&&(r=e.getItem(t))){var c=e.validateAndParseJson(r);c&&Uh.isAccountEntity(c)&&(e.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),e.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+t+" found, saving key to account key map"),e.addAccountKeyToMap(t))}}))},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){this.logger.trace("BrowserCacheManager.getAccount called");var t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;var r=this.validateAndParseJson(t);return r&&Uh.isAccountEntity(r)?xh.toObject(new Uh,r):(this.removeAccountKeyFromMap(e),null)},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)},t.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var e=this.getItem(Pd.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},t.prototype.addAccountKeyToMap=function(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+e);var t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(Pd.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},t.prototype.removeAccountKeyFromMap=function(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+e);var t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.setItem(Pd.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},t.prototype.removeAccount=function(t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){return e.prototype.removeAccount.call(this,t),this.removeAccountKeyFromMap(t),[2]}))}))},t.prototype.removeIdToken=function(t){e.prototype.removeIdToken.call(this,t),this.removeTokenKey(t,Hu.ID_TOKEN)},t.prototype.removeAccessToken=function(t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){return e.prototype.removeAccessToken.call(this,t),this.removeTokenKey(t,Hu.ACCESS_TOKEN),[2]}))}))},t.prototype.removeRefreshToken=function(t){e.prototype.removeRefreshToken.call(this,t),this.removeTokenKey(t,Hu.REFRESH_TOKEN)},t.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var e=this.getItem(Pd.TOKEN_KEYS+"."+this.clientId);if(e){var t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},t.prototype.addTokenKey=function(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");var r=this.getTokenKeys();switch(t){case Hu.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case Hu.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case Hu.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+t),ih.createUnexpectedCredentialTypeError()}this.setItem(Pd.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.removeTokenKey=function(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");var r=this.getTokenKeys();switch(t){case Hu.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+e+" from map");var n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case Hu.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+e+" from map");var i=r.accessToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case Hu.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+e+" from map");var o=r.refreshToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+t),ih.createUnexpectedCredentialTypeError()}this.setItem(Pd.TOKEN_KEYS+"."+this.clientId,JSON.stringify(r))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hu.ID_TOKEN),null;var r=this.validateAndParseJson(t);return r&&nd.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),xh.toObject(new nd,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hu.ID_TOKEN),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Hu.ID_TOKEN)},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hu.ACCESS_TOKEN),null;var r=this.validateAndParseJson(t);return r&&od.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),xh.toObject(new od,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hu.ACCESS_TOKEN),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Hu.ACCESS_TOKEN)},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hu.REFRESH_TOKEN),null;var r=this.validateAndParseJson(t);return r&&sd.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),xh.toObject(new sd,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Hu.REFRESH_TOKEN),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Hu.REFRESH_TOKEN)},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&vd.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),xh.toObject(new vd,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Hd.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),xh.toObject(new Hd,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&kd.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),xh.toObject(new kd,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(Bd.WRAPPER_SKU,e),this.internalStorage.setItem(Bd.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Bd.WRAPPER_SKU)||Mu.EMPTY_STRING,this.internalStorage.getItem(Bd.WRAPPER_VER)||Mu.EMPTY_STRING]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(ku.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var r=this.generateCacheKey(ku.ACTIVE_ACCOUNT),n=this.getItem(r);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var i=this.getAccountInfoByFilter({localAccountId:n})[0]||null;return i?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(i),i):null}var o=this.validateAndParseJson(t);return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:o.homeAccountId,localAccountId:o.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(ku.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(ku.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");var n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId};this.browserStorage.setItem(t,JSON.stringify(n)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)},t.prototype.getAccountInfoByFilter=function(e){var t=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+t.length+" accounts found"),t.filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},t.prototype.getAccountInfoByHints=function(e,t){var r=this.getAllAccounts().filter((function(r){if(t){var n=r.idTokenClaims&&r.idTokenClaims.sid;return t===n}return!!e&&e===r.username}));if(1===r.length)return r[0];if(r.length>1)throw ih.createMultipleMatchingAccountsInCacheError();return null},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Kd.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),xh.toObject(new Kd,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var i=this.temporaryCacheStorage.getItem(r);if(!i){if(this.cacheConfig.cacheLocation===Nd.LocalStorage){var o=this.browserStorage.getItem(r);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),o}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},t.prototype.removeItem=function(e){this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return _u(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return mu(this,void 0,void 0,(function(){var e=this;return vu(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(Mu.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;SameSite=Lax;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return Mu.EMPTY_STRING},t.prototype.clearMsalCookies=function(){var e=this,t=Mu.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,Mu.EMPTY_STRING,-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):oh.startsWith(e,Mu.CACHE_PREFIX)||oh.startsWith(e,ku.ADAL_ID_TOKEN)?e:Mu.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=pd.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Md.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=pd.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Md.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=pd.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Md.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r,n,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var o=this.generateStateKey(e);this.setTemporaryCache(o,e,!1);var s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);var a=this.generateAuthorityKey(e);if(this.setTemporaryCache(a,r,!1),i){var c={credential:i.homeAccountId,type:Yh.HOME_ACCOUNT_ID};this.setTemporaryCache(Md.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(!oh.isEmpty(n)){c={credential:n,type:Yh.UPN};this.setTemporaryCache(Md.CCS_CREDENTIAL,JSON.stringify(c),!0)}},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),oh.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(Md.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Md.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Md.URL_HASH)),this.removeItem(this.generateCacheKey(Md.CORRELATION_ID)),this.removeItem(this.generateCacheKey(Md.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(Md.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||Mu.EMPTY_STRING)}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(Md.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var i=gf.extractBrowserRequestState(t.cryptoImpl,n);i&&i.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(Md.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(Md.REQUEST_PARAMS,!0);if(!r)throw zp.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw zp.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(Md.REQUEST_PARAMS)),oh.isEmpty(n.authority)){var i=this.generateAuthorityKey(e),o=this.getTemporaryCache(i);if(!o)throw zp.createNoCachedAuthorityError();n.authority=o}return n},t.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var e=this.getTemporaryCache(Md.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=Mu.CACHE_PREFIX+"."+Md.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=Mu.CACHE_PREFIX+"."+Md.INTERACTION_STATUS_KEY;if(e){if(this.getInteractionInProgress())throw zp.createInteractionInProgressError();this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(ku.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(ku.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(ku.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(ku.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var n=new Lh(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(e,t){var r=t.generateCredentialKey();if(e!==r){var n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose("Updated an outdated "+t.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+t.credentialType+" cache key but no item matching the outdated key was found in storage")}return e},t.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(Md.REDIRECT_CONTEXT,!0)},t.prototype.setRedirectRequestContext=function(e){this.setTemporaryCache(Md.REDIRECT_CONTEXT,e,!0)},t}(xh),mf="@azure/msal-browser",vf=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return mu(this,void 0,void 0,(function(){var r,n,i;return vu(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,fetch(e,{method:Od.GET,headers:this.getFetchHeaders(t)})];case 1:return r=o.sent(),[3,3];case 2:throw n=o.sent(),window.navigator.onLine?zp.createGetRequestFailedError(n,e):zp.createNoNetworkConnectivityError();case 3:return o.trys.push([3,5,,6]),i={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(i.body=o.sent(),i.status=r.status,i)];case 5:throw o.sent(),zp.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return mu(this,void 0,void 0,(function(){var r,n,i,o;return vu(this,(function(s){switch(s.label){case 0:r=t&&t.body||Mu.EMPTY_STRING,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(e,{method:Od.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=s.sent(),[3,4];case 3:throw i=s.sent(),window.navigator.onLine?zp.createPostRequestFailedError(i,e):zp.createNoNetworkConnectivityError();case 4:return s.trys.push([4,6,,7]),o={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(o.body=s.sent(),o.status=n.status,o)];case 6:throw s.sent(),zp.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),bf=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){return[2,this.sendRequestAsync(e,Od.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){return[2,this.sendRequestAsync(e,Od.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(i,o){var s=new XMLHttpRequest;if(s.open(t,e,!0),n.setXhrHeaders(s,r),s.onload=function(){(s.status<200||s.status>=300)&&(t===Od.POST?o(zp.createPostRequestFailedError("Failed with status "+s.status,e)):o(zp.createGetRequestFailedError("Failed with status "+s.status,e)));try{var r=JSON.parse(s.responseText),a={headers:n.getHeaderDict(s),body:r,status:s.status};i(a)}catch(t){o(zp.createFailedToParseNetworkResponseError(e))}},s.onerror=function(){window.navigator.onLine?t===Od.POST?o(zp.createPostRequestFailedError("Failed with status "+s.status,e)):o(zp.createGetRequestFailedError("Failed with status "+s.status,e)):o(zp.createNoNetworkConnectivityError())},t===Od.POST&&r&&r.body)s.send(r.body);else{if(t!==Od.GET)throw zp.createHttpMethodNotImplementedError(t);s.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),i=t.join(": ");n&&i&&(r[n]=i)})),r},e}(),_f=function(){function e(){}return e.clearHash=function(e){e.location.hash=Mu.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,Mu.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):Mu.EMPTY_STRING},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(Yp+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new fd(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new vf:new bf},e.blockReloadInHiddenIframes=function(){if(fd.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw zp.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===Ud.Redirect&&n&&!r)throw zp.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw zp.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw zp.createNonBrowserEnvironmentError()},e.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw zp.createNativeBrokerCalledBeforeInitialize()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),wf=function(){function e(e,t,r,n,i,o,s,a,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=o,this.nativeMessageHandler=a,this.correlationId=c||this.browserCrypto.createNewGuid(),this.logger=n.clone(Wp,"2.37.1",this.correlationId),this.performanceClient=s}return e.prototype.clearCacheOnLogout=function(e){return mu(this,void 0,void 0,(function(){return vu(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];Uh.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Uh.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e,t){return mu(this,void 0,void 0,(function(){var r,n,i,o;return vu(this,(function(s){switch(s.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.InitializeBaseRequest,e.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),r=e.authority||this.config.auth.authority,t?[4,this.validateRequestAuthority(r,t)]:[3,2];case 1:s.sent(),s.label=2;case 2:if(n=_u(e&&e.scopes||[]),(i=gu(gu({},e),{correlationId:this.correlationId,authority:r,scopes:n})).authenticationScheme){if(i.authenticationScheme===Yu.SSH){if(!e.sshJwk)throw Mh.createMissingSshJwkError();if(!e.sshKid)throw Mh.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+i.authenticationScheme+'" as configured in Auth request')}else i.authenticationScheme=Yu.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return!e.claims||oh.isEmpty(e.claims)?[3,4]:(o=i,[4,this.browserCrypto.hashString(e.claims)]);case 3:o.requestedClaimsHash=s.sent(),s.label=4;case 4:return[2,i]}}))}))},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||_f.getCurrentUri();return fd.getAbsoluteUrl(t,_f.getCurrentUri())},e.prototype.validateRequestAuthority=function(e,t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){switch(r.label){case 0:return[4,this.getDiscoveredAuthority(e)];case 1:if(!r.sent().isAlias(t.environment))throw Mh.createAuthorityMismatchError();return[2]}}))}))},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Qd(r,this.browserStorage)},e.prototype.getDiscoveredAuthority=function(e){return mu(this,void 0,void 0,(function(){var t;return vu(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,qd.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)]):[3,2];case 1:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,qd.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger)];case 3:return[2,r.sent()]}}))}))},e}(),Tf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fu(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return mu(this,void 0,void 0,(function(){var t,r;return vu(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=gu(gu({},e),{redirectUri:e.redirectUri,code:Mu.EMPTY_STRING,codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=Mu.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId);var t=gu({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){var r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=fd.getAbsoluteUrl(e.postLogoutRedirectUri,_f.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=fd.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,_f.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=fd.getAbsoluteUrl(_f.getCurrentUri(),_f.getCurrentUri())),t},t.prototype.getLogoutHintFromIdTokenClaims=function(e){var t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(e,t,r){return mu(this,void 0,void 0,(function(){var n;return vu(this,(function(i){switch(i.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=i.sent(),[2,new wd(n,this.performanceClient)]}}))}))},t.prototype.getClientConfiguration=function(e,t,r){return mu(this,void 0,void 0,(function(){var n,i;return vu(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(t,r)];case 1:return n=o.sent(),i=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:i.loggerCallback,piiLoggingEnabled:i.piiLoggingEnabled,logLevel:i.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Wp,version:"2.37.1",cpu:Mu.EMPTY_STRING,os:Mu.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){if(this.logger.verbose("validateAndExtractStateFromHash called",r),!e.state)throw zp.createHashDoesNotContainStateError();var n=gf.extractBrowserRequestState(this.browserCrypto,e.state);if(!n)throw zp.createUnableToParseStateError();if(n.interactionType!==t)throw zp.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),e.state},t.prototype.getDiscoveredAuthority=function(e,t){var r;return mu(this,void 0,void 0,(function(){var n,i,o,s;return vu(this,(function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(Jh.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e||this.config.auth.authority,s=Fd.generateAuthority(o,t||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(Jh.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,qd.createDiscoveredInstance(s,this.config.system.networkClient,this.browserStorage,i,this.logger,this.performanceClient,this.correlationId).then((function(e){return n.endMeasurement({success:!0}),e})).catch((function(e){throw n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))];case 1:return[2,a.sent()]}}))}))},t.prototype.initializeAuthorizationRequest=function(e,t){return mu(this,void 0,void 0,(function(){var r,n,i,o,s,a,c;return vu(this,(function(u){switch(u.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),r=this.getRedirectUri(e.redirectUri),n={interactionType:t},i=pd.setRequestState(this.browserCrypto,e&&e.state||Mu.EMPTY_STRING,n),this.performanceClient.setPreQueueTime(Jh.InitializeBaseRequest,this.correlationId),s=[{}],[4,this.initializeBaseRequest(e)];case 1:return o=gu.apply(void 0,[gu.apply(void 0,s.concat([u.sent()])),{redirectUri:r,state:i,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:Lu.FRAGMENT}]),(a=e.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+a.homeAccountId,this.correlationId),o.account=a),oh.isEmpty(o.loginHint)&&!a&&(c=this.browserStorage.getLegacyLoginHint())&&(o.loginHint=c),[2,o]}}))}))},t}(wf),If=function(){function e(e,t,r,n,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=i}return e.prototype.handleCodeResponseFromHash=function(e,t,r,n){return mu(this,void 0,void 0,(function(){var i,o,s;return vu(this,(function(a){if(this.performanceClient.addQueueMeasurement(Jh.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),oh.isEmpty(e))throw zp.createEmptyHashError(e);if(i=this.browserStorage.generateStateKey(t),!(o=this.browserStorage.getTemporaryCache(i)))throw ih.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,o)}catch(e){throw e instanceof Qh&&e.subError===lp.code?zp.createUserCancelledError():e}return this.performanceClient.setPreQueueTime(Jh.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(s,t,r,n)]}))}))},e.prototype.handleCodeResponseFromServer=function(e,t,r,n,i){return void 0===i&&(i=!0),mu(this,void 0,void 0,(function(){var o,s,a,c,u,l;return vu(this,(function(h){switch(h.label){case 0:if(this.performanceClient.addQueueMeasurement(Jh.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),o=this.browserStorage.generateStateKey(t),!(s=this.browserStorage.getTemporaryCache(o)))throw ih.createStateNotFoundError("Cached State");return a=this.browserStorage.generateNonceKey(s),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(Jh.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,n)]):[3,2];case 1:h.sent(),h.label=2;case 2:return i&&(e.nonce=c||void 0),e.state=s,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),this.performanceClient.setPreQueueTime(Jh.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return l=h.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return mu(this,void 0,void 0,(function(){var n,i;return vu(this,(function(o){switch(o.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),n="https://"+e+"/"+t.tenant+"/",[4,qd.createDiscoveredInstance(n,r,this.browserStorage,t.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return i=o.sent(),this.authModule.updateAuthority(i),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(Md.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),Cf=function(e){function t(t,r,n,i,o,s){var a=e.call(this,t,r,n,i,s)||this;return a.browserCrypto=o,a}return fu(t,e),t.prototype.initiateAuthRequest=function(e,t){return mu(this,void 0,void 0,(function(){var r;return vu(this,(function(n){switch(n.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),oh.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Md.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Md.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:Dd.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:return n.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 5:return n.sent(),[2];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),zp.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponseFromHash=function(e,t,r,n){return mu(this,void 0,void 0,(function(){var i,o,s,a,c,u,l;return vu(this,(function(h){switch(h.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),oh.isEmpty(e))throw zp.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),i=this.browserStorage.generateStateKey(t),!(o=this.browserStorage.getTemporaryCache(i)))throw ih.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(e,o)}catch(e){throw e instanceof Qh&&e.subError===lp.code?zp.createUserCancelledError():e}return a=this.browserStorage.generateNonceKey(o),c=this.browserStorage.getTemporaryCache(a),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,r,n)]:[3,2];case 1:h.sent(),h.label=2;case 2:return s.nonce=c||void 0,s.state=o,s.client_info?this.authCodeRequest.clientInfo=s.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return l=h.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},t}(If);!function(e){e.INITIALIZE_START="msal:initializeStart",e.INITIALIZE_END="msal:initializeEnd",e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd",e.RESTORE_FROM_BFCACHE="msal:restoreFromBFCache"}(rf||(rf={})),function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(nf||(nf={}));var Ef={code:"ContentError"},Sf={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},Af={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},kf=function(e){function t(r,n,i){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="NativeAuthError",o.ext=i,o}return fu(t,e),t.prototype.isFatal=function(){if(this.ext&&this.ext.status&&(this.ext.status===nf.PERSISTENT_ERROR||this.ext.status===nf.DISABLED))return!0;switch(this.errorCode){case Ef.code:return!0;default:return!1}},t.createError=function(e,r,n){if(n&&n.status)switch(n.status){case nf.ACCOUNT_UNAVAILABLE:return hd.createNativeAccountUnavailableError();case nf.USER_INTERACTION_REQUIRED:return new hd(e,r);case nf.USER_CANCEL:return zp.createUserCancelledError();case nf.NO_NETWORK:return zp.createNoNetworkConnectivityError()}return new t(e,r,n)},t.createUserSwitchError=function(){return new t(Sf.code,Sf.desc)},t.createTokensNotFoundInCacheError=function(){return new t(Af.code,Af.desc)},t}(ll),Rf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fu(t,e),t.prototype.acquireToken=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o;return vu(this,(function(s){switch(s.label){case 0:return t=this.performanceClient.startMeasurement(Jh.SilentCacheClientAcquireToken,e.correlationId),r=this.initializeServerTelemetryManager(Dd.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(r,e.authority,e.azureCloudOptions)];case 1:n=s.sent(),this.logger.verbose("Silent auth client created"),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,n.acquireCachedToken(e)];case 3:return i=s.sent(),t.endMeasurement({success:!0,fromCache:!0}),[2,i];case 4:throw(o=s.sent())instanceof zp&&o.errorCode===Mp.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),t.endMeasurement({errorCode:o instanceof ll&&o.errorCode||void 0,subErrorCode:o instanceof ll&&o.subError||void 0,success:!1}),o;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(zp.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t,r){return mu(this,void 0,void 0,(function(){var n;return vu(this,(function(i){switch(i.label){case 0:return this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=i.sent(),[2,new Id(n,this.performanceClient)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return mu(this,void 0,void 0,(function(){var r;return vu(this,(function(n){switch(n.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(Jh.InitializeBaseRequest,this.correlationId),r=[gu({},e)],[4,this.initializeBaseRequest(e,t)];case 1:return[2,gu.apply(void 0,[gu.apply(void 0,r.concat([n.sent()])),{account:t,forceRefresh:e.forceRefresh||!1}])]}}))}))},t}(Tf),Nf=function(e){function t(t,r,n,i,o,s,a,c,u,l,h,d){var p=e.call(this,t,r,n,i,o,s,c,u,d)||this;return p.apiId=a,p.accountId=l,p.nativeMessageHandler=u,p.nativeStorageManager=h,p.silentCacheClient=new Rf(t,p.nativeStorageManager,n,i,o,s,c,u,d),p}return fu(t,e),t.prototype.acquireToken=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s,a;return vu(this,(function(c){switch(c.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),t=this.performanceClient.startMeasurement(Jh.NativeInteractionClientAcquireToken,e.correlationId),r=id.nowSeconds(),[4,this.initializeNativeRequest(e)];case 1:n=c.sent(),c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,n)];case 3:return i=c.sent(),t.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,i];case 4:return c.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return o={method:Rd.GetToken,request:n},[4,this.nativeMessageHandler.sendMessage(o)];case 6:return s=c.sent(),a=this.validateNativeResponse(s),[2,this.handleNativeResponse(a,n,r).then((function(e){return t.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(e){throw t.endMeasurement({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))]}}))}))},t.prototype.createSilentCacheRequest=function(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Ph.fromString(e.scope).asArray(),account:t,forceRefresh:!1}},t.prototype.acquireTokensFromCache=function(e,t){return mu(this,void 0,void 0,(function(){var r,n;return vu(this,(function(i){switch(i.label){case 0:if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),ih.createNoAccountFoundError();if(!(r=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:e})))throw ih.createNoAccountFoundError();i.label=1;case 1:return i.trys.push([1,3,,4]),n=this.createSilentCacheRequest(t,r),[4,this.silentCacheClient.acquireToken(n)];case 2:return[2,i.sent()];case 3:throw i.sent();case 4:return[2]}}))}))},t.prototype.acquireTokenRedirect=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s;return vu(this,(function(a){switch(a.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(e)];case 1:t=a.sent(),r={method:Rd.GetToken,request:t},a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(r)];case 3:return n=a.sent(),this.validateNativeResponse(n),[3,5];case 4:if((i=a.sent())instanceof kf&&i.isFatal())throw i;return[3,5];case 5:return this.browserStorage.setTemporaryCache(Md.NATIVE_REQUEST,JSON.stringify(t),!0),o={apiId:Dd.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri),[4,this.navigationClient.navigateExternal(s,o)];case 6:return a.sent(),[2]}}))}))},t.prototype.handleRedirectPromise=function(){return mu(this,void 0,void 0,(function(){var e,t,r,n,i,o,s,a;return vu(this,(function(c){switch(c.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(e=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];t=e.prompt,r=yu(e,["prompt"]),t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Md.NATIVE_REQUEST)),n={method:Rd.GetToken,request:r},i=id.nowSeconds(),c.label=1;case 1:return c.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return o=c.sent(),this.validateNativeResponse(o),s=this.handleNativeResponse(o,r,i),this.browserStorage.setInteractionInProgress(!1),[2,s];case 3:throw a=c.sent(),this.browserStorage.setInteractionInProgress(!1),a;case 4:return[2]}}))}))},t.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},t.prototype.handleNativeResponse=function(e,t,r){return mu(this,void 0,void 0,(function(){var n,i,o,s,a,c;return vu(this,(function(u){switch(u.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw kf.createUserSwitchError();return[4,this.getDiscoveredAuthority(t.authority)];case 1:return n=u.sent(),i=n.getPreferredCache(),o=this.createIdTokenObj(e),s=this.createHomeAccountIdentifier(e,o),a=this.createAccountEntity(e,s,o,i),[4,this.generateAuthenticationResult(e,t,o,a,n.canonicalAuthority,r)];case 2:return c=u.sent(),this.cacheAccount(a),this.cacheNativeTokens(e,t,s,a,o,c.accessToken,c.tenantId,r),[2,c]}}))}))},t.prototype.createIdTokenObj=function(e){return new Lh(e.id_token||Mu.EMPTY_STRING,this.browserCrypto)},t.prototype.createHomeAccountIdentifier=function(e,t){return Uh.generateHomeAccountId(e.client_info||Mu.EMPTY_STRING,ch.Default,this.logger,this.browserCrypto,t)},t.prototype.createAccountEntity=function(e,t,r,n){return Uh.createAccount(e.client_info,t,r,void 0,void 0,void 0,n,e.account.id)},t.prototype.generateScopes=function(e,t){return e.scope?Ph.fromString(e.scope):Ph.fromString(t.scope)},t.prototype.generatePopAccessToken=function(e,t){return mu(this,void 0,void 0,(function(){var r,n;return vu(this,(function(i){switch(i.label){case 0:if(t.tokenType!==Yu.POP)return[3,2];if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,e.shr];if(r=new md(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce},!t.keyId)throw ih.createKeyIdMissingError();return[4,r.signPopToken(e.access_token,t.keyId,n)];case 1:return[2,i.sent()];case 2:return[2,e.access_token]}}))}))},t.prototype.generateAuthenticationResult=function(e,t,r,n,i,o){return mu(this,void 0,void 0,(function(){var s,a,c,u,l,h,d;return vu(this,(function(p){switch(p.label){case 0:return s=this.addTelemetryFromNativeResponse(e),a=e.scope?Ph.fromString(e.scope):Ph.fromString(t.scope),c=e.account.properties||{},u=c.UID||r.claims.oid||r.claims.sub||Mu.EMPTY_STRING,l=c.TenantId||r.claims.tid||Mu.EMPTY_STRING,[4,this.generatePopAccessToken(e,t)];case 1:return h=p.sent(),d=t.tokenType===Yu.POP?Yu.POP:Yu.BEARER,[2,{authority:i,uniqueId:u,tenantId:l,scopes:a.asArray(),account:n.getAccountInfo(),idToken:e.id_token,idTokenClaims:r.claims,accessToken:h,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:new Date(1e3*Number(o+e.expires_in)),tokenType:d,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}]}}))}))},t.prototype.cacheAccount=function(e){var t=this;this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((function(e){t.logger.error("Error occurred while removing account context from browser storage. "+e)}))},t.prototype.cacheNativeTokens=function(e,t,r,n,i,o,s,a){var c=nd.createIdTokenEntity(r,t.authority,e.id_token||Mu.EMPTY_STRING,t.clientId,i.claims.tid||Mu.EMPTY_STRING),u=a+(t.tokenType===Yu.POP?Mu.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),l=this.generateScopes(e,t),h=od.createAccessTokenEntity(r,t.authority,o,t.clientId,i?i.claims.tid||Mu.EMPTY_STRING:s,l.printScopes(),u,0,this.browserCrypto),d=new dd(n,c,h);this.nativeStorageManager.saveCacheRecord(d)},t.prototype.addTelemetryFromNativeResponse=function(e){var t=this.getMATSFromResponse(e);return t?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null},t.prototype.validateNativeResponse=function(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw kf.createUnexpectedError("Response missing expected properties.")},t.prototype.getMATSFromResponse=function(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},t.prototype.isResponseFromCache=function(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached},t.prototype.initializeNativeRequest=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s,a,c,u,l=this;return vu(this,(function(h){switch(h.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),t=e.authority||this.config.auth.authority,e.account?[4,this.validateRequestAuthority(t,e.account)]:[3,2];case 1:h.sent(),h.label=2;case 2:return(r=new fd(t)).validateAsUri(),n=e.scopes,i=yu(e,["scopes"]),(o=new Ph(n||[])).appendScopes(Pu),s=function(){switch(l.apiId){case Dd.ssoSilent:case Dd.acquireTokenSilent_silentFlow:return l.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Uu.NONE}if(e.prompt)switch(e.prompt){case Uu.NONE:case Uu.CONSENT:case Uu.LOGIN:return l.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw l.logger.trace("initializeNativeRequest: prompt = "+e.prompt+" is not compatible with native flow"),zp.createNativePromptParameterNotSupportedError()}else l.logger.trace("initializeNativeRequest: prompt was not provided")},a=gu(gu({},i),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:s(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:gu(gu(gu({},e.extraQueryParameters),e.tokenQueryParameters),{telemetry:Xp}),extendedExpiryToken:!1}),e.authenticationScheme!==Yu.POP?[3,4]:(c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},[4,new md(this.browserCrypto).generateCnf(c)]);case 3:u=h.sent(),a.reqCnf=u.reqCnfString,a.keyId=u.kid,h.label=4;case 4:return[2,a]}}))}))},t}(wf),Of=function(){function e(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(Jh.NativeMessageHandlerHandshake)}return e.prototype.sendMessage=function(e){return mu(this,void 0,void 0,(function(){var t,r=this;return vu(this,(function(n){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:$p,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise((function(e,n){r.resolvers.set(t.responseId,{resolve:e,reject:n})}))]}))}))},e.createProvider=function(t,r,n){return mu(this,void 0,void 0,(function(){var i,o;return vu(this,(function(s){switch(s.label){case 0:t.trace("NativeMessageHandler - createProvider called."),s.label=1;case 1:return s.trys.push([1,3,,5]),[4,(i=new e(t,r,n,Jp)).sendHandshakeRequest()];case 2:return s.sent(),[2,i];case 3:return s.sent(),[4,(o=new e(t,r,n)).sendHandshakeRequest()];case 4:return s.sent(),[2,o];case 5:return[2]}}))}))},e.prototype.sendHandshakeRequest=function(){return mu(this,void 0,void 0,(function(){var e,t=this;return vu(this,(function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:$p,extensionId:this.extensionId,responseId:this.responseId++,body:{method:Rd.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(e){t.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise((function(r,n){t.handshakeResolvers.set(e.responseId,{resolve:r,reject:n}),t.timeoutId=window.setTimeout((function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),t.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),n(zp.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)}),t.handshakeTimeoutMs)}))]}))}))},e.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===$p&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===Rd.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var r=this.handshakeResolvers.get(t.responseId);r&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),r.reject(zp.createNativeExtensionNotInstalledError()))}}},e.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{var i=t.body.method;if(i===Rd.Response){if(!r)return;var o=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(o)),"Success"!==o.status)r.reject(kf.createError(o.code,o.description,o.ext));else{if(!o.result)throw ll.createUnexpectedError("Event does not contain result.");o.result.code&&o.result.description?r.reject(kf.createError(o.result.code,o.result.description,o.result.ext)):r.resolve(o.result)}this.resolvers.delete(t.responseId)}else if(i===Rd.HandshakeResponse){if(!n)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+t.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(t):n&&n.reject(t)}},e.prototype.getExtensionId=function(){return this.extensionId},e.prototype.getExtensionVersion=function(){return this.extensionVersion},e.isNativeAvailable=function(e,t,r,n){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(n)switch(n){case Yu.BEARER:case Yu.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},e}(),Mf=function(e){function t(t,r,n,i,o,s,a,c,u,l){var h=e.call(this,t,r,n,i,o,s,a,u,l)||this;return h.nativeStorage=c,h}return fu(t,e),t.prototype.acquireToken=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s,a,c,u,l=this;return vu(this,(function(h){switch(h.label){case 0:return this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Ud.Redirect)];case 1:t=h.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||Mu.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(Dd.acquireTokenRedirect),n=function(e){e.persisted&&(l.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),l.browserStorage.cleanRequestByState(t.state),l.eventHandler.emitEvent(rf.RESTORE_FROM_BFCACHE,Ud.Redirect))},h.label=2;case 2:return h.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 3:return i=h.sent(),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(r,t.authority,t.azureCloudOptions)];case 4:return o=h.sent(),this.logger.verbose("Auth code client created"),s=new Cf(o,this.browserStorage,i,this.logger,this.browserCrypto,this.performanceClient),[4,o.getAuthCodeUrl(gu(gu({},t),{nativeBroker:Of.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}))];case 5:return a=h.sent(),c=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+c),window.addEventListener("pageshow",n),[4,s.initiateAuthRequest(a,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate})];case 6:return[2,h.sent()];case 7:throw(u=h.sent())instanceof ll&&u.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),r.cacheFailedRequest(u),this.browserStorage.cleanRequestByState(t.state),u;case 8:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s,a,c,u,l,h,d;return vu(this,(function(p){switch(p.label){case 0:t=this.initializeServerTelemetryManager(Dd.handleRedirectPromise),p.label=1;case 1:if(p.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Ud.Redirect),[2,null];n=void 0;try{i=fd.getDeserializedHash(r),n=this.validateAndExtractStateFromHash(i,Ud.Redirect),this.logger.verbose("State extracted from hash")}catch(e){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+e),this.browserStorage.cleanRequestByInteractionType(Ud.Redirect),[2,null]}return o=this.browserStorage.getTemporaryCache(Md.ORIGIN_URI,!0)||Mu.EMPTY_STRING,s=fd.removeHashFromUrl(o),a=fd.removeHashFromUrl(window.location.href),s===a&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,n,t)]):[3,3];case 2:return c=p.sent(),o.indexOf("#")>-1&&_f.replaceHash(o),[2,c];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,n,t)]);case 4:return _f.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(Md.URL_HASH,r,!0),u={apiId:Dd.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},l=!0,o&&"null"!==o?[3,6]:(h=_f.getHomepage(),this.browserStorage.setTemporaryCache(Md.ORIGIN_URI,h,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(h,u)]));case 5:return l=p.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+o),[4,this.navigationClient.navigateInternal(o,u)];case 7:l=p.sent(),p.label=8;case 8:if(!l)return[2,this.handleHash(r,n,t)];p.label=9;case 9:return[2,null];case 10:throw(d=p.sent())instanceof ll&&d.setCorrelationId(this.correlationId),t.cacheFailedRequest(d),this.browserStorage.cleanRequestByInteractionType(Ud.Redirect),d;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){if(this.logger.verbose("getRedirectResponseHash called"),fd.hashContainsKnownProperties(e))return _f.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),e;var t=this.browserStorage.getTemporaryCache(Md.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Md.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),t},t.prototype.handleHash=function(e,t,r){return mu(this,void 0,void 0,(function(){var n,i,o,s,a,c,u=this;return vu(this,(function(l){switch(l.label){case 0:if(n=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(i=fd.getDeserializedHash(e)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw zp.createNativeConnectionNotEstablishedError();return o=new Nf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dd.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,i.accountId,this.nativeStorage,n.correlationId),s=pd.parseRequestState(this.browserCrypto,t).userRequestState,[2,o.acquireToken(gu(gu({},n),{state:s,prompt:void 0})).finally((function(){u.browserStorage.cleanRequestByState(t)}))]}if(!(a=this.browserStorage.getCachedAuthority(t)))throw zp.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientCreateAuthCodeClient,n.correlationId),[4,this.createAuthCodeClient(r,a)];case 1:return c=l.sent(),this.logger.verbose("Auth code client created"),Wh.removeThrottle(this.browserStorage,this.config.auth.clientId,n),[4,new Cf(c,this.browserStorage,n,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(e,t,c.authority,this.networkClient)];case 2:return[2,l.sent()]}}))}))},t.prototype.logout=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s;return vu(this,(function(a){switch(a.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(Dd.logout),a.label=1;case 1:return a.trys.push([1,10,,11]),this.eventHandler.emitEvent(rf.LOGOUT_START,Ud.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return a.sent(),n={apiId:Dd.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return i=a.sent(),this.logger.verbose("Auth code client created"),o=i.getLogoutUri(t),this.eventHandler.emitEvent(rf.LOGOUT_SUCCESS,Ud.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(o)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(o,n)]):[3,7];case 4:return a.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),a.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(o,n)];case 8:return a.sent(),[2];case 9:return[3,11];case 10:throw(s=a.sent())instanceof ll&&s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s),this.eventHandler.emitEvent(rf.LOGOUT_FAILURE,Ud.Redirect,null,s),this.eventHandler.emitEvent(rf.LOGOUT_END,Ud.Redirect),s;case 11:return this.eventHandler.emitEvent(rf.LOGOUT_END,Ud.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return fd.getAbsoluteUrl(t,_f.getCurrentUri())},t}(Tf),Pf=function(e){function t(t,r,n,i,o,s,a,c,u,l){var h=e.call(this,t,r,n,i,o,s,a,u,l)||this;return h.unloadWindow=h.unloadWindow.bind(h),h.nativeStorage=c,h}return fu(t,e),t.prototype.acquireToken=function(e){try{var t=this.generatePopupName(e.scopes||Pu,e.authority||this.config.auth.authority),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var n=this.openSizedPopup("about:blank",t,r);return this.acquireTokenPopupAsync(e,t,r,n)}catch(e){return Promise.reject(e)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=this.generateLogoutPopupName(t),n=e&&e.authority,i=e&&e.mainWindowRedirectUri,o=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,o,n,void 0,i);this.logger.verbose("asyncPopup set to false, opening popup");var s=this.openSizedPopup("about:blank",r,o);return this.logoutPopupAsync(t,r,o,n,s,i)}catch(e){return Promise.reject(e)}},t.prototype.acquireTokenPopupAsync=function(e,t,r,n){return mu(this,void 0,void 0,(function(){var i,o,s,a,c,u,l,h,d,p,f,g,y,m,v,b,_=this;return vu(this,(function(w){switch(w.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),i=this.initializeServerTelemetryManager(Dd.acquireTokenPopup),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Ud.Popup)];case 1:o=w.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||Mu.EMPTY_STRING,o.account||null),w.label=2;case 2:return w.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientInitializeAuthorizationCodeRequest,e.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 3:return s=w.sent(),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(i,o.authority,o.azureCloudOptions)];case 4:return a=w.sent(),this.logger.verbose("Auth code client created"),c=Of.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),u=void 0,c&&(u=this.performanceClient.startMeasurement(Jh.FetchAccountIdWithNativeBroker,e.correlationId)),[4,a.getAuthCodeUrl(gu(gu({},o),{nativeBroker:c}))];case 5:return l=w.sent(),h=new If(a,this.browserStorage,s,this.logger,this.performanceClient),d={popup:n,popupName:t,popupWindowAttributes:r},p=this.initiateAuthRequest(l,d),this.eventHandler.emitEvent(rf.POPUP_OPENED,Ud.Popup,{popupWindow:p},null),[4,this.monitorPopupForHash(p)];case 6:if(f=w.sent(),g=fd.getDeserializedHash(f),y=this.validateAndExtractStateFromHash(g,Ud.Popup,o.correlationId),Wh.removeThrottle(this.browserStorage,this.config.auth.clientId,s),g.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),u&&u.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw zp.createNativeConnectionNotEstablishedError();return m=new Nf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dd.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,g.accountId,this.nativeStorage,o.correlationId),v=pd.parseRequestState(this.browserCrypto,y).userRequestState,[2,m.acquireToken(gu(gu({},o),{state:v,prompt:void 0})).finally((function(){_.browserStorage.cleanRequestByState(y)}))]}return[4,h.handleCodeResponseFromHash(f,y,a.authority,this.networkClient)];case 7:return[2,w.sent()];case 8:throw b=w.sent(),n&&n.close(),b instanceof ll&&b.setCorrelationId(this.correlationId),i.cacheFailedRequest(b),this.browserStorage.cleanRequestByState(o.state),b;case 9:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,r,n,i,o){return mu(this,void 0,void 0,(function(){var s,a,c,u,l,h,d;return vu(this,(function(p){switch(p.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(rf.LOGOUT_START,Ud.Popup,e),s=this.initializeServerTelemetryManager(Dd.logoutPopup),p.label=1;case 1:return p.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(e.account)];case 2:return p.sent(),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(s,n)];case 3:return a=p.sent(),this.logger.verbose("Auth code client created"),c=a.getLogoutUri(e),this.eventHandler.emitEvent(rf.LOGOUT_SUCCESS,Ud.Popup,e),u=this.openPopup(c,{popupName:t,popupWindowAttributes:r,popup:i}),this.eventHandler.emitEvent(rf.POPUP_OPENED,Ud.Popup,{popupWindow:u},null),[4,this.waitForLogoutPopup(u)];case 4:return p.sent(),o?(l={apiId:Dd.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},h=fd.getAbsoluteUrl(o,_f.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+h),this.navigationClient.navigateInternal(h,l)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw d=p.sent(),i&&i.close(),d instanceof ll&&d.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(rf.LOGOUT_FAILURE,Ud.Popup,null,d),this.eventHandler.emitEvent(rf.LOGOUT_END,Ud.Popup),s.cacheFailedRequest(d),d;case 6:return this.eventHandler.emitEvent(rf.LOGOUT_END,Ud.Popup),[2]}}))}))},t.prototype.initiateAuthRequest=function(e,t){if(oh.isEmpty(e))throw this.logger.error("Navigate url is empty"),zp.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+e),this.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return new Promise((function(r,n){var i=t.config.system.windowHashTimeout/t.config.system.pollIntervalMilliseconds,o=0;t.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var s=setInterval((function(){if(e.closed)return t.logger.error("PopupHandler.monitorPopupForHash - window closed"),t.cleanPopup(),clearInterval(s),void n(zp.createUserCancelledError());var a=Mu.EMPTY_STRING,c=Mu.EMPTY_STRING;try{a=e.location.href,c=e.location.hash}catch(e){}oh.isEmpty(a)||"about:blank"===a||(t.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),o++,c?(t.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(s),t.cleanPopup(e),fd.hashContainsKnownProperties(c)?(t.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),r(c)):(t.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),t.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+c),n(zp.createHashDoesNotContainKnownPropertiesError()))):o>i&&(t.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(s),n(zp.createMonitorPopupTimeoutError())))}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.waitForLogoutPopup=function(e){var t=this;return new Promise((function(r){t.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var n=setInterval((function(){e.closed&&(t.logger.error("PopupHandler.waitForLogoutPopup - window closed"),t.cleanPopup(),clearInterval(n),r());var i=Mu.EMPTY_STRING;try{i=e.location.href}catch(e){}oh.isEmpty(i)||"about:blank"===i||(t.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(n),t.cleanPopup(e),r())}),t.config.system.pollIntervalMilliseconds)}))},t.prototype.openPopup=function(e,t){try{var r=void 0;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),r=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!r)throw zp.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),zp.createPopupWindowError(e.toString())}},t.prototype.openSizedPopup=function(e,t,r){var n,i,o,s,a=window.screenLeft?window.screenLeft:window.screenX,c=window.screenTop?window.screenTop:window.screenY,u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=null===(n=r.popupSize)||void 0===n?void 0:n.width,d=null===(i=r.popupSize)||void 0===i?void 0:i.height,p=null===(o=r.popupPosition)||void 0===o?void 0:o.top,f=null===(s=r.popupPosition)||void 0===s?void 0:s.left;return(!h||h<0||h>u)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),h=Gp),(!d||d<0||d>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),d=jp),(!p||p<0||p>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),p=Math.max(0,l/2-jp/2+c)),(!f||f<0||f>u)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),f=Math.max(0,u/2-Gp/2+a)),window.open(e,t,"width="+h+", height="+d+", top="+p+", left="+f+", scrollbars=yes")},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(Ud.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},t.prototype.generatePopupName=function(e,t){return Yp+"."+this.config.auth.clientId+"."+e.join("-")+"."+t+"."+this.correlationId},t.prototype.generateLogoutPopupName=function(e){var t=e.account&&e.account.homeAccountId;return Yp+"."+this.config.auth.clientId+"."+t+"."+this.correlationId},t}(Tf),Bf=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}();
/*! @azure/msal-browser v2.37.1 2023-06-07 */
var Df,Uf=function(e){function t(t,r,n,i,o,s){var a=e.call(this,t,r,n,i,s)||this;return a.navigateFrameWait=o.navigateFrameWait,a.pollIntervalMilliseconds=o.pollIntervalMilliseconds,a}return fu(t,e),t.prototype.initiateAuthRequest=function(e){return mu(this,void 0,void 0,(function(){return vu(this,(function(t){switch(t.label){case 0:if(this.performanceClient.addQueueMeasurement(Jh.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),oh.isEmpty(e))throw this.logger.info("Navigate url is empty"),zp.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(Jh.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(e)]):[3,2];case 1:return[2,t.sent()];case 2:return[2,this.loadFrameSync(e)]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return this.performanceClient.addQueueMeasurement(Jh.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(n,i){t<6e3&&r.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default (6000ms). This may result in timeouts.");var o=window.performance.now()+t,s=setInterval((function(){if(window.performance.now()>o)return r.removeHiddenIframe(e),clearInterval(s),void i(zp.createMonitorIframeTimeoutError());var t=Mu.EMPTY_STRING,a=e.contentWindow;try{t=a?a.location.href:Mu.EMPTY_STRING}catch(e){}if(!oh.isEmpty(t)){var c=a?a.location.hash:Mu.EMPTY_STRING;return fd.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(s),void n(c)):void 0}}),r.pollIntervalMilliseconds)}))},t.prototype.loadFrame=function(e){var t=this;return this.performanceClient.addQueueMeasurement(Jh.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(r,n){var i=t.createHiddenIframe();setTimeout((function(){i?(i.src=e,r(i)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(If),Lf=function(e){function t(t,r,n,i,o,s,a,c,u,l,h){var d=e.call(this,t,r,n,i,o,s,c,l,h)||this;return d.apiId=a,d.nativeStorage=u,d}return fu(t,e),t.prototype.acquireToken=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o;return vu(this,(function(s){switch(s.label){case 0:if(this.performanceClient.addQueueMeasurement(Jh.SilentIframeClientAcquireToken,e.correlationId),this.logger.verbose("acquireTokenByIframe called"),t=this.performanceClient.startMeasurement(Jh.SilentIframeClientAcquireToken,e.correlationId),oh.isEmpty(e.loginHint)&&oh.isEmpty(e.sid)&&(!e.account||oh.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==Uu.NONE&&e.prompt!==Uu.NO_SESSION)throw t.endMeasurement({success:!1}),zp.createSilentPromptValueError(e.prompt);return this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(gu(gu({},e),{prompt:e.prompt||Uu.NONE}),Ud.Silent)];case 1:r=s.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||Mu.EMPTY_STRING,r.account||null),n=this.initializeServerTelemetryManager(this.apiId),s.label=2;case 2:return s.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientCreateAuthCodeClient,e.correlationId),[4,this.createAuthCodeClient(n,r.authority,r.azureCloudOptions)];case 3:return i=s.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(Jh.SilentIframeClientTokenHelper,e.correlationId),[4,this.silentTokenHelper(i,r).then((function(e){return t.endMeasurement({success:!0,fromCache:!1,requestId:e.requestId}),e}))];case 4:return[2,s.sent()];case 5:throw(o=s.sent())instanceof ll&&o.setCorrelationId(this.correlationId),n.cacheFailedRequest(o),this.browserStorage.cleanRequestByState(r.state),t.endMeasurement({errorCode:o instanceof ll&&o.errorCode||void 0,subErrorCode:o instanceof ll&&o.subError||void 0,success:!1}),o;case 6:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(zp.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t){return mu(this,void 0,void 0,(function(){var r,n,i,o,s,a,c,u,l,h=this;return vu(this,(function(d){switch(d.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.SilentIframeClientTokenHelper,t.correlationId),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(t)];case 1:return r=d.sent(),this.performanceClient.setPreQueueTime(Jh.GetAuthCodeUrl,t.correlationId),[4,e.getAuthCodeUrl(gu(gu({},t),{nativeBroker:Of.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 2:return n=d.sent(),i=new Uf(e,this.browserStorage,r,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(Jh.SilentHandlerInitiateAuthRequest,t.correlationId),[4,i.initiateAuthRequest(n)];case 3:return o=d.sent(),this.performanceClient.setPreQueueTime(Jh.SilentHandlerMonitorIframeForHash,t.correlationId),[4,i.monitorIframeForHash(o,this.config.system.iframeHashTimeout)];case 4:if(s=d.sent(),a=fd.getDeserializedHash(s),c=this.validateAndExtractStateFromHash(a,Ud.Silent,r.correlationId),a.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw zp.createNativeConnectionNotEstablishedError();return u=new Nf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,a.accountId,this.browserStorage,this.correlationId),l=pd.parseRequestState(this.browserCrypto,c).userRequestState,[2,u.acquireToken(gu(gu({},t),{state:l,prompt:t.prompt||Uu.NONE})).finally((function(){h.browserStorage.cleanRequestByState(c)}))]}return this.performanceClient.setPreQueueTime(Jh.HandleCodeResponseFromHash,t.correlationId),[2,i.handleCodeResponseFromHash(s,c,e.authority,this.networkClient)]}}))}))},t}(Tf),xf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fu(t,e),t.prototype.acquireToken=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s=this;return vu(this,(function(a){switch(a.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.SilentRefreshClientAcquireToken,e.correlationId),this.performanceClient.setPreQueueTime(Jh.InitializeBaseRequest,e.correlationId),r=[gu({},e)],[4,this.initializeBaseRequest(e,e.account)];case 1:return t=gu.apply(void 0,r.concat([a.sent()])),n=this.performanceClient.startMeasurement(Jh.SilentRefreshClientAcquireToken,t.correlationId),i=this.initializeServerTelemetryManager(Dd.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(i,t.authority,t.azureCloudOptions)];case 2:return o=a.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(Jh.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),[2,o.acquireTokenByRefreshToken(t).then((function(e){return n.endMeasurement({success:!0,fromCache:e.fromCache,requestId:e.requestId}),e})).catch((function(e){throw e instanceof ll&&e.setCorrelationId(s.correlationId),i.cacheFailedRequest(e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(zp.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t,r){return mu(this,void 0,void 0,(function(){var n;return vu(this,(function(i){switch(i.label){case 0:return this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(e,t,r)];case 1:return n=i.sent(),[2,new Td(n,this.performanceClient)]}}))}))},t}(Tf),Ff=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,r,n){var i=this;if("undefined"!=typeof window){var o={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){i.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[o])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!=typeof r||!Uh.isAccountEntity(r))return;var n=xh.toObject(new Uh,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(rf.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(rf.ACCOUNT_REMOVED,void 0,n))}catch(e){return}},e}(),qf=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),Hf=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,qf.decimalToHex(e[0])+qf.decimalToHex(e[1])+qf.decimalToHex(e[2])+qf.decimalToHex(e[3])+"-"+qf.decimalToHex(e[4])+qf.decimalToHex(e[5])+"-"+qf.decimalToHex(e[6])+qf.decimalToHex(e[7])+"-"+qf.decimalToHex(e[8])+qf.decimalToHex(e[9])+"-"+qf.decimalToHex(e[10])+qf.decimalToHex(e[11])+qf.decimalToHex(e[12])+qf.decimalToHex(e[13])+qf.decimalToHex(e[14])+qf.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,i=Mu.EMPTY_STRING,o=0;o<36;o++)"-"!==t[o]&&"4"!==t[o]&&(n=16*Math.random()|0),"x"===t[o]?i+=r[n]:"y"===t[o]?(n&=3,i+=r[n|=8]):i+=t[o];return i}},e.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),Kf=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,i=0;i<n;i++)r+=(t=e.charCodeAt(i))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var o=new Uint8Array(r),s=0,a=0;s<r;a++)(t=e.charCodeAt(a))<128?o[s++]=t:t<2048?(o[s++]=192+(t>>>6),o[s++]=128+(63&t)):t<65536?(o[s++]=224+(t>>>12),o[s++]=128+(t>>>6&63),o[s++]=128+(63&t)):t<2097152?(o[s++]=240+(t>>>18),o[s++]=128+(t>>>12&63),o[s++]=128+(t>>>6&63),o[s++]=128+(63&t)):t<67108864?(o[s++]=248+(t>>>24),o[s++]=128+(t>>>18&63),o[s++]=128+(t>>>12&63),o[s++]=128+(t>>>6&63),o[s++]=128+(63&t)):(o[s++]=252+(t>>>30),o[s++]=128+(t>>>24&63),o[s++]=128+(t>>>18&63),o[s++]=128+(t>>>12&63),o[s++]=128+(t>>>6&63),o[s++]=128+(63&t));return o},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t=Mu.EMPTY_STRING,r=void 0,n=e.length,i=0;i<n;i++)r=e[i],t+=String.fromCharCode(r>251&&r<254&&i+5<n?1073741824*(r-252)+(e[++i]-128<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:r>247&&r<252&&i+4<n?(r-248<<24)+(e[++i]-128<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:r>239&&r<248&&i+3<n?(r-240<<18)+(e[++i]-128<<12)+(e[++i]-128<<6)+e[++i]-128:r>223&&r<240&&i+2<n?(r-224<<12)+(e[++i]-128<<6)+e[++i]-128:r>191&&r<224&&i+1<n?(r-192<<6)+e[++i]-128:r);return t},e.getSortedObjectString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),zf=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,Mu.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,Mu.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=Kf.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r=Mu.EMPTY_STRING,n=void 0,i=e.length,o=0,s=0;s<i;s++)n=s%3,o|=e[s]<<(16>>>n&24),2!==n&&e.length-s!=1||(r+=String.fromCharCode(this.uint6ToB64(o>>>18&63),this.uint6ToB64(o>>>12&63),this.uint6ToB64(o>>>6&63),this.uint6ToB64(63&o)),o=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Vf=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Kf.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,Mu.EMPTY_STRING),n=r.length,i=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,o=new Uint8Array(i),s=void 0,a=void 0,c=0,u=0,l=0;l<n;l++)if(a=3&l,c|=this.b64ToUint6(r.charCodeAt(l))<<18-6*a,3===a||n-l==1){for(s=0;s<3&&u<i;s++,u++)o[u]=c>>>(16>>>s&24)&255;c=0}return o},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Gf=function(){function e(e){this.base64Encode=new zf,this.cryptoObj=e}return e.prototype.generateCodes=function(){return mu(this,void 0,void 0,(function(){var e,t;return vu(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw zp.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return mu(this,void 0,void 0,(function(){var t,r;return vu(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),zp.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),jf=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.crypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return mu(this,void 0,void 0,(function(){return vu(this,(function(n){return[2,window.crypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return mu(this,void 0,void 0,(function(){return vu(this,(function(t){return[2,window.crypto.subtle.exportKey("jwk",e)]}))}))},e.prototype.importKey=function(e,t,r,n){return mu(this,void 0,void 0,(function(){return vu(this,(function(i){return[2,window.crypto.subtle.importKey("jwk",e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return mu(this,void 0,void 0,(function(){return vu(this,(function(n){return[2,window.crypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e}(),Yf=function(){function e(){}return e.prototype.initPrng=function(e){return window.msrCrypto.initPrng(_u(e))},e.prototype.getRandomValues=function(e){return window.msrCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return mu(this,void 0,void 0,(function(){return vu(this,(function(n){return[2,window.msrCrypto.subtle.generateKey(e,t,r)]}))}))},e.prototype.exportKey=function(e){return mu(this,void 0,void 0,(function(){return vu(this,(function(t){return[2,window.msrCrypto.subtle.exportKey("jwk",e)]}))}))},e.prototype.importKey=function(e,t,r,n){return mu(this,void 0,void 0,(function(){return vu(this,(function(i){return[2,window.msrCrypto.subtle.importKey("jwk",e,t,r,n)]}))}))},e.prototype.sign=function(e,t,r){return mu(this,void 0,void 0,(function(){return vu(this,(function(n){return[2,window.msrCrypto.subtle.sign(e,t,r)]}))}))},e.prototype.digest=function(e,t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){return[2,window.msrCrypto.subtle.digest(e,t)]}))}))},e}(),Qf=function(){function e(){}return e.prototype.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},e.prototype.generateKey=function(e,t,r){return mu(this,void 0,void 0,(function(){return vu(this,(function(n){return[2,new Promise((function(n,i){var o=window.msCrypto.subtle.generateKey(e,t,r);o.addEventListener("complete",(function(e){n(e.target.result)})),o.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.exportKey=function(e){return mu(this,void 0,void 0,(function(){return vu(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey("jwk",e);n.addEventListener("complete",(function(e){var n=e.target.result,i=Kf.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,Mu.EMPTY_STRING).replace(/\n/g,Mu.EMPTY_STRING).replace(/\t/g,Mu.EMPTY_STRING).split(" ").join(Mu.EMPTY_STRING).replace("\0",Mu.EMPTY_STRING);try{t(JSON.parse(i))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.importKey=function(e,t,r,n){return mu(this,void 0,void 0,(function(){var i,o;return vu(this,(function(s){return i=Kf.getSortedObjectString(e),o=Kf.stringToArrayBuffer(i),[2,new Promise((function(e,i){var s=window.msCrypto.subtle.importKey("jwk",o,t,r,n);s.addEventListener("complete",(function(t){e(t.target.result)})),s.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.sign=function(e,t,r){return mu(this,void 0,void 0,(function(){return vu(this,(function(n){return[2,new Promise((function(n,i){var o=window.msCrypto.subtle.sign(e,t,r);o.addEventListener("complete",(function(e){n(e.target.result)})),o.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.digest=function(e,t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){return[2,new Promise((function(r,n){var i=window.msCrypto.subtle.digest(e,t.buffer);i.addEventListener("complete",(function(e){r(e.target.result)})),i.addEventListener("error",(function(e){n(e)}))}))]}))}))},e}(),Wf=new Uint8Array([1,0,1]),$f=function(){function e(e,t){var r,n;if(this.logger=e,this.cryptoOptions=t,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new jf;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new Qf;else{if(!this.hasMsrCrypto()||!(null===(r=this.cryptoOptions)||void 0===r?void 0:r.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),zp.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new Yf}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(n=this.cryptoOptions)||void 0===n?void 0:n.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),df.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256",modulusLength:2048,publicExponent:Wf}}return e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},e.prototype.sha256Digest=function(e){return mu(this,void 0,void 0,(function(){var t;return vu(this,(function(r){return t=Kf.stringToUtf8Arr(e),[2,this.subtleCrypto.digest({name:"SHA-256"},t)]}))}))},e.prototype.getRandomValues=function(e){return this.subtleCrypto.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return mu(this,void 0,void 0,(function(){return vu(this,(function(t){return[2,this.subtleCrypto.exportKey(e)]}))}))},e.prototype.importJwk=function(e,t,r){return mu(this,void 0,void 0,(function(){return vu(this,(function(n){return[2,this.subtleCrypto.importKey(e,this.keygenAlgorithmOptions,t,r)]}))}))},e.prototype.sign=function(e,t){return mu(this,void 0,void 0,(function(){return vu(this,(function(r){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,e,t)]}))}))},e}(),Jf=function(){function e(){this.dbName="msal.db",this.version=1,this.tableName="msal.db.keys",this.dbOpen=!1}return e.prototype.open=function(){return mu(this,void 0,void 0,(function(){var e=this;return vu(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(){return r(zp.createDatabaseUnavailableError())}))}))]}))}))},e.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},e.prototype.validateDbIsOpen=function(){return mu(this,void 0,void 0,(function(){return vu(this,(function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getItem=function(e){return mu(this,void 0,void 0,(function(){var t=this;return vu(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(zp.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);i.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(n.target.result)})),i.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.setItem=function(e,t){return mu(this,void 0,void 0,(function(){var r=this;return vu(this,(function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise((function(n,i){if(!r.db)return i(zp.createDatabaseNotOpenError());var o=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);o.addEventListener("success",(function(){r.closeConnection(),n()})),o.addEventListener("error",(function(e){r.closeConnection(),i(e)}))}))]}}))}))},e.prototype.removeItem=function(e){return mu(this,void 0,void 0,(function(){var t=this;return vu(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(zp.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);i.addEventListener("success",(function(){t.closeConnection(),r()})),i.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.getKeys=function(){return mu(this,void 0,void 0,(function(){var e=this;return vu(this,(function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise((function(t,r){if(!e.db)return r(zp.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();n.addEventListener("success",(function(r){var n=r;e.closeConnection(),t(n.target.result)})),n.addEventListener("error",(function(t){e.closeConnection(),r(t)}))}))]}}))}))},e.prototype.containsKey=function(e){return mu(this,void 0,void 0,(function(){var t=this;return vu(this,(function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise((function(r,n){if(!t.db)return n(zp.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);i.addEventListener("success",(function(e){var n=e;t.closeConnection(),r(1===n.target.result)})),i.addEventListener("error",(function(e){t.closeConnection(),n(e)}))}))]}}))}))},e.prototype.deleteDatabase=function(){return mu(this,void 0,void 0,(function(){return vu(this,(function(e){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(e,t){var r=window.indexedDB.deleteDatabase("msal.db");r.addEventListener("success",(function(){return e(!0)})),r.addEventListener("blocked",(function(){return e(!0)})),r.addEventListener("error",(function(){return t(!1)}))}))]}))}))},e}(),Xf=function(){function e(e,t){this.inMemoryCache=new ff,this.indexedDBCache=new Jf,this.logger=e,this.storeName=t}return e.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof zp&&e.errorCode===Up.code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},e.prototype.getItem=function(e){return mu(this,void 0,void 0,(function(){var t,r;return vu(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.setItem=function(e,t){return mu(this,void 0,void 0,(function(){var r;return vu(this,(function(n){switch(n.label){case 0:this.inMemoryCache.setItem(e,t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}}))}))},e.prototype.removeItem=function(e){return mu(this,void 0,void 0,(function(){var t;return vu(this,(function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}}))}))},e.prototype.getKeys=function(){return mu(this,void 0,void 0,(function(){var e,t;return vu(this,(function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}}))}))},e.prototype.containsKey=function(e){return mu(this,void 0,void 0,(function(){var t,r;return vu(this,(function(n){switch(n.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,n.sent()];case 3:return r=n.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}}))}))},e.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},e.prototype.clearPersistent=function(){return mu(this,void 0,void 0,(function(){var e,t;return vu(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(e=r.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,e];case 2:return t=r.sent(),this.handleDatabaseAccessError(t),[2,!1];case 3:return[2]}}))}))},e}();
/*! @azure/msal-browser v2.37.1 2023-06-07 */!function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"}(Df||(Df={}));var Zf=function(){function e(e){this.logger=e,this.asymmetricKeys=new Xf(this.logger,Df.asymmetricKeys),this.symmetricKeys=new Xf(this.logger,Df.symmetricKeys)}return e.prototype.clear=function(){return mu(this,void 0,void 0,(function(){var e;return vu(this,(function(t){switch(t.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return t.sent(),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},e}(),eg=function(){function e(e,t,r){this.logger=e,this.browserCrypto=new $f(this.logger,r),this.b64Encode=new zf,this.b64Decode=new Vf,this.guidGenerator=new Hf(this.browserCrypto),this.pkceGenerator=new Gf(this.browserCrypto),this.cache=new Zf(this.logger),this.performanceClient=t}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return mu(this,void 0,void 0,(function(){return vu(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){var r;return mu(this,void 0,void 0,(function(){var n,i,o,s,a,c,u,l;return vu(this,(function(h){switch(h.label){case 0:return n=null===(r=this.performanceClient)||void 0===r?void 0:r.startMeasurement(Jh.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return i=h.sent(),[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return o=h.sent(),s={e:o.e,kty:o.kty,n:o.n},a=Kf.getSortedObjectString(s),[4,this.hashString(a)];case 3:return c=h.sent(),[4,this.browserCrypto.exportJwk(i.privateKey)];case 4:return u=h.sent(),[4,this.browserCrypto.importJwk(u,!1,["sign"])];case 5:return l=h.sent(),[4,this.cache.asymmetricKeys.setItem(c,{privateKey:l,publicKey:i.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return h.sent(),n&&n.endMeasurement({success:!0}),[2,c]}}))}))},e.prototype.removeTokenBindingKey=function(e){return mu(this,void 0,void 0,(function(){return vu(this,(function(t){switch(t.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return t.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!t.sent()]}}))}))},e.prototype.clearKeystore=function(){return mu(this,void 0,void 0,(function(){return vu(this,(function(e){switch(e.label){case 0:return[4,this.cache.clear()];case 1:return[2,e.sent()]}}))}))},e.prototype.signJwt=function(e,t,r){var n;return mu(this,void 0,void 0,(function(){var i,o,s,a,c,u,l,h,d,p,f,g,y;return vu(this,(function(m){switch(m.label){case 0:return i=null===(n=this.performanceClient)||void 0===n?void 0:n.startMeasurement(Jh.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(o=m.sent()))throw zp.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(o.publicKey)];case 2:return s=m.sent(),a=Kf.getSortedObjectString(s),c=this.b64Encode.urlEncode(JSON.stringify({kid:t})),u=Yd.getShrHeaderString({kid:c,alg:s.alg}),l=this.b64Encode.urlEncode(u),e.cnf={jwk:JSON.parse(a)},h=this.b64Encode.urlEncode(JSON.stringify(e)),d=l+"."+h,p=Kf.stringToArrayBuffer(d),[4,this.browserCrypto.sign(o.privateKey,p)];case 3:return f=m.sent(),g=this.b64Encode.urlEncodeArr(new Uint8Array(f)),y=d+"."+g,i&&i.endMeasurement({success:!0}),[2,y]}}))}))},e.prototype.hashString=function(e){return mu(this,void 0,void 0,(function(){var t,r;return vu(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=n.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}(),tg=function(){function e(t,r){this.correlationId=r,this.measureName=e.makeMeasureName(t,r),this.startMark=e.makeStartMark(t,r),this.endMark=e.makeEndMark(t,r)}return e.makeMeasureName=function(e,t){return"msal.measure."+e+"."+t},e.makeStartMark=function(e,t){return"msal.start."+e+"."+t},e.makeEndMark=function(e,t){return"msal.end."+e+"."+t},e.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},e.flushMeasurements=function(t,r){if(e.supportsBrowserPerformance())try{r.forEach((function(r){var n=e.makeMeasureName(r.name,t);window.performance.getEntriesByName(n,"measure").length>0&&(window.performance.clearMeasures(n),window.performance.clearMarks(e.makeStartMark(n,t)),window.performance.clearMarks(e.makeEndMark(n,t)))}))}catch(e){}},e.prototype.startMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(e){}},e.prototype.endMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(e){}},e.prototype.flushMeasurement=function(){if(e.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var r=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),r}}catch(e){}return null},e}(),rg=function(e){function t(t,r,n,i,o,s,a){var c=e.call(this,t,r,n,i,o,s)||this;return c.browserCrypto=new $f(c.logger,a),c.guidGenerator=new Hf(c.browserCrypto),c}return fu(t,e),t.prototype.startPerformanceMeasuremeant=function(e,t){return new tg(e,t)},t.prototype.generateId=function(){return this.guidGenerator.generateGuid()},t.prototype.getPageVisibility=function(){var e;return(null===(e=document.visibilityState)||void 0===e?void 0:e.toString())||null},t.prototype.deleteIncompleteSubMeasurements=function(e){var t=this.eventsByCorrelationId.get(e.event.correlationId),r=t&&t.eventId===e.event.eventId,n=[];r&&(null==t?void 0:t.incompleteSubMeasurements)&&t.incompleteSubMeasurements.forEach((function(e){n.push(gu({},e))})),n.length>0&&tg.flushMeasurements(e.event.correlationId,n)},t.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now},t.prototype.startMeasurement=function(t,r){var n=this,i=this.getPageVisibility(),o=e.prototype.startMeasurement.call(this,t,r);return gu(gu({},o),{endMeasurement:function(e){var t=o.endMeasurement(gu({startPageVisibility:i,endPageVisibility:n.getPageVisibility()},e));return n.deleteIncompleteSubMeasurements(o),t},discardMeasurement:function(){o.discardMeasurement(),n.deleteIncompleteSubMeasurements(o),o.measurement.flushMeasurement()}})},t.prototype.setPreQueueTime=function(e,t){if(this.supportsBrowserPerformanceNow())if(t){var r=this.preQueueTimeByCorrelationId.get(t);r&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+r.name+" found",t),this.addQueueMeasurement(r.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}else this.logger.trace("BrowserPerformanceClient: correlationId for "+e+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+e)},t.prototype.addQueueMeasurement=function(t,r,n,i){if(this.supportsBrowserPerformanceNow())if(r){var o=e.prototype.getPreQueueTime.call(this,t,r);if(o){var s=window.performance.now(),a=n||e.prototype.calculateQueuedTime.call(this,o,s);return e.prototype.addQueueMeasurement.call(this,t,r,a,i)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+t)},t}(Wd),ng=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw zp.createUnableToLoadTokenError("Please ensure server response includes id token.");var n,i,o=new Lh(t.id_token,this.cryptoObj);if(e.account){var s=this.loadAccount(o,e.account.environment,void 0,void 0,e.account.homeAccountId);n=new dd(s,this.loadIdToken(o,s.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,s.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,t,s.homeAccountId,e.account.environment))}else{if(!e.authority)throw zp.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var a=Fd.generateAuthority(e.authority,e.azureCloudOptions),c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(i=new Fd(a,this.config.system.networkClient,this.storage,c,this.logger),r.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");s=this.loadAccount(o,i.hostnameAndPort,r.clientInfo,i.authorityType);n=new dd(s,this.loadIdToken(o,s.homeAccountId,i.hostnameAndPort,i.tenant),this.loadAccessToken(e,t,s.homeAccountId,i.hostnameAndPort,i.tenant,r),this.loadRefreshToken(e,t,s.homeAccountId,i.hostnameAndPort))}else{if(!t.client_info)throw zp.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");s=this.loadAccount(o,i.hostnameAndPort,t.client_info,i.authorityType);n=new dd(s,this.loadIdToken(o,s.homeAccountId,i.hostnameAndPort,i.tenant),this.loadAccessToken(e,t,s.homeAccountId,i.hostnameAndPort,i.tenant,r),this.loadRefreshToken(e,t,s.homeAccountId,i.hostnameAndPort))}}return this.generateAuthenticationResult(e,o,n,i)},e.prototype.loadAccount=function(e,t,r,n,i){var o;if(i?o=i:void 0!==n&&r&&(o=Uh.generateHomeAccountId(r,n,this.logger,this.cryptoObj,e)),!o)throw zp.createUnableToLoadTokenError("Unexpected missing homeAccountId");var s=r?Uh.createAccount(r,o,e,void 0,void 0,void 0,t):Uh.createGenericAccount(o,e,void 0,void 0,void 0,t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(s),s;throw zp.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadIdToken=function(e,t,r,n){var i=nd.createIdTokenEntity(t,r,e.rawToken,this.config.auth.clientId,n);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(i),i;throw zp.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadAccessToken=function(e,t,r,n,i,o){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw zp.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!o.extendedExpiresOn)throw zp.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var s=new Ph(e.scopes).printScopes(),a=o.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=o.extendedExpiresOn,u=od.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,i,s,a,c,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u),u;throw zp.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadRefreshToken=function(e,t,r,n){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var i=sd.createRefreshTokenEntity(r,n,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(i),i;throw zp.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.generateAuthenticationResult=function(e,t,r,n){var i,o,s,a,c=Mu.EMPTY_STRING,u=[],l=null;(null==r?void 0:r.accessToken)&&(c=r.accessToken.secret,u=Ph.fromString(r.accessToken.target).asArray(),l=new Date(1e3*Number(r.accessToken.expiresOn)),a=new Date(1e3*Number(r.accessToken.extendedExpiresOn)));var h=(null==t?void 0:t.claims.oid)||(null==t?void 0:t.claims.sub)||Mu.EMPTY_STRING,d=(null==t?void 0:t.claims.tid)||Mu.EMPTY_STRING;return{authority:n?n.canonicalAuthority:Mu.EMPTY_STRING,uniqueId:h,tenantId:d,scopes:u,account:(null==r?void 0:r.account)?r.account.getAccountInfo():null,idToken:t?t.rawToken:Mu.EMPTY_STRING,idTokenClaims:t?t.claims:{},accessToken:c,fromCache:!0,expiresOn:l,correlationId:e.correlationId||Mu.EMPTY_STRING,requestId:Mu.EMPTY_STRING,extExpiresOn:a,familyId:Mu.EMPTY_STRING,tokenType:(null===(i=null==r?void 0:r.accessToken)||void 0===i?void 0:i.tokenType)||Mu.EMPTY_STRING,state:Mu.EMPTY_STRING,cloudGraphHostName:(null===(o=null==r?void 0:r.account)||void 0===o?void 0:o.cloudGraphHostName)||Mu.EMPTY_STRING,msGraphHost:(null===(s=null==r?void 0:r.account)||void 0===s?void 0:s.msGraphHost)||Mu.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},e}(),ig=function(e){function t(t){var r=e.call(this,t)||this;return r.includeRedirectUri=!1,r}return fu(t,e),t}(wd),og=function(e){function t(t,r,n,i,o,s,a,c,u,l){var h=e.call(this,t,r,n,i,o,s,c,u,l)||this;return h.apiId=a,h}return fu(t,e),t.prototype.acquireToken=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s;return vu(this,(function(a){switch(a.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!e.code)throw zp.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientInitializeAuthorizationRequest,e.correlationId),[4,this.initializeAuthorizationRequest(e,Ud.Silent)];case 1:t=a.sent(),this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||Mu.EMPTY_STRING,t.account||null),r=this.initializeServerTelemetryManager(this.apiId),a.label=2;case 2:return a.trys.push([2,4,,5]),n=gu(gu({},t),{code:e.code}),this.performanceClient.setPreQueueTime(Jh.StandardInteractionClientGetClientConfiguration,e.correlationId),[4,this.getClientConfiguration(r,t.authority)];case 3:return i=a.sent(),o=new ig(i),this.logger.verbose("Auth code client created"),[2,new Uf(o,this.browserStorage,n,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t.state,o.authority,this.networkClient,!1)];case 4:throw(s=a.sent())instanceof ll&&s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s),this.browserStorage.cleanRequestByState(t.state),s;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(zp.createSilentLogoutUnsupportedError())},t}(Tf),sg=function(e){function t(t){var r=e.call(this,t)||this;return r.astsAsyncMeasurement=void 0,r.activeSilentTokenRequests=new Map,r.trackPageVisibility=r.trackPageVisibility.bind(r),r}return fu(t,e),t.prototype.loginRedirect=function(e){return mu(this,void 0,void 0,(function(){var t;return vu(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.verbose("loginRedirect called",t),[2,this.acquireTokenRedirect(gu({correlationId:t},e||ef))]}))}))},t.prototype.loginPopup=function(e){var t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(gu({correlationId:t},e||ef))},t.prototype.acquireTokenSilent=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s,a,c=this;return vu(this,(function(u){if(t=this.getRequestCorrelationId(e),(r=this.performanceClient.startMeasurement(Jh.AcquireTokenSilent,t)).addStaticFields({cacheLookupPolicy:e.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(Ud.Silent),this.logger.verbose("acquireTokenSilent called",t),!(n=e.account||this.getActiveAccount()))throw zp.createNoAccountError();return i={clientId:this.config.auth.clientId,authority:e.authority||Mu.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:n.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},o=JSON.stringify(i),void 0===(s=this.activeSilentTokenRequests.get(o))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t),this.performanceClient.setPreQueueTime(Jh.AcquireTokenSilentAsync,t),a=this.acquireTokenSilentAsync(gu(gu({},e),{correlationId:t}),n).then((function(t){return c.activeSilentTokenRequests.delete(o),r.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),r.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId}),t})).catch((function(e){throw c.activeSilentTokenRequests.delete(o),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.activeSilentTokenRequests.set(o,a),[2,a]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discardMeasurement(),[2,s])}))}))},t.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},t.prototype.acquireTokenSilentAsync=function(e,t){var r;return mu(this,void 0,void 0,(function(){var n,i,o,s,a,c=this;return vu(this,(function(u){switch(u.label){case 0:return this.performanceClient.addQueueMeasurement(Jh.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_START,Ud.Silent,e),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(Jh.AcquireTokenSilentAsync,e.correlationId),null===(r=this.astsAsyncMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),Of.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),i=gu(gu({},e),{account:t}),n=this.acquireTokenNative(i,Dd.acquireTokenSilent_silentFlow).catch((function(t){return mu(c,void 0,void 0,(function(){return vu(this,(function(r){if(t instanceof kf&&t.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(e.correlationId).acquireToken(e)];throw t}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),o=this.createSilentCacheClient(e.correlationId),this.performanceClient.setPreQueueTime(Jh.InitializeSilentRequest,e.correlationId),[4,o.initializeSilentRequest(e,t)];case 2:s=u.sent(),a=gu(gu({},e),{cacheLookupPolicy:e.cacheLookupPolicy||tf.Default}),this.performanceClient.setPreQueueTime(Jh.AcquireTokenFromCache,s.correlationId),n=this.acquireTokenFromCache(o,s,a).catch((function(t){if(a.cacheLookupPolicy===tf.AccessToken)throw t;return _f.blockReloadInHiddenIframes(),c.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_NETWORK_START,Ud.Silent,s),c.performanceClient.setPreQueueTime(Jh.AcquireTokenByRefreshToken,s.correlationId),c.acquireTokenByRefreshToken(s,a).catch((function(t){var r=t instanceof Qh,n=t instanceof hd,i=t.errorCode===Vp;if((!r||!i||n||a.cacheLookupPolicy===tf.AccessTokenAndRefreshToken||a.cacheLookupPolicy===tf.RefreshToken)&&a.cacheLookupPolicy!==tf.Skip)throw t;return c.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",e.correlationId),c.performanceClient.setPreQueueTime(Jh.AcquireTokenBySilentIframe,s.correlationId),c.acquireTokenBySilentIframe(s)}))})),u.label=3;case 3:return[2,n.then((function(e){var t;return c.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_SUCCESS,Ud.Silent,e),null===(t=c.astsAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw c.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_FAILURE,Ud.Silent,null,e),null===(t=c.astsAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",c.trackPageVisibility)}))]}}))}))},t}(function(){function e(e){var t,r,n;this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(e,t){var r=e.auth,n=e.cache,i=e.system,o=e.telemetry,s={clientId:Mu.EMPTY_STRING,authority:""+Mu.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:Mu.EMPTY_STRING,authorityMetadata:Mu.EMPTY_STRING,redirectUri:Mu.EMPTY_STRING,postLogoutRedirectUri:Mu.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Ed.AAD,azureCloudOptions:{azureCloudInstance:sh.None,tenant:Mu.EMPTY_STRING},skipAuthorityMetadataCache:!1},a={cacheLocation:Nd.SessionStorage,temporaryCacheLocation:Nd.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!n||n.cacheLocation!==Nd.LocalStorage)},c={loggerCallback:function(){},logLevel:al.Info,piiLoggingEnabled:!1},u=gu(gu({},qh),{loggerOptions:c,networkClient:t?_f.getBrowserNetworkClient():zd,navigationClient:new Bf,loadFrameTimeout:0,windowHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e4,iframeHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e3,navigateFrameWait:t&&_f.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==i?void 0:i.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:Qp,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),l=gu(gu({},i),{loggerOptions:(null==i?void 0:i.loggerOptions)||c}),h={application:{appName:Mu.EMPTY_STRING,appVersion:Mu.EMPTY_STRING}};return{auth:gu(gu({},s),r),cache:gu(gu({},a),n),system:gu(gu({},u),l),telemetry:gu(gu({},h),o)}}(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new ah(this.config.system.loggerOptions,mf,"2.37.1"),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new rg(this.config.auth.clientId,this.config.auth.authority,this.logger,mf,"2.37.1",this.config.telemetry.application,this.config.system.cryptoOptions):new Jd(this.config.auth.clientId,this.config.auth.authority,this.logger,mf,"2.37.1",this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new eg(this.logger,this.performanceClient,this.config.system.cryptoOptions):hl,this.eventHandler=new Ff(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new yf(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(t=this.config.auth.clientId,r=this.logger,n={cacheLocation:Nd.MemoryStorage,temporaryCacheLocation:Nd.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1},new yf(t,n,hl,r));var i={cacheLocation:Nd.MemoryStorage,temporaryCacheLocation:Nd.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1};this.nativeInternalStorage=new yf(this.config.auth.clientId,i,this.browserCrypto,this.logger),this.tokenCache=new ng(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return e.prototype.initialize=function(){return mu(this,void 0,void 0,(function(){var e,t,r,n;return vu(this,(function(i){switch(i.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement(Jh.InitializeClientApplication),this.eventHandler.emitEvent(rf.INITIALIZE_START),!e)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),r=this,[4,Of.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return r.nativeExtensionProvider=i.sent(),[3,4];case 3:return n=i.sent(),this.logger.verbose(n),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(rf.INITIALIZE_END),t.endMeasurement({allowNativeBroker:e,success:!0}),[2]}}))}))},e.prototype.handleRedirectPromise=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s,a,c,u=this;return vu(this,(function(l){return this.logger.verbose("handleRedirectPromise called"),_f.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||Mu.EMPTY_STRING,void 0===(n=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(rf.HANDLE_REDIRECT_START,Ud.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),i=this.browserStorage.getCachedNativeRequest(),o=void 0,i&&Of.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),s=new Nf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dd.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,i.accountId,this.nativeInternalStorage,i.correlationId),o=s.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),a=this.browserStorage.getTemporaryCache(Md.CORRELATION_ID,!0)||Mu.EMPTY_STRING,c=this.createRedirectClient(a),o=c.handleRedirectPromise(e)),n=o.then((function(e){e&&(t.length<u.getAllAccounts().length?(u.eventHandler.emitEvent(rf.LOGIN_SUCCESS,Ud.Redirect,e),u.logger.verbose("handleRedirectResponse returned result, login success")):(u.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_SUCCESS,Ud.Redirect,e),u.logger.verbose("handleRedirectResponse returned result, acquire token success")));return u.eventHandler.emitEvent(rf.HANDLE_REDIRECT_END,Ud.Redirect),e})).catch((function(e){throw t.length>0?u.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_FAILURE,Ud.Redirect,null,e):u.eventHandler.emitEvent(rf.LOGIN_FAILURE,Ud.Redirect,null,e),u.eventHandler.emitEvent(rf.HANDLE_REDIRECT_END,Ud.Redirect),e})),this.redirectResponse.set(r,n)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,n]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o,s=this;return vu(this,(function(a){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(Ud.Redirect),(r=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_START,Ud.Redirect,e):this.eventHandler.emitEvent(rf.LOGIN_START,Ud.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(i=new Nf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dd.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId),n=i.acquireTokenRedirect(e).catch((function(t){if(t instanceof kf&&t.isFatal())return s.nativeExtensionProvider=void 0,s.createRedirectClient(e.correlationId).acquireToken(e);if(t instanceof hd)return s.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),s.createRedirectClient(e.correlationId).acquireToken(e);throw s.browserStorage.setInteractionInProgress(!1),t}))):(o=this.createRedirectClient(e.correlationId),n=o.acquireToken(e)),[2,n.catch((function(e){throw r?s.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_FAILURE,Ud.Redirect,null,e):s.eventHandler.emitEvent(rf.LOGIN_FAILURE,Ud.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this,r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(Jh.AcquireTokenPopup,r);try{this.logger.verbose("acquireTokenPopup called",r),this.preflightBrowserEnvironmentCheck(Ud.Popup)}catch(e){return Promise.reject(e)}var i,o=this.getAllAccounts();(o.length>0?this.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_START,Ud.Popup,e):this.eventHandler.emitEvent(rf.LOGIN_START,Ud.Popup,e),this.canUseNative(e))?i=this.acquireTokenNative(e,Dd.acquireTokenPopup).then((function(e){return t.browserStorage.setInteractionInProgress(!1),n.endMeasurement({success:!0,isNativeBroker:!0,requestId:e.requestId}),e})).catch((function(r){if(r instanceof kf&&r.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);if(r instanceof hd)return t.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),t.createPopupClient(e.correlationId).acquireToken(e);throw t.browserStorage.setInteractionInProgress(!1),r})):i=this.createPopupClient(e.correlationId).acquireToken(e);return i.then((function(e){return o.length<t.getAllAccounts().length?t.eventHandler.emitEvent(rf.LOGIN_SUCCESS,Ud.Popup,e):t.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_SUCCESS,Ud.Popup,e),n.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),n.endMeasurement({success:!0,requestId:e.requestId}),e})).catch((function(e){return o.length>0?t.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_FAILURE,Ud.Popup,null,e):t.eventHandler.emitEvent(rf.LOGIN_FAILURE,Ud.Popup,null,e),n.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),Promise.reject(e)}))},e.prototype.trackPageVisibilityWithMeasurement=function(){var e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))},e.prototype.ssoSilent=function(e){var t;return mu(this,void 0,void 0,(function(){var r,n,i,o,s=this;return vu(this,(function(a){return r=this.getRequestCorrelationId(e),n=gu(gu({},e),{prompt:e.prompt,correlationId:r}),this.preflightBrowserEnvironmentCheck(Ud.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Jh.SsoSilent,r),null===(t=this.ssoSilentMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(rf.SSO_SILENT_START,Ud.Silent,n),this.canUseNative(n)?i=this.acquireTokenNative(n,Dd.ssoSilent).catch((function(e){if(e instanceof kf&&e.isFatal())return s.nativeExtensionProvider=void 0,s.createSilentIframeClient(n.correlationId).acquireToken(n);throw e})):(o=this.createSilentIframeClient(n.correlationId),i=o.acquireToken(n)),[2,i.then((function(e){var t,r;return s.eventHandler.emitEvent(rf.SSO_SILENT_SUCCESS,Ud.Silent,e),null===(t=s.ssoSilentMeasurement)||void 0===t||t.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),null===(r=s.ssoSilentMeasurement)||void 0===r||r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw s.eventHandler.emitEvent(rf.SSO_SILENT_FAILURE,Ud.Silent,null,e),null===(t=s.ssoSilentMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",s.trackPageVisibilityWithMeasurement)}))]}))}))},e.prototype.acquireTokenByCode=function(e){return mu(this,void 0,void 0,(function(){var t,r,n,i,o=this;return vu(this,(function(s){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(Ud.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_BY_CODE_START,Ud.Silent,e),r=this.performanceClient.startMeasurement(Jh.AcquireTokenByCode,e.correlationId);try{if(e.code&&e.nativeAccountId)throw zp.createSpaCodeAndNativeAccountIdPresentError();if(e.code)return n=e.code,(i=this.hybridAuthCodeResponses.get(n))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),r.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync(gu(gu({},e),{correlationId:t})).then((function(e){return o.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Ud.Silent,e),o.hybridAuthCodeResponses.delete(n),r.addStaticFields({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),r.endMeasurement({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){throw o.hybridAuthCodeResponses.delete(n),o.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ud.Silent,null,e),r.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.hybridAuthCodeResponses.set(n,i)),[2,i];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,Dd.acquireTokenByCode,e.nativeAccountId).catch((function(e){throw e instanceof kf&&e.isFatal()&&(o.nativeExtensionProvider=void 0),e}))];throw zp.createUnableToAcquireTokenFromNativePlatformError()}throw zp.createAuthCodeOrNativeAccountIdRequiredError()}catch(e){throw this.eventHandler.emitEvent(rf.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ud.Silent,null,e),r.endMeasurement({errorCode:e instanceof ll&&e.errorCode||void 0,subErrorCode:e instanceof ll&&e.subError||void 0,success:!1}),e}return[2]}))}))},e.prototype.acquireTokenByCodeAsync=function(e){var t;return mu(this,void 0,void 0,(function(){var r=this;return vu(this,(function(n){switch(n.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Jh.AcquireTokenByCodeAsync,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then((function(e){var t;return null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((function(e){var t;throw null===(t=r.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.endMeasurement({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((function(){document.removeEventListener("visibilitychange",r.trackPageVisibilityWithMeasurement)}))];case 1:return[2,n.sent()]}}))}))},e.prototype.acquireTokenFromCache=function(e,t,r){return mu(this,void 0,void 0,(function(){return vu(this,(function(n){switch(this.performanceClient.addQueueMeasurement(Jh.AcquireTokenFromCache,t.correlationId),r.cacheLookupPolicy){case tf.Default:case tf.AccessToken:case tf.AccessTokenAndRefreshToken:return[2,e.acquireToken(t)];default:throw ih.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenByRefreshToken=function(e,t){return mu(this,void 0,void 0,(function(){var r;return vu(this,(function(n){switch(this.performanceClient.addQueueMeasurement(Jh.AcquireTokenByRefreshToken,e.correlationId),t.cacheLookupPolicy){case tf.Default:case tf.AccessTokenAndRefreshToken:case tf.RefreshToken:case tf.RefreshTokenAndNetwork:return r=this.createSilentRefreshClient(e.correlationId),this.performanceClient.setPreQueueTime(Jh.SilentRefreshClientAcquireToken,e.correlationId),[2,r.acquireToken(e)];default:throw ih.createRefreshRequiredError()}return[2]}))}))},e.prototype.acquireTokenBySilentIframe=function(e){return mu(this,void 0,void 0,(function(){var t;return vu(this,(function(r){return this.performanceClient.addQueueMeasurement(Jh.AcquireTokenBySilentIframe,e.correlationId),t=this.createSilentIframeClient(e.correlationId),this.performanceClient.setPreQueueTime(Jh.SilentIframeClientAcquireToken,e.correlationId),[2,t.acquireToken(e)]}))}))},e.prototype.logout=function(e){return mu(this,void 0,void 0,(function(){var t;return vu(this,(function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(gu({correlationId:t},e))]}))}))},e.prototype.logoutRedirect=function(e){return mu(this,void 0,void 0,(function(){var t;return vu(this,(function(r){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(Ud.Redirect),[2,this.createRedirectClient(t).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(Ud.Popup),this.createPopupClient(t).logout(e)}catch(e){return Promise.reject(e)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+e),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+e),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+e),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e,t){if(void 0===t&&(t=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),_f.blockNonBrowserEnvironment(this.isBrowserEnvironment),_f.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),_f.blockReloadInHiddenIframes(),_f.blockAcquireTokenInPopups(),_f.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===Ud.Redirect&&this.config.cache.cacheLocation===Nd.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw df.createInMemoryRedirectUnavailableError();e!==Ud.Redirect&&e!==Ud.Popup||this.preflightInteractiveRequest(t)},e.prototype.preflightInteractiveRequest=function(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),_f.blockReloadInHiddenIframes(),e&&this.browserStorage.setInteractionInProgress(!0)},e.prototype.acquireTokenNative=function(e,t,r){return mu(this,void 0,void 0,(function(){return vu(this,(function(n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw zp.createNativeConnectionNotEstablishedError();return[2,new Nf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)]}))}))},e.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!Of.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Uu.NONE:case Uu.CONSENT:case Uu.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},e.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},e.prototype.createPopupClient=function(e){return new Pf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createRedirectClient=function(e){return new Mf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentIframeClient=function(e){return new Lf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dd.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)},e.prototype.createSilentCacheClient=function(e){return new Rf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentRefreshClient=function(e){return new xf(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.createSilentAuthCodeClient=function(e){return new og(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dd.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},e.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e.prototype.getConfiguration=function(){return this.config},e.prototype.getRequestCorrelationId=function(e){return(null==e?void 0:e.correlationId)?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():Mu.EMPTY_STRING},e}());
/*! @azure/msal-browser v2.37.1 2023-06-07 */function ag(t){let r,n,i,o,s,h,p;return{c(){r=l("div"),n=l("button"),i=l("span"),i.textContent=""+t[6].labelButtonIn,o=d(),s=l("p"),s.textContent=""+t[6].labelLogin,g(n,"type","button"),g(n,"class","btn btn-sm btn-secondary d-block"),g(s,"class","mt-2 d-block"),g(r,"class","alert alert-info")},m(e,u){c(e,r,u),a(r,n),a(n,i),a(r,o),a(r,s),h||(p=f(n,"click",t[4]),h=!0)},p:e,d(e){e&&u(r),h=!1,p()}}}function cg(e){let t,r,n,i,o,s,p,y,m,v=e[6].labelLogout+e[1].username+"";return{c(){t=l("div"),r=l("div"),n=l("button"),i=l("span"),i.textContent=""+e[6].labelButtonOut,o=d(),s=l("p"),p=h(v),g(n,"type","button"),g(n,"class","btn btn-sm btn-secondary d-block"),g(s,"class","mt-2 d-block"),g(t,"class","alert alert-success")},m(u,l){c(u,t,l),a(t,r),a(r,n),a(n,i),a(r,o),a(r,s),a(s,p),y||(m=f(n,"click",e[5]),y=!0)},p(e,t){2&t&&v!==(v=e[6].labelLogout+e[1].username+"")&&function(e,t){t=""+t,e.data!==t&&(e.data=t)}(p,v)},d(e){e&&u(t),y=!1,m()}}}function ug(t){let r,n,i,o,s,p,f,y=t[20].error+"";return{c(){r=l("div"),n=l("span"),n.textContent=""+t[6].errorFatal,i=d(),o=l("br"),s=d(),p=l("span"),f=h(y),g(r,"class","alert alert-danger mt-3 mb-0")},m(e,t){c(e,r,t),a(r,n),a(r,i),a(r,o),a(r,s),a(r,p),a(p,f)},p:e,d(e){e&&u(r)}}}function lg(t){return{c:e,m:e,p:e,d:e}}function hg(t){let r,n;return{c(){r=l("div"),n=l("span"),n.textContent=""+t[6].labelLoading,g(r,"class","alert alert-warning mt-3 mb-0")},m(e,t){c(e,r,t),a(r,n)},p:e,d(e){e&&u(r)}}}function dg(t){let r,n,i;function o(e,t){return e[0]?cg:ag}let s=o(t),h=s(t),p={ctx:t,current:null,token:null,hasCatch:!0,pending:hg,then:lg,catch:ug,error:20};return function(e,t){const r=t.token={};function n(e,n,i,o){if(t.token!==r)return;t.resolved=o;let s=t.ctx;void 0!==i&&(s=s.slice(),s[i]=o);const a=e&&(t.current=e)(s);let c=!1;t.block&&(t.blocks?t.blocks.forEach((e,r)=>{r!==n&&e&&(U(),F(e,1,1,()=>{t.blocks[r]===e&&(t.blocks[r]=null)}),L())}):t.block.d(1),a.c(),x(a,1),a.m(t.mount(),t.anchor),c=!0),t.block=a,t.blocks&&(t.blocks[n]=a),c&&M()}if(!(i=e)||"object"!=typeof i&&"function"!=typeof i||"function"!=typeof i.then){if(t.current!==t.then)return n(t.then,1,t.value,e),!0;t.resolved=e}else{const r=w();if(e.then(e=>{_(r),n(t.then,1,t.value,e),_(null)},e=>{if(_(r),n(t.catch,2,t.error,e),_(null),!t.hasCatch)throw e}),t.current!==t.pending)return n(t.pending,0),!0}var i}(t[3](),p),{c(){r=l("div"),h.c(),n=d(),p.block.c(),R(()=>t[11].call(r))},m(e,o){c(e,r,o),h.m(r,null),a(r,n),p.block.m(r,p.anchor=null),p.mount=()=>r,p.anchor=null,i=function(e,t){"static"===getComputedStyle(e).position&&(e.style.position="relative");const r=l("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const n=v();let i;return n?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=f(window,"message",e=>{e.source===r.contentWindow&&t()})):(r.src="about:blank",r.onload=()=>{i=f(r.contentWindow,"resize",t),t()}),a(e,r),()=>{(n||i&&r.contentWindow)&&i(),u(r)}}(r,t[11].bind(r))},p(e,[i]){s===(s=o(t=e))&&h?h.p(t,i):(h.d(1),h=s(t),h&&(h.c(),h.m(r,n))),function(e,t,r){const n=t.slice(),{resolved:i}=e;e.current===e.then&&(n[e.value]=i),e.current===e.catch&&(n[e.error]=i),e.block.p(n,r)}(p,t,i)},i:e,o:e,d(e){e&&u(r),h.d(),p.block.d(),p.token=null,p=null,i()}}}function pg(e,t,r){let n,i,{inputClientId:o}=t,{inputAuthority:s}=t,{inputredirectUri:a}=t,{inputCustomLabels:c={}}=t,u=!1,l={name:String,username:String,groups:String};const h=async()=>{let e;e=u?{authenticated:!0,token:n,_token_expire_date:i,user:l}:{authenticated:!1},console.log(e),su.setComponentValue(e)},d={auth:{clientId:o,authority:s,redirectUri:a},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:(e,t,r)=>{if(!r)switch(e){case al.Error:return void console.error(t);case al.Info:return void console.info(t);case al.Verbose:return void console.debug(t);case al.Warning:return void console.warn(t)}}}}},p="https://graph.microsoft.com/v1.0/me/transitiveMemberOf",f={scopes:["openid","profile","User.Read","Mail.Send"]},g=new sg(d),y=e=>new Promise((t,r)=>{!function(e,t,r){const n=new Headers,i="Bearer "+t;n.append("Authorization",i);const o={method:"GET",headers:n};console.log("request made to Graph API at: "+(new Date).toString()),fetch(e,o).then(e=>e.json()).then(t=>r(t,e)).catch(e=>console.log(e))}(p,e,e=>{let r=[];e.value.forEach(e=>r.push(e.displayName)),t(r)})}),m=async()=>{const e=g.getAllAccounts();if(1==e.length){const t=await g.acquireTokenSilent({scopes:f.scopes,account:e[0]}),o=await y(t.accessToken);n=t.accessToken,i=t.expiresOn,r(0,u=!0),r(1,l.name=e[0].name,l),r(1,l.username=e[0].username,l),r(1,l.groups=o,l),console.log(l)}h()};var v;let b;T(()=>{su.setFrameHeight()}),v=()=>{su.setFrameHeight(b)},w().$$.after_update.push(v);const _={...du,...c};var I,C;return I="localization",C=_,w().$$.context.set(I,C),e.$$set=e=>{"inputClientId"in e&&r(7,o=e.inputClientId),"inputAuthority"in e&&r(8,s=e.inputAuthority),"inputredirectUri"in e&&r(9,a=e.inputredirectUri),"inputCustomLabels"in e&&r(10,c=e.inputCustomLabels)},[u,l,b,m,()=>{g.loginPopup(f).then(e=>{e.account,m()}).catch(e=>{console.error(e)})},()=>{const e={account:g.getAccountByUsername(l.username),postLogoutRedirectUri:d.auth.redirectUri};g.logoutPopup(e),n=null,r(0,u=!1),r(1,l.name=null,l),r(1,l.username=null,l),r(1,l.groups=null,l),h()},_,o,s,a,c,function(){b=this.clientHeight,r(2,b)}]}return new class extends G{constructor(e){super(),V(this,e,hu,lu,s,{component:0,spreadArgs:1})}}({target:document.body,props:{component:class extends G{constructor(e){super(),V(this,e,pg,dg,s,{inputClientId:7,inputAuthority:8,inputredirectUri:9,inputCustomLabels:10})}},spreadArgs:!0}})}();
//# sourceMappingURL=bundle.js.map
